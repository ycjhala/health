<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Insurance Calculator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0.5rem; }
        header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; text-align: center;}
        .input-section { background: white; padding: 0.5rem; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 1.5rem; }
        .form-group { display: flex; flex-direction: column; }
        label { font-weight: 600; margin-bottom: 0.5rem; font-size: 0.9rem; }
        input, select { padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; }
        input:focus, select:focus { outline: none; border-color: #2563eb; }
        .family-builder { margin-top: 2rem; padding-top: 2rem; padding-bottom: 1rem; margin-bottom: 1rem; border-top: 2px solid #e2e8f0;border-bottom: 2px solid #e2e8f0; }
        .section-title { font-size: 1.3rem; font-weight: 700; margin-bottom: 1rem; }
        .family-member { background: #f8fafc; padding: 0.5rem; border-radius: 8px; margin-bottom: 1rem; display: grid; grid-template-columns: 1fr 1fr auto; gap: 1rem; align-items: end; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-secondary { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; padding: 0.5rem 1rem; }
        .btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; justify-content:space-between}
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; border-bottom: 2px solid #e2e8f0; justify-content: center; flex-wrap: wrap;}
        .tab { padding: 1rem 1.5rem; background: #fff8dc; border: none; cursor: pointer; font-weight: 600; color: #64748b; border-bottom: 3px solid #87cefa; border-top: 3px solid #87cefa; font-size: large;}
        .tab.active { color: #2563eb; border-bottom-color: #2563eb; border-top-color: #2563eb; background: #f0f8ff;}
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .results-section { background: white; padding: 0.5rem; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .plan-card { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 0.5rem; margin-bottom: 1rem; }
        .plan-card.over-budget { border-left: 4px solid #f59e0b; background: #fffbeb; }
        .plan-header { display: flex; justify-content: space-between; margin-bottom: 1rem; }
        .plan-name { font-size: 1.2rem; font-weight: 700; }
        .plan-category { display: inline-block; padding: 0.25rem 0.75rem; background: #2563eb; color: white; border-radius: 20px; font-size: 0.8rem; }
        .plan-details { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
        .detail-item { display: flex; flex-direction: column; }
        .detail-label { font-size: 0.85rem; color: #64748b; margin-bottom: 0.25rem; }
        .detail-value { font-size: 1.1rem; font-weight: 700; }
        .premium-highlight { color: #10b981; font-size: 1.5rem; }
        .budget-indicator { padding: 0.5rem 1rem; background: #f59e0b; color: white; border-radius: 20px; font-size: 0.85rem; }
        /*.breakdown { background: white; padding: 1rem; border-radius: 8px; margin-top: 1rem; }
        //.breakdown-title { font-weight: 700; margin-bottom: 0.5rem; }
        //.breakdown-item { display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid #e2e8f0; }*/
		
		.breakdown {
    margin-top: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
}

.breakdown-title {
    padding: 15px;
    background-color: #f8f9fa;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
    color: #333;
    transition: background-color 0.3s ease;
}

.breakdown-title:hover {
    background-color: #e9ecef;
}

.breakdown-toggle {
    font-size: 18px;
    font-weight: bold;
    transition: transform 0.3s ease;
}

.breakdown-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease;
}

.breakdown.active .breakdown-content {
    max-height: 1000px; /* Adjust based on your content */
}

.breakdown.active .breakdown-toggle {
    transform: rotate(45deg);
}

.breakdown-item {
    padding: 12px 16px;
    display: flex;
    justify-content: space-between;
    border-bottom: 1px solid #f0f0f0;
    background-color: white;
}

.breakdown-item span{
    max-width: 50%;
	font-size: smaller;
}

.breakdown-item:last-child {
    border-bottom: none;
}

.breakdown-item:nth-child(even) {
    background-color: #fafafa;
}
        .no-results { text-align: center; padding: 3rem; color: #64748b; }
        .feature-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; }
        .feature-tag { padding: 0.25rem 0.75rem; background: #e0f2fe; color: #0369a1; border-radius: 20px; font-size: 0.8rem; }

#comparisonTable {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

#comparisonTable th,
#comparisonTable td {
  border: 1px solid #ccc;
  padding: 10px;
  text-align: left;
}

#comparisonTable th {
  background-color: #f2f2f2;
  cursor: move; /* Indicate that the header can be dragged */
}




/* Style for draggable headers */
/* Dragging styles */
.ui-state-highlight {
    background-color: #ffffcc !important;
    border: 1px dashed #ccc !important;
    height: 100%;
}

.ui-sortable-helper {
    background-color: #f0f0f0 !important;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

/* Table styles */
#comparisonTable {
    border-collapse: collapse;
    width: 100%;
}

#comparisonTable th, #comparisonTable td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
    min-width: 120px;
}

#comparisonTable th {
    background-color: #f2f2f2;
    cursor: move;
}

#comparisonTable th.fixed-column {
    background-color: #e6e6e6;
    cursor: default;
}

#comparisonTable td.fixed-column {
    background-color: #f9f9f9;
    font-weight: bold;
}

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Health Insurance Plan Recommendation System</h1>
            <p style="text-align:center;">Find the best insurance plan and coverages for your insurance needs within your budget</p>
        </header>
        <div class="input-section">
            <div class="form-grid">
                <div class="form-group">
                    <label for="primaryAge">Your Age *</label>
                    <input type="number" id="primaryAge" min="0" max="100" placeholder="Enter age">
                </div>
                <div class="form-group">
                    <label for="zone">City/District *</label>
                    <select id="zone"><option value="">Select City/District</option></select>
                </div>
                <div class="form-group">
                    <label for="budget">Annual Premium Budget (Rs) *</label>
                    <input type="number" id="budget" min="0" placeholder="Enter budget">
                </div>
                <div class="form-group">
                    <label for="desiredSI">Desired Sum Insured</label>
                    <select id="desiredSI" disabled>
                        <option value="">All Ranges</option>
                        <option value="0-200000">0-2 Lakh</option>
                        <option value="200000-500000">2-5 Lakh</option>
                        <option value="500000-1000000">5-10 Lakh</option>
                        <option value="1000000-2000000">10-20 Lakh</option>
						<!--<option value="0-100000">0-1 Lakh</option>
						<option value="100000-200000">1-2 Lakh</option>
                        <option value="200000-500000">2-5 Lakh</option>
						<option value="500000-700000">5-7 Lakh</option>
                        <option value="700000-1000000">7-10 Lakh</option>
						<option value="1000000-1200000">10-12 Lakh</option>
						<option value="1200000-1500000">12-15 Lakh</option>
						<option value="1500000-1800000">15-18 Lakh</option>
						<option value="1800000-2000000">18-20 Lakh</option>
                        <option value="2000000-2200000">20-22 Lakh</option>
						<option value="2200000-2500000">22-25 Lakh</option>-->
                    </select>
                </div>
            </div>
            <div class="family-builder">
                <div class="section-title">Family Members</div>
                <div id="familyMembers"></div>
                <button class="btn btn-secondary" onclick="addFamilyMember()">+ Add Member</button>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="calculateRecommendations()">Calculate Recommendations</button>
                <button class="btn btn-secondary" onclick="exportToPDF()">Export PDF</button>
            </div>
        </div>
        <div class="results-section" id="resultsSection" style="display:none;">
            <div class="tabs">
                <button class="tab active" onclick="switchTab(event,'individual')">Individual/Family Plans</button>
                <button class="tab" onclick="switchTab(event,'combination')">Combination Plans</button>
                <button class="tab" onclick="switchTab(event,'detailed')">Detailed View</button>
				<button class="tab" onclick="switchTab(event,'comparison')">Compare Plans</button>
            </div>
            <div id="individualTab" class="tab-content active"></div>
            <div id="combinationTab" class="tab-content"></div>
            <div id="detailedTab" class="tab-content"></div>
			<div id="comparisonTab" class="tab-content">
				<!-- Comparison Section -->
				<div id="comparisonSection" style="display: none;">
				<h2>Plan Comparison</h2>
				<table id="comparisonTable">
					<thead>
					<tr id="comparisonHeader"></tr>
					
					</thead>
					<tbody id="comparisonBody">
						
					</tbody>
				</table>
				</div>

			</div>

        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
    <script>
	const DATA={
	plans:{
		FMP:{
			id:'FMP',
			name:'Family Mediclaim Policy',
			category:'Comprehensive',
			planTypes:['individual','floater'],
			eligibility:{
				adult:{
					minAge:18,
					maxAge:60
				},
				child:{
					minAge:0.25,
					maxAge:17
				}
			},
			hasZonalPricing:true,
			zones:['A','B','C'],
			ageBrackets:['0-17','18-25','26-30','31-35','36-40','41-45','46-50','51-55','56-60','61-65', '66-70', '71-75', '75+'],
			sumInsuredOptions:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
			premiumRates:{
				individual:{
					A:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[2071, 3495, 3883, 4660, 5663, 5796, 6932, 8340, 11975, 12361, 15139, 17092, 19717],
							[2472, 4172, 4636, 5564, 6762, 7038, 8417, 10127, 14542, 16482, 20185, 22790, 26290],
							[2873, 4848, 5389, 6467, 7860, 8280, 9903, 11914, 17108, 20602, 25232, 28487, 32862],
							[3259, 5500, 6112, 7335, 8914, 9936, 11883, 14297, 20529, 24723, 30278, 34185, 39434],
							[3645, 6151, 6835, 8202, 9968, 11592, 13864, 16680, 23951, 28843, 35324, 39882, 46007],
							[3816, 6439, 7154, 8585, 10433, 13012, 15562, 18718, 26877, 32349, 39618, 44730, 51599],
							[3986, 6726, 7474, 8969, 10899, 14432, 17261, 20756, 29803, 35855, 43912, 49578, 57191],
							[4156, 7014, 7793, 9352, 11365, 15852, 18959, 22793, 32729, 39361, 48205, 54425, 62784],
							[4327, 7301, 8113, 9735, 11831, 17272, 20658, 24831, 35655, 42867, 52499, 59273, 68376],
							[4538, 7658, 8508, 10210, 12408, 18119, 21670, 26044, 37396, 45770, 56055, 63287, 73007],
							[4749, 8014, 8904, 10685, 12985, 18965, 22682, 27257, 39138, 48673, 59610, 67302, 77637],
							[4960, 8370, 9300, 11160, 13562, 19812, 23695, 28470, 40880, 51577, 63165, 71316, 82268],
							[5171, 8726, 9696, 11635, 14140, 20658, 24707, 29683, 42622, 54480, 66721, 75330, 86899],
							[5382, 9082, 10092, 12110, 14717, 21504, 25719, 30896, 44363, 57383, 70276, 79344, 91529],
							[6055, 10218, 11353, 13624, 16556, 24193, 28934, 34758, 49909, 64556, 79061, 89262, 102971],
							[6509, 10984, 12204, 14645, 17798, 26007, 31104, 37365, 53652, 69397, 84991, 95957, 110693],
							[6834, 11533, 12815, 15378, 18688, 27307, 32660, 39233, 56334, 72867, 89240, 100755, 116228]
						]
					},
					B:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[1769, 2985, 3317, 3981, 4837, 4951, 5921, 7124, 10229, 10559, 12931, 14600, 16842],
							[2112, 3563, 3960, 4752, 5776, 6011, 7190, 8650, 12421, 14078, 17242, 19466, 22456],
							[2454, 4141, 4603, 5524, 6714, 7072, 8458, 10177, 14613, 17598, 21552, 24333, 28070],
							[2784, 4698, 5221, 6265, 7614, 8487, 10150, 12212, 17535, 21117, 25862, 29199, 33684],
							[3114, 5254, 5838, 7006, 8514, 9901, 11842, 14248, 20458, 24637, 30173, 34066, 39297],
							[3259, 5500, 6111, 7333, 8912, 11114, 13293, 15988, 22957, 27632, 33840, 38207, 44074],
							[3405, 5745, 6384, 7661, 9310, 12327, 14743, 17729, 25457, 30626, 37508, 42348, 48851],
							[3550, 5991, 6657, 7988, 9708, 13540, 16194, 19469, 27956, 33621, 41175, 46488, 53628],
							[3696, 6237, 6930, 8315, 10106, 14753, 17645, 21210, 30455, 36616, 44843, 50629, 58404],
							[3876, 6541, 7268, 8721, 10599, 15476, 18510, 22246, 31943, 39096, 47880, 54058, 62360],
							[4056, 6845, 7606, 9127, 11092, 16199, 19375, 23282, 33430, 41575, 50917, 57487, 66315],
							[4237, 7149, 7944, 9532, 11585, 16922, 20239, 24318, 34918, 44055, 53954, 60916, 70271],
							[4417, 7454, 8282, 9938, 12078, 17645, 21104, 25354, 36406, 46535, 56991, 64344, 74226],
							[4597, 7758, 8620, 10344, 12571, 18368, 21969, 26390, 37894, 49015, 60028, 67773, 78181],
							[5172, 8728, 9697, 11637, 14142, 20664, 24715, 29689, 42630, 55141, 67531, 76245, 87954],
							[5560, 9382, 10425, 12510, 15203, 22214, 26568, 31916, 45828, 59277, 72596, 81963, 94551],
							[5838, 9851, 10946, 13135, 15963, 23325, 27897, 33511, 48119, 62241, 76226, 86061, 99278]
						]
					},
					C:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[1640, 2767, 3074, 3689, 4484, 4588, 5488, 6603, 9481, 9786, 11985, 13531, 15609],
							[1957, 3303, 3670, 4405, 5353, 5572, 6664, 8017, 11512, 13048, 15980, 18042, 20813],
							[2275, 3838, 4266, 5120, 6222, 6555, 7839, 9432, 13544, 16310, 19975, 22552, 26016],
							[2580, 4354, 4839, 5807, 7057, 7866, 9407, 11319, 16252, 19572, 23970, 27063, 31219],
							[2886, 4870, 5411, 6493, 7891, 9177, 10975, 13205, 18961, 22834, 27965, 31573, 36422],
							[3021, 5097, 5664, 6797, 8260, 10301, 12320, 14818, 21277, 25610, 31364, 35411, 40849],
							[3156, 5325, 5917, 7100, 8629, 11425, 13665, 16431, 23594, 28385, 34763, 39249, 45276],
							[3290, 5553, 6170, 7404, 8997, 12550, 15009, 18045, 25910, 31161, 38163, 43087, 49704],
							[3425, 5780, 6422, 7707, 9366, 13674, 16354, 19658, 28227, 33937, 41562, 46925, 54131],
							[3592, 6062, 6736, 8083, 9823, 14344, 17155, 20618, 29606, 36235, 44377, 50103, 57797],
							[3760, 6344, 7049, 8459, 10280, 15014, 17957, 21578, 30984, 38533, 47191, 53280, 61463],
							[3927, 6626, 7362, 8835, 10737, 15684, 18758, 22539, 32363, 40832, 50006, 56458, 65129],
							[4094, 6908, 7676, 9211, 11194, 16354, 19560, 23499, 33742, 43130, 52821, 59636, 68795],
							[4261, 7190, 7989, 9587, 11651, 17024, 20361, 24459, 35121, 45428, 55635, 62814, 72461],
							[4793, 8089, 8988, 10785, 13107, 19152, 22906, 27517, 39511, 51107, 62590, 70666, 81518],
							[5153, 8696, 9662, 11594, 14090, 20589, 24624, 29580, 42474, 54940, 67284, 75966, 87632],
							[5411, 9130, 10145, 12174, 14795, 21618, 25855, 31059, 44598, 57687, 70648, 79764, 92014]
						]
					}
				},
				floater:{
					A:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[2071, 3495, 3883, 4660, 5663, 5796, 6932, 8340, 11975, 12361, 15139, 17092, 19717],
							[2472, 4172, 4636, 5564, 6762, 7038, 8417, 10127, 14542, 16482, 20185, 22790, 26290],
							[2873, 4848, 5389, 6467, 7860, 8280, 9903, 11914, 17108, 20602, 25232, 28487, 32862],
							[3259, 5500, 6112, 7335, 8914, 9936, 11883, 14297, 20529, 24723, 30278, 34185, 39434],
							[3645, 6151, 6835, 8202, 9968, 11592, 13864, 16680, 23951, 28843, 35324, 39882, 46007],
							[3816, 6439, 7154, 8585, 10433, 13012, 15562, 18718, 26877, 32349, 39618, 44730, 51599],
							[3986, 6726, 7474, 8969, 10899, 14432, 17261, 20756, 29803, 35855, 43912, 49578, 57191],
							[4156, 7014, 7793, 9352, 11365, 15852, 18959, 22793, 32729, 39361, 48205, 54425, 62784],
							[4327, 7301, 8113, 9735, 11831, 17272, 20658, 24831, 35655, 42867, 52499, 59273, 68376],
							[4538, 7658, 8508, 10210, 12408, 18119, 21670, 26044, 37396, 45770, 56055, 63287, 73007],
							[4749, 8014, 8904, 10685, 12985, 18965, 22682, 27257, 39138, 48673, 59610, 67302, 77637],
							[4960, 8370, 9300, 11160, 13562, 19812, 23695, 28470, 40880, 51577, 63165, 71316, 82268],
							[5171, 8726, 9696, 11635, 14140, 20658, 24707, 29683, 42622, 54480, 66721, 75330, 86899],
							[5382, 9082, 10092, 12110, 14717, 21504, 25719, 30896, 44363, 57383, 70276, 79344, 91529],
							[6055, 10218, 11353, 13624, 16556, 24193, 28934, 34758, 49909, 64556, 79061, 89262, 102971],
							[6509, 10984, 12204, 14645, 17798, 26007, 31104, 37365, 53652, 69397, 84991, 95957, 110693],
							[6834, 11533, 12815, 15378, 18688, 27307, 32660, 39233, 56334, 72867, 89240, 100755, 116228]
						]
					},
					B:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[1769, 2985, 3317, 3981, 4837, 4951, 5921, 7124, 10229, 10559, 12931, 14600, 16842],
							[2112, 3563, 3960, 4752, 5776, 6011, 7190, 8650, 12421, 14078, 17242, 19466, 22456],
							[2454, 4141, 4603, 5524, 6714, 7072, 8458, 10177, 14613, 17598, 21552, 24333, 28070],
							[2784, 4698, 5221, 6265, 7614, 8487, 10150, 12212, 17535, 21117, 25862, 29199, 33684],
							[3114, 5254, 5838, 7006, 8514, 9901, 11842, 14248, 20458, 24637, 30173, 34066, 39297],
							[3259, 5500, 6111, 7333, 8912, 11114, 13293, 15988, 22957, 27632, 33840, 38207, 44074],
							[3405, 5745, 6384, 7661, 9310, 12327, 14743, 17729, 25457, 30626, 37508, 42348, 48851],
							[3550, 5991, 6657, 7988, 9708, 13540, 16194, 19469, 27956, 33621, 41175, 46488, 53628],
							[3696, 6237, 6930, 8315, 10106, 14753, 17645, 21210, 30455, 36616, 44843, 50629, 58404],
							[3876, 6541, 7268, 8721, 10599, 15476, 18510, 22246, 31943, 39096, 47880, 54058, 62360],
							[4056, 6845, 7606, 9127, 11092, 16199, 19375, 23282, 33430, 41575, 50917, 57487, 66315],
							[4237, 7149, 7944, 9532, 11585, 16922, 20239, 24318, 34918, 44055, 53954, 60916, 70271],
							[4417, 7454, 8282, 9938, 12078, 17645, 21104, 25354, 36406, 46535, 56991, 64344, 74226],
							[4597, 7758, 8620, 10344, 12571, 18368, 21969, 26390, 37894, 49015, 60028, 67773, 78181],
							[5172, 8728, 9697, 11637, 14142, 20664, 24715, 29689, 42630, 55141, 67531, 76245, 87954],
							[5560, 9382, 10425, 12510, 15203, 22214, 26568, 31916, 45828, 59277, 72596, 81963, 94551],
							[5838, 9851, 10946, 13135, 15963, 23325, 27897, 33511, 48119, 62241, 76226, 86061, 99278]
						]
					},
					C:{
						sumInsured:[100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates:[
							[1640, 2767, 3074, 3689, 4484, 4588, 5488, 6603, 9481, 9786, 11985, 13531, 15609],
							[1957, 3303, 3670, 4405, 5353, 5572, 6664, 8017, 11512, 13048, 15980, 18042, 20813],
							[2275, 3838, 4266, 5120, 6222, 6555, 7839, 9432, 13544, 16310, 19975, 22552, 26016],
							[2580, 4354, 4839, 5807, 7057, 7866, 9407, 11319, 16252, 19572, 23970, 27063, 31219],
							[2886, 4870, 5411, 6493, 7891, 9177, 10975, 13205, 18961, 22834, 27965, 31573, 36422],
							[3021, 5097, 5664, 6797, 8260, 10301, 12320, 14818, 21277, 25610, 31364, 35411, 40849],
							[3156, 5325, 5917, 7100, 8629, 11425, 13665, 16431, 23594, 28385, 34763, 39249, 45276],
							[3290, 5553, 6170, 7404, 8997, 12550, 15009, 18045, 25910, 31161, 38163, 43087, 49704],
							[3425, 5780, 6422, 7707, 9366, 13674, 16354, 19658, 28227, 33937, 41562, 46925, 54131],
							[3592, 6062, 6736, 8083, 9823, 14344, 17155, 20618, 29606, 36235, 44377, 50103, 57797],
							[3760, 6344, 7049, 8459, 10280, 15014, 17957, 21578, 30984, 38533, 47191, 53280, 61463],
							[3927, 6626, 7362, 8835, 10737, 15684, 18758, 22539, 32363, 40832, 50006, 56458, 65129],
							[4094, 6908, 7676, 9211, 11194, 16354, 19560, 23499, 33742, 43130, 52821, 59636, 68795],
							[4261, 7190, 7989, 9587, 11651, 17024, 20361, 24459, 35121, 45428, 55635, 62814, 72461],
							[4793, 8089, 8988, 10785, 13107, 19152, 22906, 27517, 39511, 51107, 62590, 70666, 81518],
							[5153, 8696, 9662, 11594, 14090, 20589, 24624, 29580, 42474, 54940, 67284, 75966, 87632],
							[5411, 9130, 10145, 12174, 14795, 21618, 25855, 31059, 44598, 57687, 70648, 79764, 92014]
						]
					}
				}
			},
			discounts:{
				directChannel: { 
					available: true 
				},
        		noClaimRewards: { 
					maxDiscount: 0.5, 
					maxCumulativeBonus: 2.0 
				},
				family:{
					rate:0.05
				},
				floater:{
					rates:{
						one_adult_parents: { 
							age40to50: 0.20, 
							other: 0.15 
						},
						one_adult_children: { 
							age40to50: 0.20, 
							other: 0.15 
						},
            			one_adult_children_parents: { 
							age40to50: 0.30, 
							other: 0.30 
						},
						two_adults: { 
							age40to50: 0.30, 
							other: 0.25 
						},
						two_adults_children: { 
							age40to50: 0.30, 
							other: 0.25 
						},
						two_adults_parents: { 
							age40to50: 0.30, 
							other: 0.30 
						},
						two_adults_children_parents: { 
							age40to50: 0.30, 
							other: 0.30 
						}
					}
				}
			},
			features:{
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"No Limit",
				icu:"No Limit",
				preHospitalisation:"30 Days-Max 10% Of Si Combined for Both",
				postHospitalisation:"60 Days-Max10% Of Si Combined for Both",
				mtmat:"Yes",
				copay:"No",
				restorationOfSi:"Yes- If More Than 3 Lakh SI Opted",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"24 Months& 36 Months As Specified",
				maternityCoverWithNewBornCover:"Yes- 24 Months Waiting Period With Cappings- 40K- Normal; 60K - Csection",
				ped:"36 Months",
				capping:"Cataract- 10% Of Si -50K Max",
				mentalIllnessCover:"Named 5 Illness- 25% Of Si - Max 3L PPP",
				homeCare:"Max-10% Of Si Max-30KPPP",
				roadAmbulance:"0.5% Of Si Max-2500 Pe; 1% Of Simax -5K Ppp",
				proportionateClause:"Present",
				reasonableCustomary:"Present",
				donorExpenses:"Present",
				healthCheckup:"1% Of Avg Si- Max-5K Pp;10K Pp Onfloaterbasis",
				ayushCover:"No Sublimit",
				dailyCashCover:"Present",
				ncdRenewalPremium:"5% On 1St 5Slabs & 2.5% For Next Slab Tillmax 50%",
				cbSi:"20% On 1St5 Slabs&10% For Next Slabupto 200%"
			},
			optionalCovers: {
				maternity: {
					available: true,
					sumInsuredOptions: [350000, 400000, 450000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
					premiums: [12000, 13750, 15500, 17000, 20350, 20600, 20850, 21000, 21200, 22000, 23000, 23500],
					basis: 'per_family'
				},
				dailyCash: {
					available: true,
					individual: {
						ageBrackets: ['≤50', '51-60', '>60'],
						sumInsuredBrackets: ['≤5L', '5-15L', '>15L'],
						premiums: [[300, 600, 1200], [400, 800, 1600], [500, 1000, 2000]]
					},
					floater: {
						ageBrackets: ['≤50', '51-60', '>60'],
						sumInsuredBrackets: ['≤5L', '5-15L', '>15L'],
						premiums: [[400, 800, 1600], [500, 1000, 2000], [600, 1200, 2400]]
					}
				}
			}
		},

		IHP: {
			id: 'IHP',
			name: 'Individual Health Policy (IHIP)',
			category: 'individual',
			planTypes: ['individual'],
			
			eligibility: {
				adult: { 
					minAge: 18, 
					maxAge: 60 
				},
				child: { 
					minAge: 0.25, 
					maxAge: 17 
				},
				renewalMaxAge: null
			},
			
			hasZonalPricing: true,
			zones: ['A', 'B', 'C'],
			
			ageBrackets: ['0-17', '18-25', '26-30', '31-35', '36-40', '41-45', '46-50', '51-55', '56-60', '61-65', '66-70', '71-75', '75+'],
			
			sumInsuredOptions: [50000, 75000, 100000, 125000, 150000, 175000, 200000, 225000, 250000, 275000, 300000, 325000, 350000, 375000, 400000, 425000, 450000, 475000, 500000, 525000, 550000, 575000, 600000, 625000, 650000, 675000, 700000, 725000, 750000, 775000, 800000, 825000, 850000, 875000, 900000, 925000, 950000, 975000, 1000000, 1500000, 2000000],
			
			// Premium rates for individual policies only
			premiumRates: {
				individual: {
					A: {
						sumInsured: [50000, 75000, 100000, 125000, 150000, 175000, 200000, 225000, 250000, 275000, 300000, 325000, 350000, 375000, 400000, 425000, 450000, 475000, 500000, 525000, 550000, 575000, 600000, 625000, 650000, 675000, 700000, 725000, 750000, 775000, 800000, 825000, 850000, 875000, 900000, 925000, 950000, 975000, 1000000, 1500000, 2000000],
						rates: [
							[1149, 1939, 2154, 2585, 3141, 3141, 3758, 4510, 6476, 6832, 7770, 8772, 10119],
							[1532, 2585, 2872, 3446, 4188, 4188, 5011, 6013, 8635, 9110, 10360, 11696, 13493],
							[1915, 3231, 3590, 4308, 5235, 5235, 6264, 7517, 10793, 11387, 12949, 14620, 16866],
							[2100, 3544, 3938, 4725, 5743, 5796, 6935, 8322, 11950, 13285, 15108, 17057, 19677],
							[2285, 3856, 4286, 5143, 6250, 6357, 7606, 9127, 13106, 15183, 17266, 19494, 22488],
							[2471, 4169, 4634, 5561, 6758, 6918, 8277, 9933, 14262, 17081, 19424, 21931, 25298],
							[2656, 4482, 4982, 5978, 7266, 7479, 8948, 10738, 15419, 18978, 21582, 24367, 28109],
							[2834, 4783, 5316, 6379, 7753, 8227, 9843, 11812, 16961, 20876, 23741, 26804, 30920],
							[3013, 5084, 5650, 6780, 8240, 8975, 10738, 12886, 18503, 22774, 25899, 29241, 33731],
							[3191, 5385, 5984, 7181, 8727, 9722, 11633, 13959, 20044, 24672, 28057, 31677, 36542],
							[3370, 5686, 6318, 7582, 9214, 10470, 12528, 15033, 21586, 26570, 30215, 34114, 39353],
							[3427, 5783, 6426, 7711, 9371, 11031, 13199, 15839, 22743, 27993, 31834, 35942, 41461],
							[3485, 5880, 6533, 7840, 9528, 11592, 13870, 16644, 23899, 29416, 33453, 37769, 43570],
							[3542, 5977, 6641, 7969, 9685, 12153, 14541, 17449, 25055, 30840, 35071, 39597, 45678],
							[3599, 6074, 6749, 8099, 9842, 12714, 15212, 18255, 26212, 32263, 36690, 41424, 47786],
							[3657, 6171, 6857, 8228, 9999, 13275, 15883, 19060, 27368, 33687, 38309, 43252, 49894],
							[3714, 6268, 6964, 8357, 10156, 13836, 16555, 19865, 28525, 35110, 39928, 45079, 52002],
							[3772, 6365, 7072, 8486, 10313, 14397, 17226, 20671, 29681, 36533, 41546, 46907, 54111],
							[3829, 6462, 7180, 8616, 10470, 14958, 17897, 21476, 30838, 37957, 43165, 48735, 56219],
							[3887, 6559, 7287, 8745, 10627, 15182, 18165, 21798, 31300, 38716, 44028, 49709, 57343],
							[3944, 6656, 7395, 8874, 10784, 15406, 18434, 22120, 31763, 39475, 44891, 50684, 58468],
							[4001, 6752, 7503, 9003, 10941, 15631, 18702, 22443, 32225, 40234, 45755, 51659, 59592],
							[4059, 6849, 7610, 9132, 11099, 15855, 18971, 22765, 32688, 40993, 46618, 52633, 60716],
							[4116, 6946, 7718, 9262, 11256, 16079, 19239, 23087, 33150, 41752, 47481, 53608, 61841],
							[4174, 7043, 7826, 9391, 11413, 16304, 19507, 23409, 33613, 42512, 48345, 54583, 62965],
							[4231, 7140, 7933, 9520, 11570, 16528, 19776, 23731, 34075, 43271, 49208, 55557, 64089],
							[4289, 7237, 8041, 9649, 11727, 16752, 20044, 24053, 34538, 44030, 50071, 56532, 65214],
							[4346, 7334, 8149, 9779, 11884, 16977, 20313, 24375, 35001, 44789, 50935, 57507, 66338],
							[4404, 7431, 8257, 9908, 12041, 17201, 20581, 24698, 35463, 45548, 51798, 58481, 67463],
							[4461, 7528, 8364, 10037, 12198, 17426, 20850, 25020, 35926, 46307, 52661, 59456, 68587],
							[4518, 7625, 8472, 10166, 12355, 17650, 21118, 25342, 36388, 47066, 53524, 60431, 69711],
							[4576, 7722, 8580, 10296, 12512, 17874, 21387, 25664, 36851, 47825, 54388, 61406, 70836],
							[4633, 7819, 8687, 10425, 12669, 18099, 21655, 25986, 37313, 48585, 55251, 62380, 71960],
							[4691, 7916, 8795, 10554, 12826, 18323, 21924, 26308, 37776, 49344, 56114, 63355, 73084],
							[4748, 8012, 8903, 10683, 12983, 18547, 22192, 26630, 38239, 50103, 56978, 64330, 74209],
							[4806, 8109, 9010, 10813, 13140, 18772, 22460, 26953, 38701, 50862, 57841, 65304, 75333],
							[4863, 8206, 9118, 10942, 13297, 18996, 22729, 27275, 39164, 51621, 58704, 66279, 76458],
							[4920, 8303, 9226, 11071, 13454, 19220, 22997, 27597, 39626, 52380, 59568, 67254, 77582],
							[4978, 8400, 9334, 11200, 13611, 19445, 23266, 27919, 40089, 53139, 60431, 68228, 78706],
							[5600, 9450, 10500, 12600, 15313, 21875, 26174, 31409, 45100, 59782, 67985, 76757, 88545],
							[6020, 10159, 11288, 13545, 16461, 23516, 28137, 33765, 48482, 64265, 73084, 82514, 95185]
						]
					},
					B: {
						sumInsured: [50000, 75000, 100000, 125000, 150000, 175000, 200000, 225000, 250000, 275000, 300000, 325000, 350000, 375000, 400000, 425000, 450000, 475000, 500000, 525000, 550000, 575000, 600000, 625000, 650000, 675000, 700000, 725000, 750000, 775000, 800000, 825000, 850000, 875000, 900000, 925000, 950000, 975000, 1000000, 1500000, 2000000],
						rates: [
							[981, 1656, 1840, 2208, 2683, 2683, 3210, 3852, 5531, 5836, 6637, 7493, 8644],
							[1308, 2208, 2453, 2944, 3577, 3577, 4280, 5136, 7375, 7781, 8849, 9991, 11525],
							[1635, 2760, 3066, 3680, 4472, 4472, 5350, 6420, 9219, 9726, 11061, 12488, 14406],
							[1794, 3027, 3364, 4036, 4905, 4951, 5924, 7108, 10207, 11347, 12905, 14570, 16807],
							[1952, 3294, 3661, 4393, 5339, 5430, 6497, 7796, 11195, 12969, 14748, 16651, 19208],
							[2110, 3561, 3958, 4750, 5772, 5909, 7070, 8484, 12182, 14590, 16592, 18732, 21609],
							[2269, 3828, 4255, 5106, 6206, 6388, 7643, 9172, 13170, 16211, 18435, 20814, 24010],
							[2421, 4085, 4541, 5449, 6622, 7027, 8408, 10089, 14487, 17832, 20279, 22895, 26411],
							[2573, 4343, 4826, 5791, 7038, 7666, 9172, 11007, 15804, 19453, 22122, 24976, 28812],
							[2726, 4600, 5111, 6134, 7454, 8305, 9936, 11924, 17121, 21074, 23966, 27058, 31213],
							[2878, 4857, 5397, 6476, 7870, 8943, 10701, 12841, 18438, 22695, 25809, 29139, 33614],
							[2927, 4940, 5489, 6586, 8004, 9422, 11274, 13529, 19426, 23911, 27192, 30700, 35415],
							[2976, 5023, 5581, 6697, 8138, 9902, 11847, 14217, 20414, 25127, 28574, 32261, 37216],
							[3025, 5105, 5673, 6807, 8273, 10381, 12421, 14905, 21402, 26342, 29957, 33822, 39016],
							[3074, 5188, 5765, 6918, 8407, 10860, 12994, 15593, 22389, 27558, 31340, 35383, 40817],
							[3124, 5271, 5857, 7028, 8541, 11339, 13567, 16280, 23377, 28774, 32722, 36944, 42618],
							[3173, 5354, 5949, 7138, 8675, 11818, 14140, 16968, 24365, 29990, 34105, 38505, 44419],
							[3222, 5437, 6041, 7249, 8809, 12297, 14714, 17656, 25353, 31206, 35487, 40066, 46219],
							[3271, 5519, 6133, 7359, 8943, 12776, 15287, 18344, 26340, 32421, 36870, 41627, 48020],
							[3320, 5602, 6225, 7470, 9078, 12968, 15516, 18619, 26735, 33070, 37607, 42460, 48981],
							[3369, 5685, 6317, 7580, 9212, 13160, 15745, 18895, 27131, 33718, 38345, 43293, 49941],
							[3418, 5768, 6409, 7690, 9346, 13351, 15975, 19170, 27526, 34367, 39082, 44125, 50901],
							[3467, 5851, 6501, 7801, 9480, 13543, 16204, 19445, 27921, 35015, 39820, 44958, 51862],
							[3516, 5933, 6593, 7911, 9614, 13734, 16433, 19720, 28316, 35664, 40557, 45790, 52822],
							[3565, 6016, 6685, 8021, 9748, 13926, 16663, 19995, 28711, 36312, 41294, 46623, 53783],
							[3614, 6099, 6777, 8132, 9882, 14118, 16892, 20270, 29106, 36960, 42032, 47455, 54743],
							[3663, 6182, 6869, 8242, 10017, 14309, 17121, 20545, 29501, 37609, 42769, 48288, 55703],
							[3712, 6264, 6961, 8353, 10151, 14501, 17351, 20821, 29896, 38257, 43507, 49120, 56664],
							[3761, 6347, 7052, 8463, 10285, 14693, 17580, 21096, 30291, 38906, 44244, 49953, 57624],
							[3810, 6430, 7144, 8573, 10419, 14884, 17809, 21371, 30687, 39554, 44981, 50785, 58585],
							[3859, 6513, 7236, 8684, 10553, 15076, 18038, 21646, 31082, 40202, 45719, 51618, 59545],
							[3909, 6596, 7328, 8794, 10687, 15268, 18268, 21921, 31477, 40851, 46456, 52451, 60505],
							[3958, 6678, 7420, 8905, 10821, 15459, 18497, 22196, 31872, 41499, 47194, 53283, 61466],
							[4007, 6761, 7512, 9015, 10956, 15651, 18726, 22472, 32267, 42148, 47931, 54116, 62426],
							[4056, 6844, 7604, 9125, 11090, 15843, 18956, 22747, 32662, 42796, 48668, 54948, 63387],
							[4105, 6927, 7696, 9236, 11224, 16034, 19185, 23022, 33057, 43445, 49406, 55781, 64347],
							[4154, 7010, 7788, 9346, 11358, 16226, 19414, 23297, 33452, 44093, 50143, 56613, 65308],
							[4203, 7092, 7880, 9456, 11492, 16417, 19644, 23572, 33847, 44741, 50881, 57446, 66268],
							[4252, 7175, 7972, 9567, 11626, 16609, 19873, 23847, 34242, 45390, 51618, 58278, 67228],
							[4783, 8072, 8969, 10763, 13080, 18685, 22357, 26828, 38523, 51064, 58070, 65563, 75632],
							[5142, 8677, 9642, 11570, 14061, 20087, 24034, 28841, 41412, 54893, 62426, 70480, 81304]
						]
					},
					C: {
						sumInsured: [50000, 75000, 100000, 125000, 150000, 175000, 200000, 225000, 250000, 275000, 300000, 325000, 350000, 375000, 400000, 425000, 450000, 475000, 500000, 525000, 550000, 575000, 600000, 625000, 650000, 675000, 700000, 725000, 750000, 775000, 800000, 825000, 850000, 875000, 900000, 925000, 950000, 975000, 1000000, 1500000, 2000000],
						rates: [
							[909, 1535, 1705, 2046, 2487, 2487, 2975, 3570, 5127, 5409, 6151, 6945, 8011],
							[1213, 2046, 2274, 2728, 3316, 3316, 3967, 4761, 6836, 7212, 8201, 9260, 10682],
							[1516, 2558, 2842, 3410, 4144, 4144, 4959, 5951, 8545, 9015, 10252, 11574, 13352],
							[1662, 2805, 3117, 3741, 4546, 4589, 5490, 6588, 9460, 10517, 11960, 13504, 15577],
							[1809, 3053, 3393, 4072, 4948, 5033, 6022, 7226, 10376, 12020, 13669, 15433, 17803],
							[1956, 3301, 3668, 4402, 5350, 5477, 6553, 7863, 11291, 13522, 15377, 17362, 20028],
							[2103, 3548, 3944, 4733, 5752, 5921, 7084, 8501, 12207, 15025, 17086, 19291, 22253],
							[2244, 3787, 4208, 5050, 6138, 6513, 7793, 9351, 13427, 16527, 18795, 21220, 24479],
							[2385, 4025, 4473, 5367, 6523, 7105, 8501, 10201, 14648, 18029, 20503, 23149, 26704],
							[2526, 4263, 4737, 5685, 6909, 7697, 9209, 11051, 15868, 19532, 22212, 25078, 28929],
							[2668, 4502, 5002, 6002, 7294, 8289, 9918, 11901, 17089, 21034, 23921, 27007, 31155],
							[2713, 4578, 5087, 6104, 7419, 8733, 10449, 12539, 18005, 22161, 25202, 28454, 32824],
							[2759, 4655, 5172, 6207, 7543, 9177, 10980, 13177, 18920, 23288, 26483, 29901, 34493],
							[2804, 4732, 5258, 6309, 7667, 9621, 11512, 13814, 19836, 24415, 27765, 31347, 36162],
							[2850, 4809, 5343, 6411, 7792, 10065, 12043, 14452, 20751, 25542, 29046, 32794, 37831],
							[2895, 4885, 5428, 6514, 7916, 10509, 12574, 15089, 21667, 26669, 30328, 34241, 39500],
							[2940, 4962, 5513, 6616, 8040, 10953, 13106, 15727, 22582, 27795, 31609, 35688, 41169],
							[2986, 5039, 5599, 6718, 8165, 11397, 13637, 16364, 23498, 28922, 32891, 37135, 42838],
							[3031, 5115, 5684, 6821, 8289, 11841, 14168, 17002, 24413, 30049, 34172, 38582, 44507],
							[3077, 5192, 5769, 6923, 8413, 12019, 14381, 17257, 24779, 30650, 34856, 39353, 45397],
							[3122, 5269, 5854, 7025, 8538, 12197, 14593, 17512, 25145, 31251, 35539, 40125, 46287],
							[3168, 5346, 5940, 7128, 8662, 12374, 14806, 17767, 25512, 31852, 36223, 40896, 47177],
							[3213, 5422, 6025, 7230, 8786, 12552, 15018, 18022, 25878, 32453, 36906, 41668, 48067],
							[3259, 5499, 6110, 7332, 8911, 12730, 15231, 18277, 26244, 33054, 37589, 42440, 48957],
							[3304, 5576, 6195, 7435, 9035, 12907, 15443, 18532, 26610, 33655, 38273, 43211, 49847],
							[3350, 5653, 6281, 7537, 9159, 13085, 15656, 18787, 26976, 34256, 38956, 43983, 50737],
							[3395, 5729, 6366, 7639, 9284, 13262, 15868, 19042, 27343, 34857, 39640, 44755, 51628],
							[3441, 5806, 6451, 7741, 9408, 13440, 16081, 19297, 27709, 35458, 40323, 45526, 52518],
							[3486, 5883, 6536, 7844, 9532, 13618, 16294, 19552, 28075, 36059, 41007, 46298, 53408],
							[3532, 5960, 6622, 7946, 9657, 13795, 16506, 19807, 28441, 36660, 44981, 50785, 58585],
							[3577, 6036, 6707, 8048, 9781, 13973, 16719, 20062, 28807, 37261, 42374, 47841, 55188],
							[3623, 6113, 6792, 8151, 9905, 14150, 16931, 20317, 29174, 37862, 43057, 48413, 55846],
							[3668, 6190, 6877, 8253, 10030, 14328, 17144, 20572, 29540, 38463, 43740, 48984, 56505],
							[3713, 6266, 6963, 8355, 10154, 14506, 17356, 20827, 29906, 39064, 44424, 49556, 57164],
							[3759, 6343, 7048, 8458, 10278, 14683, 17569, 21082, 30272, 39665, 45107, 50128, 57822],
							[3804, 6420, 7133, 8560, 10403, 14861, 17781, 21337, 30638, 40266, 45791, 50699, 58481],
							[3850, 6497, 7219, 8662, 10527, 15039, 17994, 21592, 31005, 40867, 46474, 51271, 59139],
							[3895, 6573, 7304, 8765, 10651, 15216, 18206, 21847, 31371, 41468, 47158, 51842, 59798],
							[3941, 6650, 7389, 8867, 10776, 15394, 18419, 22103, 31737, 42069, 47841, 54414, 60456],
							[4433, 7481, 8313, 9975, 12123, 17318, 20721, 24865, 35704, 47327, 53821, 60766, 70098],
							[4766, 8043, 8936, 10723, 13032, 18617, 22275, 26730, 38382, 50877, 57858, 65323, 75355]
						]
					}
				}
			},
			
			optionalCovers: {
				dailyCash: {
					available: true,
					allowances: [500, 1000, 2000],
					premiums: [70, 140, 280]
				}
			},
			
			discounts: {
				family: { 
					rate: 0.05, 
					applicableTo: 'multiple_members' 
				},
				directChannel: { 
					available: true 
				}
			},
			
			features: {
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"1 % Of Si",
				icu:"2 % Of Si",
				preHospitalisation:"30- Days",
				postHospitalisation:"60-Days",
				mtmat:"Yes",
				copay:"No",
				restorationOfSi:"No",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"No",
				maternityCoverWithNewBornCover:"No",
				ped:"No",
				capping:"No Capping",
				mentalIllnessCover:"No",
				homeCare:"Max-10% Of Si Max-30Kpppp*",
				roadAmbulance:"Max -2K",
				proportionateClause:"Present",
				reasonableCustomary:"Present",
				donorExpenses:"Present",
				healthCheckup:"1% Of Si Max-5K Ppp",
				ayushCover:"No Sublimit",
				dailyCashCover:"Present",
				ncdRenewalPremium:"No",
				cbSi:"No"
			}
		},

		SSHIP: {
			id: 'SSHIP',
			name: 'Samavesh Suraksha Health Insurance Policy (SSHIP)',
			category: 'specialized',
			planTypes: ['individual'],
			
			eligibility: {
				adult: { 
					minAge: 18, 
					maxAge: 65 
				},
				child: { 
					minAge: 0, 
					maxAge: 17 
				},
				renewalMaxAge: null,
				specialConditions: [
					'disability_40_percent_or_more', 
					'hiv_aids_cd4_above_350'
				]
			},
			
			hasZonalPricing: false,
			zones: ['uniform'],
			
			ageBrackets: ['0-17', '18-25', '26-30', '31-35', '36-40', '41-45', '46-50', '51-55', '56-60', '61-65', '66-70', '71-75', '75+'],
			
			sumInsuredOptions: [400000, 500000],
			
			premiumRates: {
				individual: {
					uniform: {
						with_copayment: {
							sumInsured: [400000, 500000],
							rates: [
								[2670, 4506, 5006, 6008, 7300, 9430, 11378, 13653, 19605, 26141, 31886, 36000, 41528],
								[2841, 4793, 5326, 6391, 7767, 11096, 13386, 16062, 23064, 30755, 37512, 42353, 48857]
							]
						},
						without_copayment: {
							sumInsured: [400000, 500000],
							rates: [
								[3276, 5529, 6143, 7372, 8958, 11572, 13960, 16752, 24054, 32074, 39123, 44172, 50955],
								[3485, 5882, 6535, 7842, 9530, 13614, 16424, 19709, 28299, 37735, 46027, 51967, 59947]
							]
						}
					}
				}
			},
			
			optionalCovers: {
				copaymentWaiver: {
					available: true,
					defaultCopayment: 0.20
				}
			},
			
			discounts: {
				digitalDirect: { 
					rate: 0.025 
				}
			},
			
			features: {
				
			}
		},

		ArogyaSanjeevani:{
			id:'ArogyaSanjeevani',
			name:'Arogya Sanjeevani',
			category:'Standard',
			planTypes:['individual','family_floater'],
			eligibility:{
				adult:{
					minAge:18,
					maxAge:60
				},
				child:{
					minAge:0.25,
					maxAge:25
				}
			},
			hasZonalPricing:false,
			zones:['uniform'],
			ageBrackets:['91d-25', '26-30', '31-35', '36-40', '41-45', '46-50', '51-55', '56-60', '61-65', '66-70', '71-75', '>75'],
			sumInsuredOptions:[50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
			premiumRates:{
				individual:{
					uniform:{
						sumInsured:[50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
						rates:[
							[2713, 3242, 3415, 3855, 4399, 5224, 6032, 8148, 8705, 9901, 11782, 13389],
							[3618, 4323, 4553, 5141, 5865, 6966, 8043, 10864, 11607, 13201, 15710, 17853],
							[4187, 5004, 5277, 6036, 6866, 8569, 10474, 13714, 14680, 18045, 21072, 24164],
							[4756, 5686, 6001, 6931, 7865, 10173, 12903, 16566, 17753, 22890, 26433, 30475],
							[5120, 6118, 6576, 7569, 9220, 11384, 14415, 19200, 21006, 26600, 30706, 35621],
							[5482, 6550, 7150, 8208, 10576, 12594, 15927, 21836, 24259, 30310, 34980, 40768],
							[5545, 6626, 7297, 8337, 11050, 13145, 16492, 22762, 25708, 31691, 36577, 43081],
							[5608, 6702, 7444, 8467, 11525, 13696, 17056, 23689, 27156, 33071, 38176, 45394],
							[5702, 6813, 7540, 8546, 11604, 14132, 17623, 24436, 28689, 35072, 40486, 47875],
							[5794, 6923, 7636, 8626, 11684, 14567, 18192, 25185, 30221, 37072, 42796, 50356],
							[5997, 7166, 7903, 8928, 12092, 15077, 18828, 26066, 31279, 38370, 44294, 52119],
							[6200, 7408, 8171, 9230, 12501, 15586, 19465, 26948, 32337, 39667, 45792, 53881],
							[6403, 7650, 8438, 9531, 12910, 16096, 20102, 27829, 33395, 40965, 47290, 55644],
							[6576, 7858, 8667, 9790, 13261, 16533, 20648, 28585, 34301, 42077, 48574, 57154],
							[6750, 8066, 8896, 10049, 13611, 16970, 21193, 29340, 35208, 43189, 49858, 58665],
							[6924, 8274, 9125, 10308, 13962, 17407, 21739, 30096, 36115, 44301, 51141, 60176],
							[7040, 8412, 9278, 10480, 14195, 17699, 22103, 30600, 36719, 45043, 51997, 61183],
							[7156, 8550, 9431, 10653, 14429, 17990, 22467, 31103, 37323, 45784, 52853, 62190],
							[7272, 8689, 9583, 10825, 14663, 18281, 22831, 31607, 37928, 46526, 53709, 63197],
							[7388, 8827, 9736, 10998, 14897, 18573, 23194, 32111, 38532, 47267, 54565, 64204]
						]
					}
				},
				family_floater:{
					uniform:{
						adult1Child1: {
							sumInsured: [50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
							rates: [
								[4095, 4624, 4796, 5237, 5780, 6606, 7414, 9529, 9898, 11094, 12975, 14583],
								[5460, 6165, 6395, 6982, 7707, 8807, 9885, 12706, 13198, 14791, 17300, 19443],
								[6437, 7255, 7527, 8286, 9116, 10819, 12724, 15964, 16624, 19988, 23015, 26107],
								[7415, 8344, 8659, 9589, 10523, 12831, 15561, 19225, 20048, 25186, 28728, 32771],
								[8045, 9043, 9501, 10494, 12146, 14309, 17341, 22126, 23533, 29127, 33233, 38147],
								[8675, 9743, 10342, 11401, 13769, 15786, 19120, 25028, 27017, 33067, 37738, 43525],
								[8815, 9896, 10566, 11606, 14320, 16415, 19761, 26031, 28532, 34515, 39401, 45905],
								[8954, 10049, 10790, 11814, 14871, 17043, 20403, 27035, 30047, 35962, 41066, 48285],
								[9133, 10244, 10971, 11977, 15035, 17563, 21054, 27867, 31652, 38035, 43449, 50839],
								[9311, 10440, 11153, 12142, 15200, 18083, 21708, 28701, 33259, 40109, 45833, 53393],
								[9637, 10805, 11543, 12567, 15732, 18716, 22468, 29706, 34423, 41513, 47437, 55262],
								[9962, 11171, 11933, 12992, 16264, 19349, 23228, 30711, 35587, 42917, 49042, 57131],
								[10288, 11536, 12324, 13417, 16796, 19982, 23987, 31715, 36751, 44321, 50646, 59000],
								[10568, 11849, 12658, 13781, 17252, 20525, 24639, 32576, 37748, 45524, 52021, 60601],
								[10847, 12163, 12993, 14146, 17708, 21067, 25290, 33437, 38746, 46727, 53396, 62203],
								[11126, 12476, 13327, 14510, 18164, 21610, 25941, 34298, 39744, 47931, 54771, 63805],
								[11313, 12685, 13550, 14753, 18468, 21971, 26375, 34872, 40409, 48733, 55687, 64873],
								[11499, 12893, 13773, 14996, 18772, 22333, 26810, 35446, 41074, 49535, 56604, 65941],
								[11685, 13102, 13997, 15238, 19076, 22695, 27244, 36020, 41739, 50337, 57521, 67009],
								[11871, 13311, 14220, 15481, 19380, 23056, 27678, 36594, 42405, 51140, 58437, 68076]
							]
						},
						adult1Child2: {
							sumInsured: [50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
							rates: [
								[5476, 6005, 6178, 6618, 7162, 7987, 8795, 10911, 11091, 12287, 14168, 15776],
								[7301, 8007, 8237, 8824, 9549, 10649, 11727, 14548, 14788, 16382, 18891, 21034],
								[8687, 9505, 9777, 10536, 11366, 13069, 14974, 18215, 18567, 21931, 24958, 28050],
								[10073, 11002, 11318, 12247, 13181, 15489, 18219, 21883, 22344, 27482, 31024, 35067],
								[10971, 11969, 12426, 13420, 15071, 17235, 20266, 25051, 26059, 31653, 35759, 40674],
								[11868, 12936, 13535, 14593, 16961, 18979, 22312, 28221, 29774, 35825, 40495, 46282],
								[12084, 13165, 13836, 14876, 17590, 19684, 23031, 29301, 31356, 37339, 42225, 48729],
								[12301, 13395, 14137, 15160, 18218, 20390, 23750, 30382, 32937, 38852, 43957, 51176],
								[12564, 13675, 14402, 15408, 18466, 20994, 24485, 31298, 34615, 40998, 46412, 53802],
								[12827, 13956, 14669, 15659, 18717, 21600, 25225, 32218, 36296, 43147, 48870, 56430],
								[13276, 14445, 15183, 16207, 19372, 22356, 26108, 33346, 37566, 44657, 50581, 58405],
								[13725, 14933, 15696, 16755, 20027, 23112, 26990, 34473, 38836, 46167, 52291, 60381],
								[14174, 15422, 16209, 17303, 20682, 23868, 27873, 35601, 40107, 47677, 54002, 62356],
								[14559, 15841, 16649, 17773, 21243, 24516, 28630, 36567, 41196, 48971, 55468, 64049],
								[14944, 16259, 17090, 18242, 21805, 25164, 29387, 37534, 42284, 50266, 56934, 65741],
								[15329, 16678, 17530, 18712, 22366, 25812, 30143, 38500, 43373, 51560, 58400, 67434],
								[15585, 16957, 17823, 19025, 22741, 26244, 30648, 39145, 44099, 52423, 59378, 68563],
								[15842, 17236, 18116, 19339, 23115, 26676, 31152, 39789, 44825, 53286, 60355, 69692],
								[16098, 17515, 18410, 19652, 23489, 27108, 31657, 40433, 45551, 54149, 61332, 70820],
								[16355, 17794, 18703, 19965, 23864, 27540, 32161, 41078, 46277, 55012, 62310, 71949]
							]
						},
						adults2: {
							sumInsured: [50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
							rates: [
								[4716, 5388, 5702, 6471, 8755, 10407, 14055, 14625, 16633, 19795, 22494],
								[6288, 7183, 7602, 8628, 11674, 13876, 18741, 19501, 22178, 26393, 29992],
								[7277, 8112, 8801, 10177, 14360, 18068, 23658, 24440, 29352, 34939, 39204],
								[8267, 9040, 10001, 11726, 17046, 22260, 28577, 29381, 36525, 43483, 48416],
								[8893, 9761, 10838, 13165, 18759, 24798, 32536, 33187, 41676, 49614, 55569],
								[9519, 10482, 11676, 14605, 20473, 27336, 36494, 36993, 46827, 55744, 62724],
								[9619, 10593, 11799, 14841, 20803, 27938, 37296, 38033, 48143, 57310, 64485],
								[9720, 10702, 11922, 15076, 21133, 28539, 38099, 39072, 49458, 58876, 66248],
								[9869, 10869, 12106, 15390, 21573, 29289, 39100, 40318, 51037, 60755, 68362],
								[10020, 11033, 12290, 15704, 22014, 30040, 40103, 41566, 52616, 62635, 70476],
								[10370, 11420, 12720, 16254, 22784, 31092, 41507, 43021, 54457, 64827, 72943],
								[10721, 11806, 13151, 16804, 23555, 32143, 42910, 44476, 56299, 67019, 75410],
								[11072, 12192, 13581, 17353, 24325, 33194, 44314, 45931, 58140, 69211, 77876],
								[11372, 12523, 13949, 17825, 24986, 34096, 45517, 47178, 59719, 71090, 79991],
								[11673, 12854, 14318, 18296, 25646, 34997, 46720, 48425, 61297, 72969, 82105],
								[11974, 13185, 14687, 18767, 26307, 35898, 47923, 49672, 62876, 74848, 84219],
								[12174, 13406, 14933, 19081, 26747, 36499, 48725, 50503, 63928, 76101, 85629],
								[12374, 13626, 15179, 19395, 27187, 37100, 49528, 51334, 64980, 77354, 87038],
								[12575, 13847, 15424, 19709, 27627, 37700, 50330, 52165, 66033, 78606, 88448],
								[12775, 14068, 15670, 20023, 28068, 38301, 51132, 52997, 67085, 79859, 89857]
							]
						},
						adults2Child1: {
							sumInsured: [50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
							rates: [
								[6097, 6769, 7083, 7853, 10137, 11788, 15437, 15819, 17827, 20988, 23687],
								[8130, 9025, 9444, 10470, 13516, 15718, 20583, 21091, 23769, 27984, 31582],
								[9527, 10362, 11052, 12428, 16610, 20318, 25908, 26384, 31295, 36882, 41147],
								[10925, 11698, 12659, 14384, 19704, 24918, 31236, 31677, 38821, 45779, 50712],
								[11818, 12686, 13764, 16091, 21684, 27724, 35461, 35713, 44203, 52140, 58096],
								[12712, 13675, 14869, 17798, 23666, 30529, 39687, 39751, 49585, 58502, 65481],
								[12889, 13863, 15069, 18111, 24073, 31208, 40566, 40857, 50967, 60134, 67309],
								[13067, 14049, 15269, 18423, 24479, 31886, 41446, 41962, 52348, 61766, 69138],
								[13300, 14300, 15537, 18821, 25004, 32720, 42531, 43282, 54001, 63718, 71325],
								[13536, 14550, 15807, 19221, 25530, 33557, 43620, 44603, 55653, 65672, 73514],
								[14010, 15059, 16360, 19894, 26424, 34731, 45146, 46164, 57601, 67970, 76086],
								[14484, 15568, 16913, 20566, 27318, 35906, 46673, 47725, 59548, 70269, 78659],
								[14958, 16078, 17466, 21239, 28211, 37080, 48200, 49287, 61496, 72567, 81232],
								[15364, 16514, 17941, 21816, 28977, 38087, 49508, 50625, 63166, 74537, 83438],
								[15770, 16951, 18415, 22392, 29743, 39093, 50817, 51963, 64835, 76508, 85643],
								[16176, 17387, 18889, 22969, 30509, 40100, 52126, 53301, 66505, 78478, 87849],
								[16447, 17678, 19205, 23353, 31019, 40771, 52998, 54193, 67618, 79791, 89319],
								[16717, 17969, 19521, 23738, 31530, 41442, 53870, 55085, 68731, 81105, 90789],
								[16988, 18260, 19838, 24122, 32041, 42114, 54743, 55977, 69844, 82418, 92259],
								[17259, 18551, 20154, 24507, 32551, 42785, 55615, 56869, 70957, 83731, 93730]
							]
						},
						adults2Child2: {
							sumInsured: [50000, 100000, 150000, 200000, 250000, 300000, 350000, 400000, 450000, 500000, 550000, 600000, 650000, 700000, 750000, 800000, 850000, 900000, 950000, 1000000],
							rates: [
								[7479, 8150, 8465, 9234, 11518, 13170, 16818, 17012, 19020, 22181, 24880],
								[9972, 10867, 11286, 12312, 15358, 17560, 22424, 22682, 25360, 29575, 33173],
								[11777, 12612, 13302, 14678, 18860, 22568, 28158, 28327, 33239, 38825, 43090],
								[13583, 14356, 15317, 17042, 22362, 27576, 33894, 33973, 41117, 48075, 53008],
								[14744, 15612, 16689, 19016, 24609, 30649, 38387, 38240, 46730, 54667, 60623],
								[15904, 16867, 18062, 20991, 26858, 33722, 42879, 42508, 52342, 61259, 68239],
								[16158, 17132, 18339, 21381, 27342, 34478, 43835, 43681, 53790, 62958, 70133],
								[16414, 17396, 18615, 21770, 27826, 35232, 44792, 44853, 55239, 64657, 72029],
								[16731, 17731, 18968, 22252, 28435, 36151, 45962, 46245, 56964, 66681, 74288],
								[17053, 18066, 19323, 22737, 29047, 37073, 47136, 47640, 58690, 68709, 76551],
								[17650, 18699, 20000, 23533, 30064, 38371, 48786, 49308, 60744, 71114, 79230],
								[18246, 19331, 20676, 24329, 31080, 39668, 50436, 50975, 62798, 73518, 81909],
								[18843, 19963, 21352, 25125, 32097, 40966, 52086, 52643, 64852, 75923, 84588],
								[19355, 20505, 21932, 25807, 32968, 42078, 53500, 54072, 66613, 77985, 86885],
								[19866, 21047, 22512, 26489, 33840, 43190, 54914, 55501, 68374, 80046, 89181],
								[20378, 21589, 23091, 27171, 34711, 44302, 56328, 56930, 70134, 82107, 91478],
								[20719, 21951, 23478, 27626, 35292, 45044, 57271, 57883, 71308, 83481, 93009],
								[21060, 22312, 23864, 28081, 35873, 45785, 58213, 58836, 72482, 84855, 94540],
								[21401, 22673, 24251, 28535, 36454, 46527, 59156, 59789, 73656, 86230, 96071],
								[21742, 23035, 24637, 28990, 37035, 47268, 60099, 60741, 74829, 87604, 97602]
							]
						}
					}
				}
			},
			discounts:{
				family:{
					rate:0.05
				}
			},
			features:{
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"2% Of Si- Upto 5K Max",
				icu:"5 % Of Si Upto 10Kmax",
				preHospitalisation:"30 Days",
				postHospitalisation:"60 Days",
				mtmat:"50 % Of Si",
				copay:"5 % Of Claim Amount Admisible &Payable",
				restorationOfSi:"No",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"24 Months &36 Monthsas Specified",
				maternityCoverWithNewBornCover:"No",
				ped:"36 Months",
				capping:"Cataract- 25% Of Si Or40K Weilower",
				mentalIllnessCover:"No",
				homeCare:"Max-10% Of Si Max-30Kpppp*",
				roadAmbulance:"Max -2K",
				proportionateClause:"Present",
				reasonableCustomary:"Absent",
				donorExpenses:"Present",
				healthCheckup:"Absent",
				ayushCover:"No Sublimit",
				dailyCashCover:"Absent",
				ncdRenewalPremium:"Yes-2.5%/Slab Uptomax-25%",
				cbSi:"Yes - 5% /Slab Upto Max-50% Of Si"
			}
		},

		SuperTopUp:{
			id:'SuperTopUp',
			name:'Super Top-Up',
			category:'Top-Up',
			planTypes:['individual','floater_2_persons','floater_more_than_2_persons'],
			eligibility:{
				adult:{
					minAge:0,
					maxAge:null
				},
				child:{
					minAge:0,
					maxAge:null
				}
			},
			hasZonalPricing:false,
			zones:['uniform'],
			ageBrackets:['0-35','36-45','46-60','61-65','66-70','71-75','75+'],
			thresholdOptions:[200000, 300000, 500000, 1000000, 1500000, 2000000, 2500000],
			sumInsuredOptions:[300000, 500000, 700000, 1000000, 1500000, 2000000, 2500000, 3000000, 3500000, 4000000, 4500000, 5000000, 5500000, 6000000, 6500000, 7000000, 7500000, 8000000, 8500000, 9000000, 9500000],
			premiumRates:{
				individual: {
					uniform: {
						threshold200000: {
							sumInsured: [300000, 500000],
							rates: [
								[1270, 1618, 2432, 4466, 5104, 5582, 7178],
								[1754, 2234, 3366, 6160, 7040, 7700, 9900]
							]
						},
						threshold300000: {
							sumInsured: [300000, 500000, 700000],
							rates: [
								[1028, 1310, 1964, 3416, 3922, 4428, 5692],
								[1392, 1772, 2712, 4752, 5456, 6160, 7920],
								[1754, 2234, 3366, 5940, 6820, 7700, 9900]
							]
						},
						threshold500000: {
							sumInsured: [500000, 1000000, 1500000, 2000000, 4500000, 7000000, 9500000],
							rates: [
								[1046, 1254, 2024, 3718, 4148, 5006, 6436],
								[2036, 2442, 4048, 7294, 8134, 9818, 12622],
								[2860, 3432, 5720, 10296, 11484, 13860, 17820],
								[3432, 4118, 6864, 12356, 13780, 16632, 21384],
								[4720, 5662, 9438, 16988, 18948, 22870, 29404],
								[5434, 6520, 10868, 19562, 21820, 26334, 33858],
								[6006, 7208, 12012, 21622, 24116, 29106, 37422]
							]
						},
						threshold1000000: {
							sumInsured: [1000000, 1500000, 2000000, 4000000, 6500000, 9000000],
							rates: [
								[1542, 1850, 3066, 5526, 6162, 7438, 9562],
								[1928, 2312, 3832, 6906, 7702, 9296, 11952],
								[2160, 2590, 4292, 7736, 8626, 10412, 13386],
								[2776, 3330, 5520, 9946, 11090, 13386, 17210],
								[3238, 3884, 6440, 11602, 12940, 15618, 20078],
								[3548, 4254, 7052, 12708, 14172, 17106, 21990]
							]
						},
						threshold1500000: {
							sumInsured: [1500000, 3500000, 6000000, 8500000],
							rates: [
								[1460, 1752, 2904, 5232, 5834, 7042, 9054],
								[2044, 2452, 4064, 7324, 8168, 9858, 12674],
								[2410, 2890, 4790, 8632, 9626, 11620, 14938],
								[2702, 3240, 5372, 9678, 10794, 13028, 16748]
							]
						},
						threshold2000000: {
							sumInsured: [2000000, 3000000, 5500000, 8000000],
							rates: [
								[1526, 1830, 3036, 5468, 6098, 7362, 9464],
								[1756, 2106, 3490, 6290, 7014, 8466, 10884],
								[2214, 2654, 4400, 7930, 8844, 10674, 13722],
								[2442, 2930, 4856, 8750, 9758, 11778, 15142]
							]
						},
						threshold2500000: {
							sumInsured: [2500000, 5000000, 7500000],
							rates: [
								[1188, 1424, 2360, 4254, 4742, 5724, 7360],
								[1366, 1638, 2714, 4892, 5454, 6584, 8464],
								[1544, 1852, 3068, 5530, 6166, 7442, 9568]
							]
						}
					}
				},
				floater_2_persons: {
					uniform: {
						threshold200000: {
							sumInsured: [300000, 500000],
							rates: [
								[2058, 2618, 3928, 6578, 7590, 8856, 11386],
								[2784, 3542, 5424, 9152, 10560, 12320, 15840]
							]
						},
						threshold300000: {
							sumInsured: [300000, 500000, 700000],
							rates: [
								[1634, 2080, 3180, 5088, 5902, 7122, 9158],
								[2238, 2850, 4302, 7012, 8134, 9818, 12622],
								[2784, 3542, 5424, 8800, 10208, 12320, 15840]
							]
						},
						threshold500000: {
							sumInsured: [500000, 1000000, 1500000, 2000000, 4500000, 7000000, 9500000],
							rates: [
								[1486, 1980, 3052, 5544, 6468, 8086, 10396],
								[2920, 3894, 6106, 10824, 12628, 15786, 20296],
								[4108, 5478, 8580, 15180, 17710, 22138, 28462],
								[4930, 6574, 10296, 18216, 21252, 26566, 34154],
								[6778, 9038, 14158, 25048, 29222, 36528, 46962],
								[7806, 10408, 16302, 28842, 33650, 42062, 54078],
								[8626, 11504, 18018, 31878, 37192, 46490, 59770]
							]
						},
						threshold1000000: {
							sumInsured: [1000000, 1500000, 2000000, 4000000, 6500000, 9000000],
							rates: [
								[2212, 2950, 4626, 8200, 9566, 11958, 15374],
								[2764, 3688, 5782, 10248, 11958, 14948, 19218],
								[3096, 4130, 6476, 11478, 13392, 16742, 21524],
								[3982, 5310, 8326, 14758, 17218, 21524, 27674],
								[4644, 6194, 9714, 17218, 20088, 25112, 32286],
								[5088, 6784, 10638, 18858, 22002, 27504, 35360]
							]
						},
						threshold1500000: {
							sumInsured: [1500000, 3500000, 6000000, 8500000],
							rates: [
								[2094, 2794, 4380, 7764, 9058, 11322, 14558],
								[2932, 3910, 6132, 10870, 12680, 15852, 20380],
								[3456, 4608, 7226, 12810, 14944, 18682, 24020],
								[3874, 5168, 8102, 14362, 16756, 20946, 26932]
							]
						},
						threshold2000000: {
							sumInsured: [2000000, 3000000, 5500000, 8000000],
							rates: [
								[2190, 2920, 4578, 8116, 9468, 11836, 15218],
								[2518, 3358, 5264, 9332, 10888, 13612, 17500],
								[3174, 4234, 6638, 11768, 13728, 17162, 22066],
								[3502, 4672, 7324, 12984, 15150, 18938, 24348]
							]
						},
						threshold2500000: {
							sumInsured: [2500000, 5000000, 7500000],
							rates: [
								[1702, 2270, 3560, 6312, 7364, 9204, 11834],
								[1958, 2612, 4094, 7258, 8468, 10586, 13610],
								[2214, 2952, 4628, 8204, 9572, 11966, 15384]
							]
						}
					}
				},
				floater_more_than_2_persons: {
					uniform: {
						threshold200000: {
							sumInsured: [300000, 500000],
							rates: [
								[2542, 3234, 4862, 8294, 9570, 11166, 14356],
								[3510, 4466, 6732, 11440, 13200, 15400, 19800]
							]
						},
						threshold300000: {
							sumInsured: [300000, 500000, 700000],
							rates: [
								[2058, 2618, 3928, 6326, 7338, 8856, 11386],
								[2784, 3542, 5424, 8800, 10208, 12320, 15840],
								[3510, 4466, 6732, 11000, 12760, 15400, 19800]
							]
						},
						threshold500000: {
							sumInsured: [500000, 1000000, 1500000, 2000000, 4500000, 7000000, 9500000],
							rates: [
								[1882, 2508, 3796, 6864, 8008, 10010, 12870],
								[3664, 4884, 7590, 13464, 15708, 19636, 25246],
								[5148, 6864, 10726, 19008, 22176, 27720, 35640],
								[6178, 8236, 12872, 22810, 26612, 33264, 42768],
								[8494, 11326, 17698, 31364, 36590, 45738, 58806],
								[9782, 13042, 20380, 36116, 42134, 52668, 67716],
								[10810, 14414, 22524, 39916, 46570, 58212, 74844]
							]
						},
						threshold1000000: {
							sumInsured: [1000000, 1500000, 2000000, 4000000, 6500000, 9000000],
							rates: [
								[2776, 3700, 5750, 10198, 11898, 14874, 19124],
								[3470, 4624, 7186, 12748, 14874, 18592, 23904],
								[3886, 5180, 8050, 14278, 16658, 20824, 26774],
								[4996, 6660, 10348, 18358, 21418, 26774, 34422],
								[5828, 7770, 12074, 21418, 24988, 31236, 40160],
								[6384, 8510, 13224, 23458, 27368, 34210, 43984]
							]
						},
						threshold1500000: {
							sumInsured: [1500000, 3500000, 6000000, 8500000],
							rates: [
								[2628, 3504, 5444, 9658, 11266, 14084, 18108],
								[3680, 4904, 7622, 13520, 15774, 19718, 25352],
								[4336, 5780, 8982, 15934, 18590, 23238, 29878],
								[4862, 6480, 10072, 17866, 20844, 26056, 33500]
							]
						},
						threshold2000000: {
							sumInsured: [2000000, 3000000, 5500000, 8000000],
							rates: [
								[2748, 3662, 5690, 10094, 11778, 14722, 18928],
								[3160, 4212, 6544, 11610, 13544, 16930, 21768],
								[3984, 5310, 8252, 14638, 17078, 21348, 27446],
								[4396, 5860, 9106, 16152, 18844, 23556, 30286]
							]
						},
						threshold2500000: {
							sumInsured: [2500000, 5000000, 7500000],
							rates: [
								[2136, 2848, 4426, 7850, 9160, 11450, 14720],
								[2456, 3276, 5090, 9028, 10534, 13168, 16930],
								[2778, 3702, 5754, 10206, 11908, 14884, 19138]
							]
						}
					}
				}
			},
			discounts:{
				family:{
					rate:0.05
				},
				staff: { 
					rate: 0.15 
				}
			},
			optionalCovers: {
				dailyCash: {
					available: true,
					individual: {
						thresholdGroups: ['<5L', '5L', '>5L'],
						rates: [
							[9, 36, 73, 127, 182, 255, 318],
							[18, 55, 91, 209, 309, 400, 455],
							[27, 82, 164, 327, 473, 582, 727]
						]
					},
					floater: {
						thresholdGroups: ['<5L', '5L', '>5L'],
						rates: [
							[55, 73, 127, 227, 309, 436, 545],
							[73, 100, 182, 255, 400, 491, 582],
							[91, 127, 236, 309, 545, 691, 818]
						]
					}
				}
			},
			features:{
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"Not Applicable",
				icu:"Not Applicable",
				preHospitalisation:"< 10 L-30 Days; >10 L -60 Days",
				postHospitalisation:"<10L-60 Days; > 10L-90 Days",
				mtmat:"Yes",
				copay:"No",
				restorationOfSi:"No",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"Not Mentioned",
				maternityCoverWithNewBornCover:"No",
				ped:"36 Months",
				capping:"Na",
				mentalIllnessCover:"No",
				homeCare:"Yes",
				roadAmbulance:"Na",
				proportionateClause:"Absent",
				reasonableCustomary:"Present",
				donorExpenses:"Present",
				healthCheckup:"Absent",
				ayushCover:"No Sublimit",
				dailyCashCover:"Present",
				ncdRenewalPremium:"No",
				cbSi:"No"
			}
		},

		Yuvaan: {
      		id: 'Yuvaan',
			name: 'Yuvaan Health Insurance Policy',
			category: 'youth',
			planTypes: ['individual', 'floater'],
      
			eligibility: {
				adult: { 
					minAge: 18, 
					maxAge: 45 
				},
				child: { 
					minAge: 0.25, 
					maxAge: 17 
				},
				renewalMaxAge: null
			},
			
			hasZonalPricing: true,
			zones: ['A', 'B', 'C'],
      
      		ageBrackets: ['0-17', '18-25', '26-30', '31-35', '36-40', '41-45', '46-50', '51-55', '56-60', '61-65', '66-70', '71-75', '75+'],
      
      		sumInsuredOptions: [500000, 1000000, 1500000, 2000000],
      
			premiumRates: {
				individual: {
					A: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
						[2943, 4966, 5517, 6621, 8046, 11694, 14076, 17275, 24805, 34230, 41818, 47214, 54465],
						[3511, 5924, 6583, 7899, 9600, 13953, 16796, 20499, 29435, 42887, 52395, 59155, 68240],
						[3806, 6420, 7135, 8563, 10405, 15126, 18207, 22099, 31732, 46323, 56593, 63895, 73705],
						[4018, 6780, 7533, 9040, 10987, 15972, 19224, 23334, 33506, 48959, 59814, 67532, 77902]
						]
					},
					B: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
							[2513, 4242, 4713, 5655, 6872, 9988, 12023, 14756, 21187, 29239, 35720, 40329, 46523],
							[2999, 5061, 5623, 6747, 8200, 11918, 14346, 17510, 25142, 36634, 44754, 50529, 58289],
							[3251, 5485, 6094, 7314, 8887, 12919, 15552, 18877, 27105, 39568, 48340, 54577, 62958],
							[3432, 5792, 6435, 7722, 9384, 13642, 16420, 19931, 28619, 41821, 51091, 57684, 66542]
						]
					},
					C: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
							[2330, 3931, 4368, 5241, 6369, 9258, 11144, 13677, 19637, 27099, 33106, 37378, 43118],
							[2779, 4690, 5212, 6253, 7600, 11047, 13297, 16229, 23303, 33953, 41479, 46831, 54023],
							[3013, 5083, 5648, 6779, 8237, 11976, 14414, 17496, 25121, 36672, 44802, 50583, 58350],
							[3181, 5367, 5964, 7157, 8698, 12645, 15220, 18474, 26525, 38760, 47352, 53463, 61672]
						]
					}
				},
				floater: {
					A: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
						[2943, 4966, 5517, 6621, 8046, 11694, 14076, 17275, 24805, 34230, 41818, 47214, 54465],
						[3511, 5924, 6583, 7899, 9600, 13953, 16796, 20499, 29435, 42887, 52395, 59155, 68240],
						[3806, 6420, 7135, 8563, 10405, 15126, 18207, 22099, 31732, 46323, 56593, 63895, 73705],
						[4018, 6780, 7533, 9040, 10987, 15972, 19224, 23334, 33506, 48959, 59814, 67532, 77902]
						]
					},
					B: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
							[2513, 4242, 4713, 5655, 6872, 9988, 12023, 14756, 21187, 29239, 35720, 40329, 46523],
							[2999, 5061, 5623, 6747, 8200, 11918, 14346, 17510, 25142, 36634, 44754, 50529, 58289],
							[3251, 5485, 6094, 7314, 8887, 12919, 15552, 18877, 27105, 39568, 48340, 54577, 62958],
							[3432, 5792, 6435, 7722, 9384, 13642, 16420, 19931, 28619, 41821, 51091, 57684, 66542]
						]
					},
					C: {
						sumInsured: [500000, 1000000, 1500000, 2000000],
						rates: [
							[2330, 3931, 4368, 5241, 6369, 9258, 11144, 13677, 19637, 27099, 33106, 37378, 43118],
							[2779, 4690, 5212, 6253, 7600, 11047, 13297, 16229, 23303, 33953, 41479, 46831, 54023],
							[3013, 5083, 5648, 6779, 8237, 11976, 14414, 17496, 25121, 36672, 44802, 50583, 58350],
							[3181, 5367, 5964, 7157, 8698, 12645, 15220, 18474, 26525, 38760, 47352, 53463, 61672]
						]
					}
				}
			},
      
			optionalCovers: {
				dailyCash: {
					available: true,
					allowances: [500, 1000, 2000],
					premiums: [120, 240, 480]
				}
			},
      
			discounts: {
				family: { rate: 0.05 },
				floater: {
					rates: {
						one_adult_children: 0.15,
						two_adults: 0.25,
						two_adults_children: 0.25
					}
				},
				directChannel: { 
					available: true 
				},
				noClaimRewards: { 
					maxDiscount: 0.20, 
					maxCumulativeBonus: 1.00 
				}
			},
      
			features: {
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"Upto 10 L- 3000/Day Or Shared Room; Above 10L- 5000/Day Or Sharedweishigh",
				icu:"No Limits Mentioned",
				preHospitalisation:"60 Days",
				postHospitalisation:"90 Days",
				mtmat:"Yes",
				copay:"Yes -15 % & 10% For Moving To Higher Zone-Waiver Of Copayavailable",
				restorationOfSi:"No",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"12 Months- Specified",
				maternityCoverWithNewBornCover:"No",
				ped:"12 Months",
				capping:"No Capping",
				mentalIllnessCover:"No",
				homeCare:"Max-10% Of Si Max-30Kpppp*",
				roadAmbulance:"Present",
				proportionateClause:"Present",
				reasonableCustomary:"Present",
				donorExpenses:"Present",
				healthCheckup:"Absent",
				ayushCover:"No Sublimit",
				dailyCashCover:"Present",
				ncdRenewalPremium:"10% Discountfor 1St Slabmax-20%",
				cbSi:"50% For 1St Slab Uptomax-100%"
			}
    	},

		Spectra: {
			id: 'Spectra',
			name: 'Spectra Health Insurance Policy',
			category: 'comprehensive',
			planTypes: ['individual', 'floater'],
			uin: 'UIIHLIP2604V012526',
			
			eligibility: {
				adult: { 
					minAge: 18, 
					maxAge: 100 
				},
				child: { 
					minAge: 0.25, 
					maxAge: 17 
				},
				renewalMaxAge: null
			},
			
			hasZonalPricing: true,
			zones: ['A', 'B', 'C'],
			
			ageBrackets: ['0-17', '18-25', '26-30', '31-35', '36-40', '41-45', '46-50', '51-55', '56-60', '61-65', '66-70', '71-75', '75+'],
			
			sumInsuredOptions: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
			
			premiumRates: {
				individual: {
					A: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2729, 4606, 5120, 6144, 7467, 7865, 9407, 11318, 16252, 21077, 26633, 30069, 34687],
							[3463, 5844, 6493, 7792, 9469, 11012, 13170, 15846, 22753, 29508, 37286, 42097, 48561],
							[3787, 6390, 7100, 8520, 10354, 13710, 16397, 19717, 28312, 36682, 46350, 52331, 60367],
							[4110, 6936, 7707, 9248, 11239, 16408, 19624, 23589, 33871, 43855, 55414, 62565, 72173],
							[4311, 7274, 8083, 9699, 11787, 17212, 20586, 24741, 35526, 46825, 59167, 66802, 77060],
							[4511, 7613, 8459, 10151, 12336, 18016, 21548, 25893, 37180, 49795, 62920, 71039, 81948],
							[4712, 7951, 8835, 10602, 12884, 18821, 22509, 27046, 38835, 52766, 66673, 75276, 86836],
							[4912, 8290, 9211, 11053, 13432, 19625, 23471, 28198, 40489, 55736, 70426, 79513, 91724],
							[5113, 8628, 9587, 11504, 13981, 20429, 24433, 29350, 42144, 58706, 74179, 83750, 96612],
							[5752, 9707, 10785, 12942, 15728, 22982, 27487, 33019, 47412, 66044, 83451, 94219, 108688],
							[6183, 10435, 11594, 13913, 16908, 24706, 29548, 35495, 50968, 70997, 89710, 101285, 116840],
							[6493, 10956, 12174, 14608, 17753, 25941, 31026, 37270, 53516, 74547, 94195, 106350, 122682]
						]
					},
					B: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2331, 3934, 4373, 5248, 6378, 6718, 8035, 9668, 13882, 18003, 22749, 25684, 29628],
							[2958, 4991, 5546, 6655, 8088, 9406, 11249, 13535, 19435, 25205, 31848, 35958, 41480],
							[3234, 5458, 6064, 7277, 8844, 11711, 14006, 16842, 24183, 31332, 39591, 44699, 51564],
							[3511, 5925, 6583, 7899, 9600, 14015, 16762, 20149, 28932, 37460, 47333, 53441, 61647],
							[3682, 6214, 6904, 8285, 10068, 14702, 17584, 21133, 30345, 39997, 50539, 57060, 65822],
							[3853, 6503, 7225, 8670, 10537, 15389, 18405, 22117, 31758, 42534, 53744, 60679, 69998],
							[4025, 6792, 7546, 9056, 11005, 16076, 19227, 23102, 33171, 45071, 56950, 64298, 74173],
							[4196, 7081, 7868, 9441, 11473, 16763, 20048, 24086, 34585, 47607, 60155, 67917, 78348],
							[4367, 7370, 8189, 9826, 11942, 17450, 20870, 25070, 35998, 50144, 63361, 71537, 82523],
							[4913, 8291, 9212, 11055, 13435, 19631, 23478, 28204, 40498, 56412, 71281, 80479, 92838],
							[5282, 8913, 9903, 11884, 14442, 21103, 25239, 30319, 43535, 60643, 76627, 86515, 99801],
							[5546, 9358, 10398, 12478, 15164, 22158, 26501, 31835, 45712, 63676, 80459, 90840, 104791]
						]
					},
					C: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2161, 3646, 4053, 4864, 5911, 6227, 7447, 8960, 12866, 16686, 21084, 23805, 27460],
							[2741, 4626, 5140, 6168, 7496, 8718, 10426, 12544, 18013, 23361, 29518, 33327, 38445],
							[2998, 5059, 5621, 6745, 8197, 10854, 12981, 15609, 22414, 29040, 36694, 41428, 47791],
							[3254, 5491, 6101, 7321, 8898, 12990, 15536, 18674, 26815, 34719, 43870, 49530, 57137],
							[3413, 5759, 6399, 7679, 9332, 13626, 16297, 19587, 28125, 37070, 46841, 52885, 61006],
							[3571, 6027, 6697, 8036, 9766, 14263, 17059, 20499, 29434, 39421, 49812, 56239, 64876],
							[3730, 6295, 6994, 8393, 10200, 14900, 17820, 21411, 30744, 41773, 52783, 59593, 68745],
							[3889, 6563, 7292, 8750, 10634, 15536, 18581, 22323, 32054, 44124, 55754, 62948, 72615],
							[4048, 6831, 7589, 9107, 11068, 16173, 19343, 23236, 33364, 46475, 58725, 66302, 76484],
							[4554, 7684, 8538, 10246, 12452, 18194, 21760, 26140, 37534, 52285, 66065, 74590, 86045],
							[4895, 8261, 9179, 11014, 13385, 19559, 23392, 28101, 40350, 56206, 71020, 80184, 92498],
							[5140, 8674, 9637, 11565, 14055, 20537, 24562, 29506, 42367, 59016, 74571, 84193, 97123]
						]
					}
				},
				floater: {
					A: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2729, 4606, 5120, 6144, 7467, 7865, 9407, 11318, 16252, 21077, 26633, 30069, 34687],
							[3463, 5844, 6493, 7792, 9469, 11012, 13170, 15846, 22753, 29508, 37286, 42097, 48561],
							[3787, 6390, 7100, 8520, 10354, 13710, 16397, 19717, 28312, 36682, 46350, 52331, 60367],
							[4110, 6936, 7707, 9248, 11239, 16408, 19624, 23589, 33871, 43855, 55414, 62565, 72173],
							[4311, 7274, 8083, 9699, 11787, 17212, 20586, 24741, 35526, 46825, 59167, 66802, 77060],
							[4511, 7613, 8459, 10151, 12336, 18016, 21548, 25893, 37180, 49795, 62920, 71039, 81948],
							[4712, 7951, 8835, 10602, 12884, 18821, 22509, 27046, 38835, 52766, 66673, 75276, 86836],
							[4912, 8290, 9211, 11053, 13432, 19625, 23471, 28198, 40489, 55736, 70426, 79513, 91724],
							[5113, 8628, 9587, 11504, 13981, 20429, 24433, 29350, 42144, 58706, 74179, 83750, 96612],
							[5752, 9707, 10785, 12942, 15728, 22982, 27487, 33019, 47412, 66044, 83451, 94219, 108688],
							[6183, 10435, 11594, 13913, 16908, 24706, 29548, 35495, 50968, 70997, 89710, 101285, 116840],
							[6493, 10956, 12174, 14608, 17753, 25941, 31026, 37270, 53516, 74547, 94195, 106350, 122682]
						]
					},
					B: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2331, 3934, 4373, 5248, 6378, 6718, 8035, 9668, 13882, 18003, 22749, 25684, 29628],
							[2958, 4991, 5546, 6655, 8088, 9406, 11249, 13535, 19435, 25205, 31848, 35958, 41480],
							[3234, 5458, 6064, 7277, 8844, 11711, 14006, 16842, 24183, 31332, 39591, 44699, 51564],
							[3511, 5925, 6583, 7899, 9600, 14015, 16762, 20149, 28932, 37460, 47333, 53441, 61647],
							[3682, 6214, 6904, 8285, 10068, 14702, 17584, 21133, 30345, 39997, 50539, 57060, 65822],
							[3853, 6503, 7225, 8670, 10537, 15389, 18405, 22117, 31758, 42534, 53744, 60679, 69998],
							[4025, 6792, 7546, 9056, 11005, 16076, 19227, 23102, 33171, 45071, 56950, 64298, 74173],
							[4196, 7081, 7868, 9441, 11473, 16763, 20048, 24086, 34585, 47607, 60155, 67917, 78348],
							[4367, 7370, 8189, 9826, 11942, 17450, 20870, 25070, 35998, 50144, 63361, 71537, 82523],
							[4913, 8291, 9212, 11055, 13435, 19631, 23478, 28204, 40498, 56412, 71281, 80479, 92838],
							[5282, 8913, 9903, 11884, 14442, 21103, 25239, 30319, 43535, 60643, 76627, 86515, 99801],
							[5546, 9358, 10398, 12478, 15164, 22158, 26501, 31835, 45712, 63676, 80459, 90840, 104791]
						]
					},
					C: {
						sumInsured: [200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000, 1500000, 2000000, 2500000],
						rates: [
							[2161, 3646, 4053, 4864, 5911, 6227, 7447, 8960, 12866, 16686, 21084, 23805, 27460],
							[2741, 4626, 5140, 6168, 7496, 8718, 10426, 12544, 18013, 23361, 29518, 33327, 38445],
							[2998, 5059, 5621, 6745, 8197, 10854, 12981, 15609, 22414, 29040, 36694, 41428, 47791],
							[3254, 5491, 6101, 7321, 8898, 12990, 15536, 18674, 26815, 34719, 43870, 49530, 57137],
							[3413, 5759, 6399, 7679, 9332, 13626, 16297, 19587, 28125, 37070, 46841, 52885, 61006],
							[3571, 6027, 6697, 8036, 9766, 14263, 17059, 20499, 29434, 39421, 49812, 56239, 64876],
							[3730, 6295, 6994, 8393, 10200, 14900, 17820, 21411, 30744, 41773, 52783, 59593, 68745],
							[3889, 6563, 7292, 8750, 10634, 15536, 18581, 22323, 32054, 44124, 55754, 62948, 72615],
							[4048, 6831, 7589, 9107, 11068, 16173, 19343, 23236, 33364, 46475, 58725, 66302, 76484],
							[4554, 7684, 8538, 10246, 12452, 18194, 21760, 26140, 37534, 52285, 66065, 74590, 86045],
							[4895, 8261, 9179, 11014, 13385, 19559, 23392, 28101, 40350, 56206, 71020, 80184, 92498],
							[5140, 8674, 9637, 11565, 14055, 20537, 24562, 29506, 42367, 59016, 74571, 84193, 97123]
						]
					}
				}
			},
			
			optionalCovers: {
				dailyCash: {
					available: true,
					baseSIBrackets: ['≤5L', '5-15L', '>15L'],
					premiums: [120, 240, 480]
				}
			},
			
			discounts: {
				family: { 
					rate: 0.05, 
					applicableTo: 'individual_policies_only' 
				},
				directChannel: { 
					available: true 
				},
				noClaimRewards: { 
					maxDiscount: 0.05, 
					maxCumulativeBonus: 0.20 
				},
				floater: {
					'2_members': 0.15,
					'3_members': 0.20,
					'more_than_3': 0.25
				}
			},
			
			features: {
				freeLookPeriod:"Yes-30 Days",
				migration:"Yes",
				portability:"Yes",
				moratoriumPeriod:"Continuous 60 Months",
				roomRent:"Upto 10 L- 3000/Day Or Shared Room; Above 10L- 5000/Day Or Sharedweishigh",
				icu:"No Limits Mentioned",
				preHospitalisation:"60 Days",
				postHospitalisation:"90 Days",
				mtmat:"Yes",
				copay:"Yes -15 % & 10% For Moving To Higher Zone-Waiver Of Copayavailable",
				restorationOfSi:"No",
				intialWaitingPeriod:"30 Days",
				specificWaitingPeriods:"12 Months- Specified",
				maternityCoverWithNewBornCover:"No",
				ped:"12 Months",
				capping:"No Capping",
				mentalIllnessCover:"No",
				homeCare:"Max-10% Of Si Max-30Kpppp*",
				roadAmbulance:"Present",
				proportionateClause:"Present",
				reasonableCustomary:"Present",
				donorExpenses:"Present",
				healthCheckup:"Absent",
				ayushCover:"No Sublimit",
				dailyCashCover:"Present",
				ncdRenewalPremium:"10% Discountfor 1St Slabmax-20%",
				cbSi:"50% For 1St Slab Uptomax-100%"
			}
		}
	}
};

let count=0,
results=null,
userData=null;

document.addEventListener('DOMContentLoaded',()=>{
	populateZoneDropdown();
	addFamilyMember();
	//enableDesiredSi();
});

document.getElementById('budget').addEventListener('input',()=>{
	if(results)	
		calculateRecommendations();
});

document.getElementById('zone').addEventListener('change',()=>{
	if(results)	
		calculateRecommendations();
});

document.getElementById('desiredSI').addEventListener('change',()=>{
	if(results)	
		calculateRecommendations();
});

function populateZoneDropdown(){
	const s=document.getElementById('zone'),
	
	z={
		'A':["All Districts in NCT of Delhi (incl. Shahdara)", "Faridabad", "Palwal", "Gurugram", "Rohtak", "Jhajjar", "Ghaziabad", "Gautam Buddh Nagar", "Bulandshahr", "Ahmedabad", "Ahmedabad City", "Gandhi Nagar", "Vadodara", "Surat", "Mumbai", "Mumbai Suburban", "Thane", "Raigad (MH)", "Palghar"],
		'B':["Ahmed Nagar", "Amritsar", "Anand", "Bengaluru", "Bhopal", "Chennai", "Coimbatore", "Dakshina Kannada", "Ernakulam", "Howrah", "Hyderabad", "Indore", "Jaipur", "Jalgaon", "Jodhpur", "Kanpur Nagar", "Kheda", "Kolhapur", "Kolkata", "Kottayam", "Krishna", "Lucknow", "Ludhiana", "Nagpur", "Nashik", "North 24 Parganas", "Pune", "Rajkot", "Ranga Reddy", "Solapur", "Thiruvananthapuram", "Tiruvallur", "Valsad", "Visakhapatnam"],
		'C':['Other Cities']
	};
	
	Object.entries(z).forEach(([zone,cities])=>cities.forEach(city=>{
		const o=document.createElement('option');
		o.value=`${city}|${zone}`;
		o.textContent=`${city} (Zone ${zone})`;
		s.appendChild(o);
	}));
}

function addFamilyMember(){
	count++;
	const c=document.getElementById('familyMembers'),
	d=document.createElement('div');
	d.className='family-member';
	d.id=`member-${count}`;
	d.innerHTML=`
		<div class="form-group">
			<label>Relationship</label>
				<select id="member-rel-${count}" class="member-relationship">
					<option value="self">Self</option>
					<option value="spouse">Spouse</option>
					<option value="son">Son</option>
					<option value="daughter">Daughter</option>
					<option value="father">Father</option>
					<option value="mother">Mother</option>
				</select>
		</div>
		<div class="form-group">
			<label>Age</label>
			<input id="member-age-${count}" type="number" class="member-age" min="0" max="100">
		</div>
		<button class="btn btn-danger" onclick="removeMember(${count})">X</button>
	`;
	
	c.appendChild(d);
	document.querySelectorAll('.family-member').forEach(d=>{
		d.querySelector('.member-age').addEventListener('input',()=>{
		if(results)	
			calculateRecommendations();
		});
		d.querySelector('.member-relationship').addEventListener('change',()=>{
		if(results)	
			calculateRecommendations();
		});
		
	});
}

function removeMember(id) {
	document.getElementById(`member-${id}`)?.remove();
	if(results)	
		calculateRecommendations();
}

function getMembers(){
	const m=[];
	document.querySelectorAll('.family-member').forEach(d=>{
		const r=d.querySelector('.member-relationship').value,
		a=parseInt(d.querySelector('.member-age').value);
		
		if(a>=0)
			m.push({
				relationship:r,
				age:a
			});
	});
	return m;
}

function switchTab(e,n){
	document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
	document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
	e.target.classList.add('active');
	document.getElementById(`${n}Tab`).classList.add('active');
}

function getAgeBracket(age,planId){
	const p=DATA.plans[planId];
	if(!p)
		return null;
	if(planId==='FMP' || planId==='IHP' || planId==='Spectra' || planId==='Yuvaan' || planId==='SSHIP'){
		if(age<=17)
			return'0-17';
		if(age<=25)
			return'18-25';
		if(age<=30)
			return'26-30';
		if(age<=35)
			return'31-35';
		if(age<=40)
			return'36-40';
		if(age<=45)
			return'41-45';
		if(age<=50)
			return'46-50';
		if(age<=55)
			return'51-55';
		if(age<=60)
			return'56-60';
		if(age<=65)
			return'61-65';
		if(age<=70)
			return'66-70';
		if(age<=75)
			return'71-75';
		return'75+';
	}
	if(planId==='ArogyaSanjeevani'){
		if(age<=25)
			return'91d-25';
		if(age<=30)
			return'26-30';
		if(age<=35)
			return'31-35';
		if(age<=40)
			return'36-40';
		if(age<=45)
			return'41-45';
		if(age<=50)
			return'46-50';
		if(age<=55)
			return'51-55';
		if(age<=60)
			return'56-60';
		if(age<=65)
			return'61-65';
		if(age<=70)
			return'66-70';
		if(age<=75)
			return'71-75';
		return'>75';
	}
	if(planId==='SuperTopUp'){
		if(age<=35)
			return'0-35';
		if(age<=45)
			return'36-45';
		if(age<=60)
			return'46-60';
		if(age<=65)
			return'61-65';
		if(age<=70)
			return'66-70';
		if(age<=75)
			return'71-75';
		return'75+';
	}
	for(const b of p.ageBrackets){
		if(b.includes('-')){
			const[min,max]=b.split('-').map(Number);
				if(age>=min&&age<=max)
					return b;
		}
	}
	return null;
}

/*function getPremium(planId,planType,zone,ageBracket,sumInsured){
	const p=DATA.plans[planId];
	if(!p)
		return null;
	const rates=p.premiumRates[planType]?.[zone];
	if(!rates)
		return null;
	const siIndex=rates.sumInsured?.indexOf(sumInsured);
	const ageIndex=p.ageBrackets.indexOf(ageBracket);
	if(siIndex===-1||ageIndex===-1)
		return null;
	return rates.rates?.[siIndex]?.[ageIndex]||null;
}*/

function getPremium(planId, planType, zone, ageBracket, sumInsured, subType = null) {
    const p = DATA.plans[planId];
    if (!p) return null;

    let ratesData = p.premiumRates[planType];
    if (!ratesData) return null;

    // Handle different plan structures
    if (planId === 'SSHIP') {
        // SSHIP has copayment types under uniform zone
        if (!ratesData.uniform || !ratesData.uniform[subType]) return null;
        ratesData = ratesData.uniform[subType];
    } 
    else if (planId === 'ArogyaSanjeevani' && planType === 'family_floater') {
        // Arogya Sanjeevani family floater has family structure subtypes
        if (!ratesData.uniform || !ratesData.uniform[subType]) return null;
        ratesData = ratesData.uniform[subType];
    }
    else if (planId === 'SuperTopUp') {
        // SuperTopUp has threshold-based rates
        if (!ratesData.uniform || !ratesData.uniform[subType]) return null;
        ratesData = ratesData.uniform[subType];
    }
    else {
        // Standard structure with zones
        if (p.hasZonalPricing) {
            ratesData = ratesData[zone];
        } else {
            ratesData = ratesData.uniform;
        }
        if (!ratesData) return null;
    }

    // Find sum insured index
    const siIndex = ratesData.sumInsured?.indexOf(sumInsured);
    if (siIndex === -1) return null;

    // Find age bracket index
    const ageIndex = p.ageBrackets.indexOf(ageBracket);
    if (ageIndex === -1) return null;

    // Return the premium rate
    return ratesData.rates?.[siIndex]?.[ageIndex] || null;
}

function analyzeFamilyStructure(members){
	const counts={
		adults:0,
		children:0,
		parents:0
	};
	members.forEach(m=>{
		if(['self','spouse'].includes(m.relationship))
			counts.adults++;
		else if(['son','daughter'].includes(m.relationship))
			counts.children++;
		else if(['mother','father'].includes(m.relationship))
			counts.parents++;
	});
	let floaterType='';
	if(counts.adults===2&&counts.children===0&&counts.parents===0)
		floaterType='two_adults';
	else if(counts.adults===2&&counts.children>0&&counts.parents===0)
		floaterType='two_adults_children';
	else if(counts.adults===1&&counts.children===0&&counts.parents>0)
		floaterType='one_adult_parents';
	else if(counts.adults===1&&counts.children>0&&counts.parents===0)
		floaterType='one_adult_children';
	else if(counts.adults===1&&counts.children>0&&counts.parents>0)
		floaterType='one_adult_children_parents';
	else if(counts.adults===2&&counts.children===0&&counts.parents>0)
		floaterType='two_adults_parents';
	else if(counts.adults===2&&counts.children>0&&counts.parents>0)
		floaterType='two_adults_children_parents';
	return{
		...counts,
		floaterType,
		totalMembers:members.length
	};
}

function isInSIRange(si,rangeStr){
	if(!rangeStr)
		return true;
	const[min,max]=rangeStr.split('-').map(Number);
	return si>=min&&si<=max;
}

function calculateIndividualPlan(planId,plan,members,zone,budget,budgetTolerance,desiredSIRange){
	const zoneKey=plan.hasZonalPricing?zone:'uniform';
	const sumInsuredOptions=plan.sumInsuredOptions;
	let bestSI=null,
	bestPremium=null,
	breakdown=[];
	let discountRate = 0;
	let discountOnPremium = 0;
	let familyComposition = '';
	let DiscountBasis = '';
	let totalPremium = 0;
	const familyStructure=analyzeFamilyStructure(members);
	
	for(let si of sumInsuredOptions){
		if(desiredSIRange&&!isInSIRange(si,desiredSIRange))
			continue;
		totalPremium=0,
		memberBreakdown=[],
		canCalculate=true;
		for(const member of members){
			const ageBracket=getAgeBracket(member.age,planId);
			if(!ageBracket){
				canCalculate=false;
				break;
			}
			const premium=parseInt(getPremium(planId,'individual',zoneKey,ageBracket,si));
			if(!premium){
				canCalculate=false;
				break;
			}
			totalPremium+=premium;
			memberBreakdown.push({
				relationship:member.relationship,
				age:member.age,
				premium
			});
			
		}
		
		if(!canCalculate)
			continue;
		let discountedPremium=totalPremium;
		if(members.length>1&&plan.discounts.family){
			discountedPremium-=totalPremium*((plan.discounts.family.rate));
			discountOnPremium = parseFloat(totalPremium*((plan.discounts.family.rate)));
			familyComposition = members.length+" ["+familyStructure.adults+" adult(s), "+familyStructure.children+" child(ren), "+familyStructure.parents+" parent(s)]";
			discountRate = (plan.discounts.family.rate);
			DiscountBasis = "As per Family Length, 5% on premium of each member";

		}
		if(discountedPremium<=budgetTolerance){
			if(discountedPremium<=budget||!bestSI){
				bestSI=si;
				bestPremium=discountedPremium;
				breakdown=memberBreakdown;
			}
		}
	}
	totalPremium=0;		
	for(premium of breakdown){
		totalPremium += parseFloat(premium.premium);	
	}
	//totalPremium = totalPremium1;
	if(!bestSI)
		return null;
	return{
		planId,
		planName:plan.name,
		planType:'Individual',
		sumInsured:bestSI,
		discountOnPremium,
		familyComposition,
		discountRate,
		DiscountBasis,
		totalPremium,
		premium:Math.round(bestPremium),
		breakdown,
		overBudget:bestPremium>budget,
		category:plan.category,
		features:plan.features
	};
	//console.log(breakdown);
}
		
/*function calculateFloaterPlan(planId,plan,members,zone,budget,budgetTolerance,desiredSIRange){
	const zoneKey=plan.hasZonalPricing?zone:'uniform';
	const sumInsuredOptions=plan.sumInsuredOptions;
	const familyStructure=analyzeFamilyStructure(members);
	const oldestAge=Math.max(...members.map(m=>m.age));
	const oldestAgeBracket=getAgeBracket(oldestAge,planId);
	if(!oldestAgeBracket)
		return null;
	let bestSI=null,
	bestPremium=null;
	for(let si of sumInsuredOptions){
		if(desiredSIRange&&!isInSIRange(si,desiredSIRange))
			continue;
		let premium;
		if(planId==='ArogyaSanjeevani'){
			const familyType=familyStructure.children>0?'adults2Child1':'adults2';
			premium=getPremium(planId,'family_floater','uniform',oldestAgeBracket,si);
		} else {
			premium=getPremium(planId,'floater',zoneKey,oldestAgeBracket,si);
		}
		if(!premium)
			continue;
		let discountedPremium=premium;
		if(plan.discounts.floater&&planId==='FMP'){
			let discountRate=0;
			const floaterRates=plan.discounts.floater.rates[familyStructure.floaterType];
			if(floaterRates){
				const hasAge40to50=members.some(m=>m.age>=40&&m.age<=50);
				discountRate=hasAge40to50?floaterRates.age40to50:floaterRates.other;
			}
			if(discountRate>0){
				discountedPremium-=premium*discountRate;
			}
		}
		if(discountedPremium<=budgetTolerance){
			if(discountedPremium<=budget||!bestSI){
				bestSI=si;
				bestPremium=discountedPremium;
			}
		}
	}
	if(!bestSI)
		return null;
	return{
		planId,
		planName:plan.name,
		planType:'Floater',
		sumInsured:bestSI,
		premium:Math.round(bestPremium),
		breakdown:[
			{
				type:'Family Floater',
				oldestAge,
				members:members.length
			}
		],
		overBudget:bestPremium>budget,
		category:plan.category,
		features:plan.features
	};
}*/

function calculateFloaterPlan(planId,plan,members,zone,budget,budgetTolerance,desiredSIRange){
	if(members.length === 1)
		return null;
	const zoneKey=plan.hasZonalPricing?zone:'uniform';
	const sumInsuredOptions=plan.sumInsuredOptions;
	const familyStructure=analyzeFamilyStructure(members);
	const oldestAge=Math.max(...members.map(m=>m.age));
	const oldestAgeBracket=getAgeBracket(oldestAge,planId);
	if(!oldestAgeBracket)
		return null;
	let bestSI=null,
	bestPremium=null;
	let subType = null;
	let breakdown=[];
	let discountOnPremium = 0;
	let familyComposition = '';
	let DiscountBasis = '';
	let discountRate = 0;
	let totalPremium = 0;
	let planType = plan.planTypes.includes('floater') ? 'floater' : 'family_floater';
	for(let si of sumInsuredOptions){
		if(desiredSIRange&&!isInSIRange(si,desiredSIRange))
			continue;
		let premium=0;
		let memberBreakdown=[];
		if (planId === 'ArogyaSanjeevani' && planType === 'family_floater') {
            // Map family structure to Arogya Sanjeevani subTypes
            if (familyStructure.adults === 1 && familyStructure.children === 1) {
                subType = 'adult1Child1';
            } else if (familyStructure.adults === 1 && familyStructure.children === 2) {
                subType = 'adult1Child2';
            } else if (familyStructure.adults === 2 && familyStructure.children === 0) {
                subType = 'adults2';
            } else if (familyStructure.adults === 2 && familyStructure.children === 1) {
                subType = 'adults2Child1';
            } else if (familyStructure.adults === 2 && familyStructure.children === 2) {
                subType = 'adults2Child2';
            }
            
            if (subType) {
                const premiumMember = parseInt(getPremium(planId, planType, zoneKey, oldestAgeBracket, si, subType));
				memberBreakdown.push({
					relationship:familyStructure.totalMembers+' ['+familyStructure.adults+' adult(s), '+familyStructure.children+' child(ren), '+familyStructure.parents+' parent(s)]',
					age:oldestAge,
					premiumMember
				});
				premium = premiumMember;
				totalPremium = premium;
            }
		} else {
			//Main Original Logic of Floater, calculating highest member's premium only.
			//premium=getPremium(planId,'floater',zoneKey,oldestAgeBracket,si);
			
			//calculating floater premium for all member's rate
			for(const member of members){
				const ageBracket=getAgeBracket(member.age,planId);
				
				const premiumMember =parseInt(getPremium(planId,'floater',zoneKey,ageBracket,si));
				//console.log(premium);
				//premium+=premium;
				memberBreakdown.push({
					relationship:member.relationship,
					age:member.age,
					premiumMember
				});
				premium +=premiumMember;
				totalPremium = premium;
			}
		}
		
		if(!premium)
			continue;
		let discountedPremium=premium;
		
		if(plan.discounts.floater&&planId==='FMP'){
			discountRate=0;
			const floaterRates=plan.discounts.floater.rates[familyStructure.floaterType];
			if(floaterRates){
				const hasAge40to50=members.some(m=>m.age>=40&&m.age<=50);
				discountRate=hasAge40to50?floaterRates.age40to50:floaterRates.other;
			}
			if(discountRate>0){
				discountedPremium-=premium*discountRate;
			}
			discountOnPremium = parseFloat(premium*discountRate);
			familyComposition = members.length+" ["+familyStructure.adults+" adult(s), "+familyStructure.children+" child(ren), "+familyStructure.parents+" parent(s)]";
			DiscountBasis = "As per Family Structure and Members' Age";
		}
		if(plan.discounts.floater&&planId==='Yuvaan'){
			discountRate=0;
			const floaterRates=plan.discounts.floater.rates[familyStructure.floaterType];
			//console.log(floaterRates);
			if(floaterRates){
				discountRate=floaterRates;
			}
			if(discountRate>0){
				discountedPremium-=premium*discountRate;
			}
			discountOnPremium = parseFloat(premium*discountRate);
			familyComposition = members.length+" ["+familyStructure.adults+" adult(s), "+familyStructure.children+" child(ren), "+familyStructure.parents+" parent(s)]";
			DiscountBasis = "As per Family Structure";
		}
		if(plan.discounts.floater&&planId==='Spectra'){
			discountRate=0;
			if(members.length===2){
				discountRate=0.15;
			} else if (members.length===3){
				discountRate=0.20;
			}else if (members.length>3){
				discountRate=0.25;
			}
			if(discountRate>0){
				discountedPremium-=premium*discountRate;
			}
			discountOnPremium = parseFloat(premium*discountRate);
			familyComposition = members.length+" ["+familyStructure.adults+" adult(s), "+familyStructure.children+" child(ren), "+familyStructure.parents+" parent(s)]";
			DiscountBasis = "As per no of Family Members";
		}
		
		if(discountedPremium<=budgetTolerance){
			if(discountedPremium<=budget||!bestSI){
				bestSI=si;
				bestPremium=discountedPremium;
				breakdown=memberBreakdown;
			}
		}
	}
	if(!bestSI)
		return null;
	/*return{
		planId,
		planName:plan.name,
		planType:'Floater',
		sumInsured:bestSI,
		premium:Math.round(bestPremium),
		breakdown:[
			{
				type:'Family Floater',
				oldestAge,
				members:members.length,
				discountOnPremium,
				familyComposition,
				floaterDiscountBasis
			}
		],
		overBudget:bestPremium>budget,
		category:plan.category,
		features:plan.features
	};*/
	totalPremium=0;		
	for(premium of breakdown){
		totalPremium += parseFloat(premium.premiumMember);	
	}
	return{
		planId,
		planName:plan.name,
		planType:'Floater',
		sumInsured:bestSI,
		premium:Math.round(bestPremium),
		breakdown,
		discountRate,
		discountOnPremium,
		totalPremium,
		familyComposition,
		DiscountBasis,
		overBudget:bestPremium>budget,
		category:plan.category,
		features:plan.features
	};		
	//console.log(breakdown);
}

function calculateIndividualPlans(members,zone,budget,desiredSIRange){
	let allPlans=[];
	const budgetTolerance=budget*1.1;
	console.log(members);
	for(const[planId,plan]of Object.entries(DATA.plans)){
		if(planId==='SuperTopUp')
			continue;
		for(const planType of plan.planTypes){
			if(planType==='individual'){
				const result=calculateIndividualPlan(planId,plan,members,zone,budget,budgetTolerance,desiredSIRange);
				if(result)
					allPlans.push(result);
			} else if (planType==='floater'||planType==='family_floater'){
				const result=calculateFloaterPlan(planId,plan,members,zone,budget,budgetTolerance,desiredSIRange);
				if(result)
					allPlans.push(result);
			}
		}
	}
	console.log(allPlans);

	// Check if there are father/mother relationships AND any member age > 45
    const hasParents = members.some(member => 
        member.relationship === 'father' || member.relationship === 'mother'
    );
    
    const hasAgeOver45 = members.some(member => member.age > 45);
    
    // If both conditions are met, remove Yuvaan plans
    if (hasParents || hasAgeOver45) {
        allPlans = allPlans.filter(plan => plan.planId !== 'Yuvaan');
    }
	console.log(allPlans);
	allPlans.sort((a,b)=>b.sumInsured-a.sumInsured);
	return allPlans.slice(0,10);
	
}

function calculateCombinationPlans(basePlans,members,zone,budget,desiredSIRange){
	const combinations=[];
	const budgetTolerance=budget*1.1;
	const superTopUp=DATA.plans.SuperTopUp;
	if(!superTopUp)
		return combinations;
	const familySize=members.length;
	const familyStructure = analyzeFamilyStructure(members);
	for(const basePlan of basePlans){
		const baseSI=basePlan.sumInsured;
		const basePremium=basePlan.premium;
		if(!superTopUp.thresholdOptions.includes(baseSI))
			continue;
		let topUpPlanType='individual';
		if(basePlan.planType==='Floater'&&familySize>1){
			topUpPlanType=familySize===2?'floater_2_persons':'floater_more_than_2_persons';
		} else {
			topUpPlanType='individual';
		}
		const oldestAge=Math.max(...members.map(m=>m.age));
		let topUpAgeBracket=getAgeBracket(oldestAge,'SuperTopUp');
		if(!topUpAgeBracket)
			continue;
		const thresholdKey=`threshold${baseSI}`;
		//const topUpRates=superTopUp.premiumRates[topUpPlanType]['uniform'][thresholdKey];
		const topUpRatesIndividual=superTopUp.premiumRates['individual']['uniform'][thresholdKey];
		const topUpRatesFloater=familySize<2?null:(familySize===2?superTopUp.premiumRates['floater_2_persons']['uniform'][thresholdKey]:superTopUp.premiumRates['floater_more_than_2_persons']['uniform'][thresholdKey]);
		//if(!topUpRatesIndividual || !topUpRatesFloater)
			//continue;

		let bestTopUpSIIndividual=0,
		bestTopUpPremiumIndividual=0;
		let premiumIndividual=0;
		let totalPremiumIndividual=0,
		memberBreakdownIndividual=[];
		let discountOnPremium = 0;
		for(let si of topUpRatesIndividual.sumInsured){
			if(si<=baseSI)
				continue;
			//const totalCoverIndividual=baseSI+si;
			//if(desiredSIRange&&!isInSIRange(totalCoverIndividual,desiredSIRange))
			//const totalCover=baseSI+si;
			//if(desiredSIRange&&!isInSIRange(totalCover,desiredSIRange))
				//continue;
			totalPremiumIndividual=0;
			memberBreakdownIndividual=[];
			for(const member of members){
				topUpAgeBracket=getAgeBracket(member.age,'SuperTopUp');
				const siIndexIndividual=topUpRatesIndividual.sumInsured.indexOf(si);
				const ageIndexIndividual=superTopUp.ageBrackets.indexOf(topUpAgeBracket);
				if(siIndexIndividual===-1||ageIndexIndividual===-1)
					continue;
				premiumIndividual=topUpRatesIndividual.rates[siIndexIndividual][ageIndexIndividual];
				totalPremiumIndividual+=premiumIndividual;
				
				memberBreakdownIndividual.push({
					relationship:member.relationship,
					age:member.age,
					premiumIndividual
				});
			}
			if(familySize>1) {
				discountOnPremium = parseInt(totalPremiumIndividual*0.05);
			}
			let totalCombinationPremiumIndividual=basePremium+totalPremiumIndividual-discountOnPremium;
			
			if(totalCombinationPremiumIndividual<=budgetTolerance){
				if(totalPremiumIndividual-discountOnPremium<=budget||!bestTopUpSIIndividual){
					bestTopUpSIIndividual=si;
					bestTopUpPremiumIndividual=totalPremiumIndividual-discountOnPremium;
				}
			}
		}

		let bestTopUpSIFloater=0,
		bestTopUpPremiumFloater=0;
		let premiumFloater=0;
		let totalPremiumFloater=0,
		memberBreakdownFloater=[];
		if(familySize>1){
			for(let si of topUpRatesFloater.sumInsured){
				if(si<=baseSI)
					continue;
				//const totalCoverFloater=baseSI+si;
				//if(desiredSIRange&&!isInSIRange(totalCoverFloater,desiredSIRange))
				//const totalCover=baseSI+si;
				//if(desiredSIRange&&!isInSIRange(totalCover,desiredSIRange))
					//continue;
				totalPremiumFloater=0;
				memberBreakdownFloater=[];
				//for(const member of members){
					topUpAgeBracket = getAgeBracket(oldestAge,'SuperTopUp');
					const siIndexFloater=topUpRatesFloater.sumInsured.indexOf(si);
					const ageIndexFloater=superTopUp.ageBrackets.indexOf(topUpAgeBracket);
					if(siIndexFloater===-1||ageIndexFloater===-1)
						continue;
					premiumFloater=topUpRatesFloater.rates[siIndexFloater][ageIndexFloater];
					totalPremiumFloater=premiumFloater;
					memberBreakdownFloater.push({
						//relationship:familySize<2?'': (familySize===2?'floater_2_persons':'floater_more_than_2_persons'),
						relationship:familyStructure.totalMembers+' ['+familyStructure.adults+' adult(s), '+familyStructure.children+' child(ren), '+familyStructure.parents+' parent(s)]',
						age:oldestAge,
						premiumFloater
					});
				//}
				const totalCombinationPremiumFloater=basePremium+premiumFloater;
				if(totalCombinationPremiumFloater<=budgetTolerance){
					if(totalPremiumFloater<=budget||!bestTopUpSIFloater){
						bestTopUpSIFloater=si;
						bestTopUpPremiumFloater=totalPremiumFloater;
					}
				}
			}
		}
		let memberBreakdown = [];
		if(bestTopUpPremiumIndividual<=budget-basePremium) {
			bestTopUpSI = bestTopUpSIIndividual;
			bestTopUpPremium = bestTopUpPremiumIndividual;
			topUpPlanType = 'Individual';
			memberBreakdown = memberBreakdownIndividual;
		} else {
			if(familySize>1){
				bestTopUpSI = bestTopUpSIFloater;
				bestTopUpPremium = bestTopUpPremiumFloater;
				topUpPlanType = 'Floater';
				memberBreakdown = memberBreakdownFloater;
			}
		}

		if(bestTopUpSI){
			const totalCover=baseSI+bestTopUpSI;
			const totalPremium=basePremium+bestTopUpPremium;
			combinations.push({
				basePlan:{
					planId:basePlan.planId,
					planName:basePlan.planName,
					planType:basePlan.planType,
					sumInsured:baseSI,
					premium:basePremium
				},
				topUpPlan:{
					planId:'SuperTopUp',
					planName:'Super Top-Up',
					planType: topUpPlanType==='Individual'?'Individual':'Floater',
					sumInsured:bestTopUpSI,
					premium:bestTopUpPremium,
					discountOnPremium,
					memberBreakdown,
					threshold:baseSI
				},
				totalCover,
				totalPremium:Math.round(totalPremium),
				overBudget:totalPremium>budget,
				category:'Combination'
			});
		}
	}
	console.log(combinations);
	combinations.sort((a,b)=>b.totalCover-a.totalCover);
	return combinations.slice(0,10);
	//console.log(combinations);
}



function calculateRecommendations(){
	document.getElementById('desiredSI').disabled=false;
	
	const age=parseInt(document.getElementById('primaryAge').value),
	zoneData=document.getElementById('zone').value,
	budget=parseFloat(document.getElementById('budget').value),
	desiredSIRange=document.getElementById('desiredSI').value;
	if(!age||!zoneData||!budget){
		alert('Please fill all required fields');
		return;
	}
	const[location,zone]=zoneData.split('|'),
	members=getMembers();
	if(!members.length){
		alert('Add at least one family member');
		return;
	}
	userData={
		age,
		zone,
		location,
		budget,
		members
	};
	document.getElementById('resultsSection').style.display='block';
	const individualPlans=calculateIndividualPlans(members,zone,budget,desiredSIRange);
	displayComparison(individualPlans);
	const combinationPlans=calculateCombinationPlans(individualPlans,members,zone,budget,desiredSIRange);
	results={
		individualPlans,
		combinationPlans,
		familyStructure:analyzeFamilyStructure(members),
		userData
	};
	displayResults(results);
}

function formatNumber(n){
	return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");
}

function capitalize(s){
	return s.charAt(0).toUpperCase()+s.slice(1);
}

function displayResults(r){
	displayIndividualPlans(r.individualPlans);
	displayCombinationPlans(r.combinationPlans);
	displayDetailedView(r);
}

/*function displayIndividualPlans(plans){
	//console.log(plans);
	const c=document.getElementById('individualTab');
	if(!plans||!plans.length){
		c.innerHTML='<div class="no-results">No plans found within your budget and criteria.</div>';
		return;
	}
	let html='<div class="section-title">Top Individual/Family Plans</div>';
	plans.forEach((p,i)=>{
		html+=`
			<div class="plan-card ${p.overBudget?'over-budget':''}">
				<div class="plan-header">
					<div>
						<div class="plan-name">${i+1}. ${p.planName}</div>
						<span class="plan-category">${p.category} - ${p.planType}</span>
					</div>${p.overBudget?'<span class="budget-indicator">Over Budget</span>':''}
				</div>
				<div class="plan-details">
					<div class="detail-item">
						<div class="detail-label">Sum Insured</div>
						<div class="detail-value">Rs ${formatNumber(p.sumInsured)}</div>
					</div>
					<div class="detail-item">
						<div class="detail-label">Annual Premium</div>
						<div class="detail-value premium-highlight">Rs ${formatNumber(p.premium)}</div>
					</div>
					<div class="detail-item">
						<div class="detail-label">Zone</div>
						<div class="detail-value">${userData.zone}</div>
					</div>
					<div class="detail-item">
						<div class="detail-label">Coverage Type</div>
						<div class="detail-value">${p.planType}</div>
					</div>
				</div>
			`;
			if((p.breakdown&&p.breakdown.length>1)){
				//console.log(p.breakdown.length);
				html+=`
				<div class="breakdown">
					<div class="breakdown-title">Premium Breakdown</div>
				`;
				if(p.planType==='Individual'){
					p.breakdown.forEach(m=>{
						html+=`
							<div class="breakdown-item">
								<span>${capitalize(m.relationship)} (${m.age} years)</span>
								<span>Rs ${formatNumber(m.premium)}</span>
							</div>
						`;
					});
					html+=`
						<div class="breakdown-item">
								<span>Total Premium of Members</span>
								<span>Rs ${formatNumber(p.totalPremium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Total Family Discount %</span>
								<span>${((p.discountRate*100).toFixed(2))} %</span>
							</div>
							<div class="breakdown-item">
								<span>Total Family Discount</span>
								<span>Rs ${formatNumber(p.totalPremium - p.premium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Final Premium for this plan</span>
								<span>Rs ${formatNumber(p.premium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Basis of Discount</span>
								<span>${(p.DiscountBasis)}</span>
							</div>
							<div class="breakdown-item">
								<span>Total Members</span>
								<span>${(p.familyComposition)}</span>
							</div>
					`;
				} else if (p.planType==='Floater'&&p.planId!=='ArogyaSanjeevani'){
					p.breakdown.forEach(m=>{
						html+=`
							<div class="breakdown-item">
								<span>${capitalize(m.relationship)} (${m.age} years)</span>
								<span>Rs ${formatNumber(m.premiumMember)}</span>
							</div>
						`;
					});
					html+=`
						<div class="breakdown-item">
								<span>Total Premium of Members</span>
								<span>Rs ${formatNumber(p.totalPremium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Total Family Discount %</span>
								<span>${((p.discountRate*100).toFixed(2))} %</span>
							</div>
							<div class="breakdown-item">
								<span>Total Family Discount</span>
								<span>Rs ${formatNumber(p.totalPremium - p.premium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Final Premium for this plan</span>
								<span>Rs ${formatNumber(p.premium)}</span>
							</div>
							<div class="breakdown-item">
								<span>Basis of Discount</span>
								<span>${(p.DiscountBasis)}</span>
							</div>
							<div class="breakdown-item">
								<span>Total Members</span>
								<span>${(p.familyComposition)}</span>
							</div>
					`;
				} 

				html+=`
					</div>
				`;
			} else {
				html+=`
				<div class="breakdown">
					<div class="breakdown-title">Premium Breakdown</div>
				`;
				//console.log(p.breakdown);
					/*html+=`
						<div class="breakdown-item">
							<span>Floater Basic (${p.breakdown[0].members} members, oldest: ${p.breakdown[0].oldestAge} years)</span>
							<span>Rs ${formatNumber(p.breakdown[0].premium)}</span>
						</div>
					`;*//*
					p.breakdown.forEach(m=>{
						html+=`
							<div class="breakdown-item">
								<span>Floater Basis (${capitalize(m.relationship)}, Oldest Member's Age (${m.age} years)</span>
								<span>Rs ${formatNumber(m.premiumMember)}</span>
							</div>
						`;
					});
					html+=`
					</div>
				`;
			}
			
			html+=`
				<div class="feature-tags">${p.features.maternity?'<span class="feature-tag">Maternity</span>':''}${p.features.preExistingDiseases?'<span class="feature-tag">Pre-existing Diseases</span>':''}${p.features.dailyCash?'<span class="feature-tag">Daily Cash</span>':''}${p.features.cumulative?'<span class="feature-tag">Cumulative Bonus</span>':''}${p.features.roomRent==='no_limit'?'<span class="feature-tag">No Room Rent Limit</span>':''}</div>
				</div>
			`;
	});
	c.innerHTML=html;
}*/

function displayIndividualPlans(plans) {
  const c = document.getElementById('individualTab');
  if (!plans || !plans.length) {
    c.innerHTML =
      '<div class="no-results">No plans found within your budget and criteria.</div>';
    return;
  }
  //const familyStructure=analyzeFamilyStructure(members);
  let html = '<div class="section-title">Top Individual/Family Plans</div>';

  plans.forEach((p, i) => {
    html += `
            <div class="plan-card ${p.overBudget ? 'over-budget' : ''}">
                <div class="plan-header">
                    <div>
                        <div class="plan-name">${i + 1}. ${p.planName}</div>
                        <span class="plan-category">${p.category} - ${
      p.planType
    }</span>
                    </div>
                    ${
                      p.overBudget
                        ? '<span class="budget-indicator">Over Budget</span>'
                        : ''
                    }
                </div>
                <div class="plan-details">
                    <div class="detail-item">
                        <div class="detail-label">Sum Insured</div>
                        <div class="detail-value">Rs ${formatNumber(
                          p.sumInsured
                        )}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Annual Premium</div>
                        <div class="detail-value premium-highlight">Rs ${formatNumber(
                          p.premium
                        )}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Zone</div>
                        <div class="detail-value">${userData.zone}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Coverage Type</div>
                        <div class="detail-value">${p.planType}</div>
                    </div>
                </div>`;

    if (p.breakdown && p.breakdown.length > 1) {
      html += `
                <div class="breakdown">
                    <div class="breakdown-title">
                        Premium Breakdown
                        <span class="breakdown-toggle">+</span>
                    </div>
                    <div class="breakdown-content">`;

      if (p.planType === 'Individual') {
        p.breakdown.forEach(m => {
          html += `
                        <div class="breakdown-item">
                            <span>${capitalize(m.relationship)} (${
            m.age
          } years)</span>
                            <span>Rs ${formatNumber(m.premium)}</span>
                        </div>`;
        });
        html += `
                        <div class="breakdown-item">
                            <span>Total Premium of Members</span>
                            <span>Rs ${formatNumber(p.totalPremium)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Family Discount (%)</span>
                            <span>${(p.discountRate * 100).toFixed(2)} %</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Family Discount</span>
                            <span>Rs ${formatNumber(
                              p.totalPremium - p.premium
                            )}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Final Premium</span>
                            <span>Rs ${formatNumber(p.premium)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Basis of Discount</span>
                            <span>${p.DiscountBasis}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Total Members</span>
                            <span>${p.familyComposition}</span>
                        </div>`;
      } else if (p.planType === 'Floater' && p.planId !== 'ArogyaSanjeevani') {
        p.breakdown.forEach(m => {
          html += `
                        <div class="breakdown-item">
                            <span>${capitalize(m.relationship)} (${
            m.age
          } years)</span>
                            <span>Rs ${formatNumber(m.premiumMember)}</span>
                        </div>`;
        });
        html += `
                        <div class="breakdown-item">
                            <span>Total Premium of Members</span>
                            <span>Rs ${formatNumber(p.totalPremium)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Floater Discount (%)</span>
                            <span>${(p.discountRate * 100).toFixed(2)} %</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Floater Discount</span>
                            <span>Rs ${formatNumber(
                              p.totalPremium - p.premium
                            )}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Final Premium</span>
                            <span>Rs ${formatNumber(p.premium)}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Basis of Discount</span>
                            <span>${p.DiscountBasis}</span>
                        </div>
                        <div class="breakdown-item">
                            <span>Total Members</span>
                            <span>${p.familyComposition}</span>
                        </div>`;
      }

      html += `
                    </div>
                </div>`;
    } else if (p.breakdown && p.breakdown.length === 1) {
      if (p.planType === 'Individual') {
        html += `
					<div class="breakdown">
						<div class="breakdown-title">
							Premium Breakdown
							<span class="breakdown-toggle">+</span>
						</div>
						<div class="breakdown-content">`;

        p.breakdown.forEach(m => {
          html += `
						<div class="breakdown-item">
                            <span>${capitalize(m.relationship)} (${
            m.age
          } years)</span>
                            <span>Rs ${formatNumber(m.premium)}</span>
                        </div>`;
        });
        html += `
						</div>
					</div>
				`;
      } else if (p.planType === 'Floater' && p.planId === 'ArogyaSanjeevani') {
        html += `
					<div class="breakdown">
						<div class="breakdown-title">
							Premium Breakdown
							<span class="breakdown-toggle">+</span>
						</div>
						<div class="breakdown-content">`;

        p.breakdown.forEach(m => {
          html += `
						<div class="breakdown-item">
							<span>Floater Basis : ${m.relationship}, <br>Oldest Member Age : ${
            m.age
          } years</span>
							<span>Rs ${formatNumber(m.premiumMember)}</span>
						</div>`;
        });
        html += `
						</div>
					</div>
				`;
      }
    }

   /*html += `
                <div class="feature-tags">
                    ${
                      p.features.maternity
                        ? '<span class="feature-tag">Maternity</span>'
                        : ''
                    }
                    ${
                      p.features.preExistingDiseases
                        ? '<span class="feature-tag">Pre-existing Diseases</span>'
                        : ''
                    }
                    ${
                      p.features.dailyCash
                        ? '<span class="feature-tag">Daily Cash</span>'
                        : ''
                    }
                    ${
                      p.features.cumulative
                        ? '<span class="feature-tag">Cumulative Bonus</span>'
                        : ''
                    }
                    ${
                      p.features.roomRent === 'no_limit'
                        ? '<span class="feature-tag">No Room Rent Limit</span>'
                        : ''
                    }
                </div>
            </div>`;*/
			html += `
                
            </div>`;
  });

  c.innerHTML = html;

  // Add click event listeners to all breakdown titles
  setTimeout(() => {
    const breakdownTitles = c.querySelectorAll('.breakdown-title');
    breakdownTitles.forEach(title => {
      title.addEventListener('click', function () {
        const breakdown = this.parentElement;
        const breakdownContent = this.nextElementSibling;
        const toggle = this.querySelector('.breakdown-toggle');

        breakdown.classList.toggle('active');

        if (breakdown.classList.contains('active')) {
          breakdownContent.style.maxHeight =
            breakdownContent.scrollHeight + 'px';
          toggle.textContent = '−';
        } else {
          breakdownContent.style.maxHeight = '0';
          toggle.textContent = '+';
        }
      });
    });
  }, 0);
}


function displayCombinationPlans(plans){
	const c=document.getElementById('combinationTab');
	if(!plans||!plans.length){
		c.innerHTML='<div class="no-results">No combination plans found. Base plan sum insured may not match available top-up thresholds.</div>';
		return;
	}
	//familyStructure=analyzeFamilyStructure(members);
	let html='<div class="section-title">Top Combination Plans (Base + Super Top-Up)</div>';
	plans.forEach((combo,i)=>{
		html+=`
			<div class="plan-card ${combo.overBudget?'over-budget':''}">
				<div class="plan-header">
					<div>
						<div class="plan-name">${i+1}. ${combo.basePlan.planName} (${combo.basePlan.planType})+ Super Top-Up (${combo.topUpPlan.planType})</div>
						<span class="plan-category">${combo.category} (${combo.basePlan.planType} + ${combo.topUpPlan.planType})</span>
					</div>${combo.overBudget?'<span class="budget-indicator">Over Budget</span>':''}</div>
					<div class="plan-details">
						<div class="detail-item">
							<div class="detail-label">Total Coverage</div>
							<div class="detail-value">Rs ${formatNumber(combo.totalCover)}</div>
						</div>
						<div class="detail-item">
							<div class="detail-label">Total Premium</div>
							<div class="detail-value premium-highlight">Rs ${formatNumber(combo.totalPremium)}</div>
						</div>
						<div class="detail-item">
							<div class="detail-label">Base Plan SI (${combo.basePlan.planType} Basis)</div>
							<div class="detail-value">Rs ${formatNumber(combo.basePlan.sumInsured)}</div>
						</div>
						<div class="detail-item">
							<div class="detail-label">Top-Up SI (${combo.topUpPlan.planType} Basis)</div>
							<div class="detail-value">Rs ${formatNumber(combo.topUpPlan.sumInsured)}</div>
						</div>
					</div>
					<div class="breakdown">
						<div class="breakdown-title">Premium Breakdown (Top-Up & Base)<span class="breakdown-toggle">+</span></div>
						<div class="breakdown-content">
					`;
					if(combo.topUpPlan.memberBreakdown && combo.topUpPlan.planType === 'Individual') {
						combo.topUpPlan.memberBreakdown.forEach(m => {
							html += `
								<div class="breakdown-item">
									<span>${capitalize(m.relationship)} (${m.age} years)</span>
									<span>Rs ${formatNumber(m.premiumIndividual)}</span>
								</div>`;
						});
						if (combo.topUpPlan.memberBreakdown.length > 1) {
							html+=`
								<div class="breakdown-item">
										<span>Total Super Top-Up Premium</span>
										<span>Rs ${formatNumber(parseInt((combo.topUpPlan.premium+combo.topUpPlan.discountOnPremium)))}</span>
								</div>
								<div class="breakdown-item">
										<span>Family Discount (%)</span>
										<span>5.00 %</span>
								</div>
								<div class="breakdown-item">
										<span>Family Discount</span>
										<span>Rs ${formatNumber(parseInt((combo.topUpPlan.discountOnPremium)))}</span>
								</div>
							`;
						}
					} else {
						html+=`
							<div class="breakdown-item">
									<span>Family Composition: ${combo.topUpPlan.memberBreakdown[0].relationship}, <br>Oldest Member Age : ${combo.topUpPlan.memberBreakdown[0].age} years</span>
									<span>Rs ${formatNumber(combo.topUpPlan.memberBreakdown[0].premiumFloater)}</span>
							</div>
						`;
					}
						html +=`<div class="breakdown-item">
							<span>Top-Up (${combo.topUpPlan.planType}: Rs ${formatNumber(combo.topUpPlan.sumInsured)}) | (Threshold - ${combo.basePlan.planType}: Rs ${formatNumber(combo.topUpPlan.threshold)})</span>
							<span>Rs ${formatNumber(combo.topUpPlan.premium)}</span>
						</div>
						<div class="breakdown-item">
							<span>Base: ${combo.basePlan.planName} (${combo.basePlan.planType})</span>
							<span>Rs ${formatNumber(combo.basePlan.premium)}</span>
						</div>
						
						<div class="breakdown-item">
							<span><strong>Total Premium of Combined Plans</strong></span>
							<span><strong>Rs ${formatNumber(combo.totalPremium)}</strong></span>
						</div>
					</div>
					</div>
			</div>
		`;
	});
	c.innerHTML=html;

	// Add click event listeners to all breakdown titles
    setTimeout(() => {
        const breakdownTitles = c.querySelectorAll('.breakdown-title');
        breakdownTitles.forEach(title => {
            title.addEventListener('click', function() {
                const breakdown = this.parentElement;
                const breakdownContent = this.nextElementSibling;
                const toggle = this.querySelector('.breakdown-toggle');
                
                breakdown.classList.toggle('active');
                
                if (breakdown.classList.contains('active')) {
                    breakdownContent.style.maxHeight = breakdownContent.scrollHeight + 'px';
                    toggle.textContent = '−';
                } else {
                    breakdownContent.style.maxHeight = '0';
                    toggle.textContent = '+';
                }
            });
        });
    }, 0);
}

function displayDetailedView(r){
	const c=document.getElementById('detailedTab');
	const{
		userData,
		familyStructure,
		individualPlans,
		combinationPlans
	}=r;
	let html=`
		<div class="section-title">Detailed Analysis</div>
		<div class="breakdown">
			<div class="breakdown-title">Input Summary</div>
			<div class="breakdown-item">
				<span>Primary Age</span>
				<span>${userData.age} years</span>
			</div>
			<div class="breakdown-item">
				<span>Location</span>
				<span>${userData.location} (Zone ${userData.zone})</span>
			</div>
			<div class="breakdown-item">
				<span>Budget</span>
				<span>Rs ${formatNumber(userData.budget)}</span>
			</div>
			<div class="breakdown-item">
				<span>Family Members</span>
				<span>${familyStructure.totalMembers} [${familyStructure.adults} adult(s), ${familyStructure.children} child(ren), ${familyStructure.parents} parent(s)]</span>
			</div>
		</div>
		<div class="breakdown" style="margin-top:1.5rem;">
			<div class="breakdown-title">Family Members Detail</div>
	`;
	userData.members.forEach((m,i)=>{
		html+=`
			<div class="breakdown-item">
				<span>Member ${i+1}: ${capitalize(m.relationship)}</span>
				<span>${m.age} years</span>
			</div>
		`;
	});
	html+=`
		</div>
		<div class="breakdown" style="margin-top:1.5rem;">
			<div class="breakdown-title">Recommendations Summary</div>
			<div class="breakdown-item">
				<span>Individual/Family Plans Found</span>
				<span>${individualPlans.length}</span>
			</div>
			<div class="breakdown-item">
				<span>Combination Plans Found</span>
				<span>${combinationPlans.length}</span>
			</div>
	`;
	if(individualPlans.length>0){
		html+=`
			
			<div class="breakdown-item">
				<span>Best Base Plan</span>
				<span>${individualPlans[0].planName}</span>
			</div>
			<div class="breakdown-item">
				<span>Base Coverage</span>
				<span>${individualPlans[0].planType} Basis</span>
			</div>
			<div class="breakdown-item">
				<span>Base Sum Insured on ${individualPlans[0].planType==='Individual'?'Individual':'Floater'} Basis</span>
				<span>Rs ${formatNumber(individualPlans[0].sumInsured)}</span>
			</div>
			<div class="breakdown-item">
				<span>Final Premium of Base Plan (${individualPlans[0].planId} - ${individualPlans[0].planType}) after applicable discounts</span>
				<span>Rs ${formatNumber(individualPlans[0].premium)}</span>
			</div>

		`;
	}
	if(combinationPlans.length>0){
		html+=`

			<div class="breakdown-item">
				<span>Super Top-Up Sum Insured</span>
				<span>Rs ${formatNumber(combinationPlans[0].topUpPlan.sumInsured)}</span>
			</div>

			<div class="breakdown-item">
				<span>Super Top-Up Coverage</span>
				<span>${(combinationPlans[0].topUpPlan.planType)} Basis</span>
			</div>

			<div class="breakdown-item">
				<span>Super Top-Up Final Premium after applicable discounts</span>
				<span>${formatNumber(combinationPlans[0].topUpPlan.premium)}</span>
			</div>

			<div class="breakdown-item">
				<span>Highest Coverage Offered (in Combination)</span>
				<span>Rs ${formatNumber(combinationPlans[0].totalCover)}</span>
			</div>

			<div class="breakdown-item">
				<span>Gross Premium (of Plans Combination)</span>
				<span>Rs ${formatNumber(combinationPlans[0].totalPremium)}</span>
			</div>
		`;
	}
	html+=`
		</div>
	`;
	c.innerHTML=html;
}


////////////////
// Initialize column dragging for dynamic tables
/*function initializeColumnDragging() {
    const $header = $("#comparisonHeader");
    
    // Check if we have enough columns to make draggable
    if ($header.find("th").length <= 1) {
        return; // Need at least 2 columns (1 fixed + 1 draggable)
    }
    
    // Initialize sortable on the header
    $header.sortable({
        items: "th:not(:first-child)", // Don't drag first column
        placeholder: "ui-state-highlight",
        cursor: "move",
        start: function(event, ui) {
            // Store original column positions
            $header.find('th').each(function(index) {
                $(this).data('original-index', index);
            });
        },
        stop: function(event, ui) {
            // Get new order from header
            const newOrder = $header.find('th').map(function() {
                return $(this).data('original-index');
            }).get();
            
            // Reorder ALL rows in the table (both header and body)
            const $table = $("#comparisonTable");
            $table.find('tr').each(function() {
                const $cells = $(this).children('th, td');
                const reorderedCells = [];
                
                // Reorder cells based on new order
                newOrder.forEach(function(oldIndex) {
                    reorderedCells.push($cells.eq(oldIndex).clone(true));
                });
                
                // Replace row content
                $(this).empty().append(reorderedCells);
            });
            
            // Reinitialize dragging after DOM changes
            setTimeout(initializeColumnDragging, 100);
        }
    });
}

// Call this after you populate the table with data
function setupComparisonTable() {
    // Wait for DOM to update then initialize dragging
    setTimeout(initializeColumnDragging, 300);
}*/

function displayComparison(plans) {
  const comparisonSection = document.getElementById('comparisonSection');
  const comparisonHeader = document.getElementById('comparisonHeader');
  const comparisonBody = document.getElementById('comparisonBody');

  // Clear existing content
  comparisonHeader.innerHTML = '';
  comparisonBody.innerHTML = '';
console.log(plans);
  // Header: Feature + dynamic plan columns
  const headerRow = ['Feature'];
  plans.forEach((plan,index) => {
    headerRow.push(`${index + 1}. ${plan.planName} (${plan.planType})`);
  });
  comparisonHeader.innerHTML = `<th>${headerRow.join('</th><th>')}</th>`;

  // Attributes to compare
  const attributes = [
    { key: 'sumInsured', label: 'Sum Insured (Rs)', format: (v) => formatNumber(v) },
    { key: 'totalPremium', label: 'Total Premium (Rs)', format: (v) => formatNumber(v) },
    //{ key: 'discountOnPremium', label: 'Discount (Rs)', format: (v) => formatNumber(v) },
    { key: 'overBudget', label: 'Budget Status', format: (v) => v ? 'Over Budget' : 'Within Budget' },
	{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			{ key: 'features.freeLookPeriod', label: 'Free Look Period', format:(v) => capitalize(v)},
			{ key: 'features.migration', label: 'Migration', format:(value) => value},
			{ key: 'features.portability', label: 'Portability', format:(value) => value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium Period', format:(value) => value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) => value},
			{ key: 'features.icu', label: 'ICU', format:(value) => value},
			{ key: 'features.preHospitalisation', label: 'Pre-Hospitalisation', format:(value) => value},
			{ key: 'features.postHospitalisation', label: 'Post-Hospitalisation', format:(value) => value},
			{ key: 'features.mtmat', label: 'Modern Treatment', format:(value) => value},
			{ key: 'features.copay', label: 'Co-Payment', format:(value) => value},
			{ key: 'features.restorationOfSi', label: 'SI Restoration', format:(value) => value},
			{ key: 'features.intialWaitingPeriod', label: 'Initial Waiting', format:(value) => value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Waiting', format:(value) => value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity Cover', format:(value) => value},
			{ key: 'features.ped', label: 'Pre-existing Disease', format:(value) => value},
			{ key: 'features.capping', label: 'Capping', format:(value) => value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness', format:(value) => value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) => value},
			{ key: 'features.roadAmbulance', label: 'Ambulance', format:(value) => value},
			{ key: 'features.proportionateClause', label: 'Proportionate Clause', format:(value) => value},
			{ key: 'features.reasonableCustomary', label: 'R&C Clause', format:(value) => value},
			{ key: 'features.donorExpenses', label: 'Donor Expenses', format:(value) => value},
			{ key: 'features.healthCheckup', label: 'Health Checkup', format:(value) => value},
			{ key: 'features.ayushCover', label: 'AYUSH Cover', format:(value) => value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash', format:(value) => value},
			{ key: 'features.ncdRenewalPremium', label: 'NCD %', format:(value) => value},
			{ key: 'features.cbSi', label: 'CB % of SI', format:(value) => value}
  ];

//

	attributes.forEach(attr => {
    const row = [attr.label];
    plans.forEach(plan => {
      let value = getNestedValue(plan, attr.key);
	  if (attr.format && value !== undefined) {
			value = attr.format(value);
		}
      row.push(value !== undefined ? value.toString() : 'N/A');
    });
    comparisonBody.appendChild(createRow(row));
  });
	
	// Rows for each attribute
  /*attributes.forEach(attr => {
    const row = [attr.label];
    plans.forEach(plan => {
      let value = plan[attr.key];
      row.push(value !== undefined ? (attr.format ? attr.format(value) : value) : 'N/A');
    });
    comparisonBody.appendChild(createRow(row));
  });*/

// After populating your table with data, call:
//setupComparisonTable();

  comparisonSection.style.display = 'block';
}

function createRow(dataArray) {
  const tr = document.createElement('tr');
  dataArray.forEach(data => {
    const td = document.createElement('td');
    td.textContent = data;
    tr.appendChild(td);
  });
  // After adding dynamic rows, call:
//initializeColumnDragging();
  return tr;
}

// Make the header draggable
/*$(function() {
  $("#comparisonHeader").sortable({
    items: "th:not(:first-child)", // Prevent dragging the first column
    placeholder: "ui-state-highlight",
    stop: function(event, ui) {
      const headers = $("#comparisonHeader th");
      headers.each(function(index) {
        $(this).data('index', index);
      });
    }
  });
});*/
// Make the table columns draggable
// Make the entire column draggable


/*function exportToPDF(){
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	const{jsPDF}=window.jspdf;
	const doc=new jsPDF();
	doc.setFontSize(18);
	doc.setTextColor(37,99,235);
	doc.text('Health Insurance Recommendations',14,20);
	doc.setFontSize(10);
	doc.setTextColor(0,0,0);
	doc.text('Generated: '+new Date().toLocaleDateString(),14,28);
	let y=38;
	doc.setFontSize(12);
	doc.setFont(undefined,'bold');
	doc.text('Input Summary',14,y);
	y+=8;
	doc.setFontSize(10);
	doc.setFont(undefined,'normal');
	doc.text(`Age: ${userData.age} | Budget: Rs ${formatNumber(userData.budget)}`,14,y);
	y+=6;
	doc.text(`Location: ${userData.location} (Zone ${userData.zone})`,14,y);
	y+=6;
	doc.text(`Family Members: ${results.familyStructure.totalMembers} | ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)`,14,y);
	y+=10;
	if(results.individualPlans.length>0){
		doc.setFontSize(12);
		doc.setFont(undefined,'bold');
		doc.text('Individual/Family Plans',14,y);
		y+=5;
		const individualData=results.individualPlans.map(
			(p,i)=>[
				(i+1).toString(),
				p.planName,
				p.planType,
				formatNumber(p.sumInsured),
				formatNumber(p.premium),
				p.overBudget?'Over':'Within'
			]
		);
		doc.autoTable({
			startY:y,
			head:[	
				[
					'#',
					'Plan',
					'Type',
					'Sum Insured (Rs)',
					'Premium (Rs)',
					'Status'
				]
			],
			body:individualData,
			theme:'grid',
			headStyles:{
				fillColor:[37,99,235]
			},
			styles:{
				fontSize:8
			}
		});
		y=doc.lastAutoTable.finalY+10;
	}
	if(y>250){
		doc.addPage();
		y=20;
	}
	if(results.combinationPlans.length>0){
		doc.setFontSize(12);
		doc.setFont(undefined,'bold');
		doc.text('Combination Plans',14,y);
		y+=5;
		const comboData=results.combinationPlans.map(
			(c,i)=>[(i+1).toString(),
			c.basePlan.planName,
			formatNumber(c.basePlan.sumInsured),
			formatNumber(c.topUpPlan.sumInsured),
			formatNumber(c.totalCover),
			formatNumber(c.totalPremium)]
		);
		doc.autoTable({
			startY:y,
			head:[
				[
					'#',
					'Base',
					'Base SI (Rs)',
					'Top-Up SI (Rs)',
					'Total (Rs)',
					'Premium (Rs)'
				]
			],
			body:comboData,
			theme:'grid',
			headStyles:{	
				fillColor:[37,99,235]
			},
			styles:{	
				fontSize:7
			}
		});
	}
	doc.save('insurance-recommendations.pdf');
}*/

/*function exportToPDF() {
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	
	const {jsPDF} = window.jspdf;
	const doc = new jsPDF();
	
	// Title and header
	doc.setFontSize(18);
	doc.setTextColor(37, 99, 235);
	doc.text('Health Insurance Recommendations', 14, 20);
	doc.setFontSize(10);
	doc.setTextColor(0, 0, 0);
	doc.text('Generated: ' + new Date().toLocaleDateString(), 14, 28);
	
	let y = 38;
	
	// Input Summary
	doc.setFontSize(12);
	doc.setFont(undefined, 'bold');
	doc.text('Input Summary', 14, y);
	y += 8;
	doc.setFontSize(10);
	doc.setFont(undefined, 'normal');
	doc.text(`Age: ${userData.age} | Budget: Rs ${formatNumber(userData.budget)}`, 14, y);
	y += 6;
	doc.text(`Location: ${userData.location} (Zone ${userData.zone})`, 14, y);
	y += 6;
	doc.text(`Family Members: ${results.familyStructure.totalMembers} | ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)`, 14, y);
	y += 15;
	
	// Plan Comparison Table
	if(results.individualPlans.length > 0) {
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Base Plan Comparison', 14, y);
		y += 8;
		
		// Define the comparison attributes you want to show
		const comparisonAttributes = [
			//{ key: 'planName', label: 'Plan Name' },
			{ key: 'planType', label: 'Plan Type' },
			{ key: 'sumInsured', label: 'Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'discountOnPremium', label: 'Discount (Rs)', format: (value) => formatNumber(value.toFixed(2)) },
			{ key: 'premium', label: 'Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			//{ key: 'features.maternity', label: 'Maternity Cover', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.preExistingDiseases', label: 'Pre-existing Diseases', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.dailyCash', label: 'Daily Cash', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.cumulative', label: 'Cumulative Bonus', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.roomRent', label: 'Room Rent', format: (value) => value === 'no_limit' ? 'No Limit' : 'Standard' },
			//{ key: 'features.copayment', label: 'Co-payment', format: (value) => value ? 'Yes' : 'No' }
			{ key: 'features.freeLookPeriod', label: 'Free Look Period', format:(value) =>value},
			{ key: 'features.migration', label: 'Migration', format:(value) =>value},
			{ key: 'features.portability', label: 'Portability', format:(value) =>value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium Period', format:(value) =>value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) =>value},
			{ key: 'features.icu', label: 'Icu', format:(value) =>value},
			{ key: 'features.preHospitalisation', label: 'Pre Hospitalisation', format:(value) =>value},
			{ key: 'features.postHospitalisation', label: 'Post Hospitalisation', format:(value) =>value},
			{ key: 'features.mtmat', label: 'Mtmat', format:(value) =>value},
			{ key: 'features.copay', label: 'Co-Pay', format:(value) =>value},
			{ key: 'features.restorationOfSi', label: 'Restoration Of Si', format:(value) =>value},
			{ key: 'features.intialWaitingPeriod', label: 'Intial Waiting Period', format:(value) =>value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Waitingperiods', format:(value) =>value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity Cover With New Borncover', format:(value) =>value},
			{ key: 'features.ped', label: 'Ped', format:(value) =>value},
			{ key: 'features.capping', label: 'Capping', format:(value) =>value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness Cover', format:(value) =>value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) =>value},
			{ key: 'features.roadAmbulance', label: 'Road Ambulance', format:(value) =>value},
			{ key: 'features.proportionateClause', label: 'Proportionate Clause', format:(value) =>value},
			{ key: 'features.reasonableCustomary', label: 'Reasonable & Customaryclause', format:(value) =>value},
			{ key: 'features.donorExpenses', label: 'Donor Expenses', format:(value) =>value},
			{ key: 'features.healthCheckup', label: 'Health Checkup(After 3 Claim Freeyears)', format:(value) =>value},
			{ key: 'features.ayushCover', label: 'Ayush Cover', format:(value) =>value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash Cover', format:(value) =>value},
			{ key: 'features.ncdRenewalPremium', label: 'Ncd As % Of Renewal Premium', format:(value) =>value},
			{ key: 'features.cbSi', label: 'Cb As % Of Si', format:(value) =>value}

		];
		
		// Prepare data for side-by-side comparison
		const tableData = [];
		
		// Add header row with plan numbers
		const headerRow = ['Plan Name & Features'];
		results.individualPlans.forEach((plan, index) => {
			//headerRow.push(`Plan ${index + 1}`);
			const tblheader =plan.planName+" ("+plan.planType+")";
			headerRow.push(tblheader);
		});
		tableData.push(headerRow);
		
		// Add data rows for each attribute
		comparisonAttributes.forEach(attr => {
			const row = [attr.label];
			
			results.individualPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			
			tableData.push(row);
		});
		
		// Create the table
		doc.autoTable({
			startY: y,
			head: [tableData[0]],
			body: tableData.slice(1),
			theme: 'grid',
			headStyles: {
				fillColor: [37, 99, 235],
				fontStyle: 'bold',
				textColor: 255
			},
			styles: {
				fontSize: 7, // Smaller font to fit more columns
				cellPadding: 2,
				overflow: 'linebreak',
				halign: 'center'
			},
			columnStyles: {
				0: { halign: 'left', fontStyle: 'bold' } // First column (features) left aligned and bold
			},
			margin: { left: 10, right: 10 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 10;
		
		// Add plan details section for breakdown
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Base Plan Details Breakdown', 14, y);
		y += 8;
		
		// Create a details table for premium breakdown
		const detailsData = [];
		results.individualPlans.forEach((plan, planIndex) => {
			detailsData.push([
				{ content: `Plan ${planIndex + 1}: ${plan.planName} (${plan.planType})`, colSpan: 3, styles: { fillColor: [240, 240, 240], fontStyle: 'bold' } }
			]);
			
			// Add header for breakdown
			detailsData.push(['Member', 'Age', 'Premium (Rs)']);
			
			// Add breakdown rows
			if (plan.breakdown && plan.breakdown.length > 0) {
				plan.breakdown.forEach(member => {
					detailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premium || member.premiumMember)
					]);
				});
			}
			
			// Add total and discount
			detailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.totalPremium), styles: { fontStyle: 'bold' } }
			]);
			
			detailsData.push([
				{ content: 'Discount:', colSpan: 2 },
				formatNumber(plan.discountOnPremium)
			]);
			
			detailsData.push([
				{ content: 'Final Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.premium), styles: { fontStyle: 'bold', textColor: [0, 100, 0] } }
			]);
			
			// Add empty row for spacing
			detailsData.push(['', '', '']);
		});
		
		doc.autoTable({
			startY: y,
			body: detailsData,
			theme: 'grid',
			styles: {
				fontSize: 8,
				cellPadding: 3
			},
			headStyles: {
				fillColor: [200, 200, 200],
				fontStyle: 'bold'
			},
			margin: { left: 10, right: 10 }
		});
	}
	
	doc.save('insurance-recommendations.pdf');
}
*/

/*function exportToPDF() {
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	
	const {jsPDF} = window.jspdf;
	const doc = new jsPDF();
	
	// Title and header
	doc.setFontSize(18);
	doc.setTextColor(37, 99, 235);
	doc.text('Health Insurance Recommendations', 14, 20);
	doc.setFontSize(10);
	doc.setTextColor(0, 0, 0);
	doc.text('Generated: ' + new Date().toLocaleDateString(), 14, 28);
	
	let y = 38;
	
	// Input Summary
	doc.setFontSize(12);
	doc.setFont(undefined, 'bold');
	doc.text('Input Summary', 14, y);
	y += 8;
	doc.setFontSize(10);
	doc.setFont(undefined, 'normal');
	doc.text(`Age: ${userData.age} | Budget: Rs ${formatNumber(userData.budget)}`, 14, y);
	y += 6;
	doc.text(`Location: ${userData.location} (Zone ${userData.zone})`, 14, y);
	y += 6;
	doc.text(`Family Members: ${results.familyStructure.totalMembers} | ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)`, 14, y);
	y += 15;
	
	// Individual Plans Comparison
	if(results.individualPlans && results.individualPlans.length > 0) {
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Individual & Family Plans Comparison', 14, y);
		y += 8;
		
		const comparisonAttributes = [
			{ key: 'planName', label: 'Plan Name' },
			{ key: 'planType', label: 'Plan Type' },
			{ key: 'sumInsured', label: 'Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'premium', label: 'Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'discountOnPremium', label: 'Discount (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			//{ key: 'features.maternity', label: 'Maternity Cover', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.preExistingDiseases', label: 'Pre-existing Diseases', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.dailyCash', label: 'Daily Cash', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.cumulative', label: 'Cumulative Bonus', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.roomRent', label: 'Room Rent', format: (value) => value === 'no_limit' ? 'No Limit' : 'Standard' },
			//{ key: 'features.copayment', label: 'Co-payment', format: (value) => value ? 'Yes' : 'No' }
			{ key: 'features.freeLookPeriod', label: 'Free Look Period', format:(value) =>value},
			{ key: 'features.migration', label: 'Migration', format:(value) =>value},
			{ key: 'features.portability', label: 'Portability', format:(value) =>value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium Period', format:(value) =>value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) =>value},
			{ key: 'features.icu', label: 'Icu', format:(value) =>value},
			{ key: 'features.preHospitalisation', label: 'Pre Hospitalisation', format:(value) =>value},
			{ key: 'features.postHospitalisation', label: 'Post Hospitalisation', format:(value) =>value},
			{ key: 'features.mtmat', label: 'Mtmat', format:(value) =>value},
			{ key: 'features.copay', label: 'Co-Pay', format:(value) =>value},
			{ key: 'features.restorationOfSi', label: 'Restoration Of Si', format:(value) =>value},
			{ key: 'features.intialWaitingPeriod', label: 'Intial Waiting Period', format:(value) =>value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Waitingperiods', format:(value) =>value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity Cover With New Borncover', format:(value) =>value},
			{ key: 'features.ped', label: 'Ped', format:(value) =>value},
			{ key: 'features.capping', label: 'Capping', format:(value) =>value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness Cover', format:(value) =>value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) =>value},
			{ key: 'features.roadAmbulance', label: 'Road Ambulance', format:(value) =>value},
			{ key: 'features.proportionateClause', label: 'Proportionate Clause', format:(value) =>value},
			{ key: 'features.reasonableCustomary', label: 'Reasonable & Customaryclause', format:(value) =>value},
			{ key: 'features.donorExpenses', label: 'Donor Expenses', format:(value) =>value},
			{ key: 'features.healthCheckup', label: 'Health Checkup(After 3 Claim Freeyears)', format:(value) =>value},
			{ key: 'features.ayushCover', label: 'Ayush Cover', format:(value) =>value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash Cover', format:(value) =>value},
			{ key: 'features.ncdRenewalPremium', label: 'Ncd As % Of Renewal Premium', format:(value) =>value},
			{ key: 'features.cbSi', label: 'Cb As % Of Si', format:(value) =>value}

		];
		
		const tableData = [];
		
		// Add header row with plan numbers
		const headerRow = ['Feature'];
		results.individualPlans.forEach((plan, index) => {
			headerRow.push(`Plan ${index + 1}`);
		});
		tableData.push(headerRow);
		
		// Add data rows for each attribute
		comparisonAttributes.forEach(attr => {
			const row = [attr.label];
			
			results.individualPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			
			tableData.push(row);
		});
		
		// Create the table
		doc.autoTable({
			startY: y,
			head: [tableData[0]],
			body: tableData.slice(1),
			theme: 'grid',
			headStyles: {
				fillColor: [37, 99, 235],
				fontStyle: 'bold',
				textColor: 255
			},
			styles: {
				fontSize: 7,
				cellPadding: 2,
				overflow: 'linebreak',
				halign: 'center'
			},
			columnStyles: {
				0: { halign: 'left', fontStyle: 'bold' }
			},
			margin: { left: 10, right: 10 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 10;
		
		// Individual Plans Details Breakdown
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Individual Plans - Premium Breakdown', 14, y);
		y += 8;
		
		const individualDetailsData = [];
		results.individualPlans.forEach((plan, planIndex) => {
			individualDetailsData.push([
				{ content: `Plan ${planIndex + 1}: ${plan.planName} (${plan.planType})`, colSpan: 3, styles: { fillColor: [240, 240, 240], fontStyle: 'bold' } }
			]);
			
			individualDetailsData.push(['Member', 'Age', 'Premium (Rs)']);
			
			if (plan.breakdown && plan.breakdown.length > 0) {
				plan.breakdown.forEach(member => {
					individualDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premium || member.premiumMember)
					]);
				});
			}
			
			individualDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.totalPremium), styles: { fontStyle: 'bold' } }
			]);
			
			individualDetailsData.push([
				{ content: 'Discount:', colSpan: 2 },
				formatNumber(plan.discountOnPremium)
			]);
			
			individualDetailsData.push([
				{ content: 'Final Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.premium), styles: { fontStyle: 'bold', textColor: plan.overBudget ? [255, 0, 0] : [0, 100, 0] } }
			]);
			
			individualDetailsData.push(['', '', '']);
		});
		
		doc.autoTable({
			startY: y,
			body: individualDetailsData,
			theme: 'grid',
			styles: {
				fontSize: 8,
				cellPadding: 3
			},
			headStyles: {
				fillColor: [200, 200, 200],
				fontStyle: 'bold'
			},
			margin: { left: 10, right: 10 }
		});
		
		y = doc.lastAutoTable.finalY + 15;
	}
	
	// Combination Plans Comparison
	if(results.combinationPlans && results.combinationPlans.length > 0) {
		// Add new page if needed
		if (y > 200) {
			doc.addPage();
			y = 20;
		}
		
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Combination Plans (Base + Super Top-Up) Comparison', 14, y);
		y += 8;
		
		// Define comparison attributes for combination plans
		const combinationAttributes = [
			{ key: 'basePlan.planName', label: 'Base Plan' },
			{ key: 'basePlan.planType', label: 'Base Plan Type' },
			{ key: 'basePlan.sumInsured', label: 'Base Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'basePlan.premium', label: 'Base Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.planName', label: 'Top-Up Plan' },
			{ key: 'topUpPlan.planType', label: 'Top-Up Plan Type' },
			{ key: 'topUpPlan.sumInsured', label: 'Top-Up Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.threshold', label: 'Top-Up Threshold (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.premium', label: 'Top-Up Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.discountOnPremium', label: 'Top-Up Discount (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalCover', label: 'Total Coverage (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category' }
		];
		
		const combinationTableData = [];
		
		// Add header row with combination plan numbers
		const combinationHeaderRow = ['Feature'];
		results.combinationPlans.forEach((plan, index) => {
			combinationHeaderRow.push(`Combo ${index + 1}`);
		});
		combinationTableData.push(combinationHeaderRow);
		
		// Add data rows for each attribute
		combinationAttributes.forEach(attr => {
			const row = [attr.label];
			
			results.combinationPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			
			combinationTableData.push(row);
		});
		
		// Create the combination plans table
		doc.autoTable({
			startY: y,
			head: [combinationTableData[0]],
			body: combinationTableData.slice(1),
			theme: 'grid',
			headStyles: {
				fillColor: [128, 0, 128], // Purple color for combination plans
				fontStyle: 'bold',
				textColor: 255
			},
			styles: {
				fontSize: 7,
				cellPadding: 2,
				overflow: 'linebreak',
				halign: 'center'
			},
			columnStyles: {
				0: { halign: 'left', fontStyle: 'bold' }
			},
			margin: { left: 10, right: 10 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 10;
		
		// Combination Plans Details Breakdown
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Combination Plans - Premium Breakdown', 14, y);
		y += 8;
		
		const combinationDetailsData = [];
		results.combinationPlans.forEach((comboPlan, planIndex) => {
			// Base Plan Section
			combinationDetailsData.push([
				{ content: `Combo ${planIndex + 1}: ${comboPlan.basePlan.planName} + ${comboPlan.topUpPlan.planName}`, colSpan: 3, styles: { fillColor: [240, 240, 240], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Base Plan Details', colSpan: 3, styles: { fillColor: [220, 220, 220], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				'Plan',
				'Sum Insured (Rs)',
				'Premium (Rs)'
			]);
			
			combinationDetailsData.push([
				comboPlan.basePlan.planName,
				formatNumber(comboPlan.basePlan.sumInsured),
				formatNumber(comboPlan.basePlan.premium)
			]);
			
			// Top-Up Plan Section
			combinationDetailsData.push([
				{ content: 'Top-Up Plan Details', colSpan: 3, styles: { fillColor: [220, 220, 220], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				'Plan',
				'Sum Insured (Rs)',
				'Premium (Rs)'
			]);
			
			combinationDetailsData.push([
				comboPlan.topUpPlan.planName,
				formatNumber(comboPlan.topUpPlan.sumInsured),
				formatNumber(comboPlan.topUpPlan.premium)
			]);
			
			// Top-Up Plan Breakdown
			if (comboPlan.topUpPlan.memberBreakdown && comboPlan.topUpPlan.memberBreakdown.length > 0) {
				combinationDetailsData.push([
					{ content: 'Top-Up Member Breakdown', colSpan: 3, styles: { fontStyle: 'bold' } }
				]);
				
				combinationDetailsData.push(['Member', 'Age', 'Premium (Rs)']);
				
				comboPlan.topUpPlan.memberBreakdown.forEach(member => {
					combinationDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premiumIndividual || member.premiumFloater)
					]);
				});
			}
			
			// Totals
			combinationDetailsData.push([
				{ content: 'Total Coverage:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(comboPlan.totalCover), styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(comboPlan.totalPremium), styles: { fontStyle: 'bold', textColor: comboPlan.overBudget ? [255, 0, 0] : [0, 100, 0] } }
			]);
			
			combinationDetailsData.push(['', '', '']);
		});
		
		doc.autoTable({
			startY: y,
			body: combinationDetailsData,
			theme: 'grid',
			styles: {
				fontSize: 8,
				cellPadding: 3
			},
			headStyles: {
				fillColor: [200, 200, 200],
				fontStyle: 'bold'
			},
			margin: { left: 10, right: 10 }
		});
	}
	
	doc.save('insurance-recommendations.pdf');
}*/

/*function exportToPDF() {
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	
	const {jsPDF} = window.jspdf;
	// Change to landscape A4
	const doc = new jsPDF('l', 'mm', 'a4'); // Landscape mode, A4 size
	
	// Title and header - adjust positioning for landscape
	doc.setFontSize(18);
	doc.setTextColor(37, 99, 235);
	doc.text('Health Insurance Recommendations', 14, 20);
	doc.setFontSize(10);
	doc.setTextColor(0, 0, 0);
	doc.text('Generated: ' + new Date().toLocaleDateString(), 14, 28);
	
	let y = 38;
	
	// Input Summary
	doc.setFontSize(12);
	doc.setFont(undefined, 'bold');
	doc.text('Input Summary', 14, y);
	y += 8;
	doc.setFontSize(10);
	doc.setFont(undefined, 'normal');
	doc.text(`Age: ${userData.age} | Budget: Rs ${formatNumber(userData.budget)}`, 14, y);
	y += 6;
	doc.text(`Location: ${userData.location} (Zone ${userData.zone})`, 14, y);
	y += 6;
	doc.text(`Family Members: ${results.familyStructure.totalMembers} | ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)`, 14, y);
	y += 15;
	
	// Individual Plans Comparison
	if(results.individualPlans && results.individualPlans.length > 0) {
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Individual & Family Plans Comparison', 14, y);
		y += 8;
		
		const comparisonAttributes = [
			{ key: 'planName', label: 'Plan Name' },
			{ key: 'planType', label: 'Plan Type' },
			{ key: 'sumInsured', label: 'Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'discountOnPremium', label: 'Discount (Rs)', format: (value) => formatNumber(value.toFixed(2)) },
			{ key: 'premium', label: 'Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			//{ key: 'features.maternity', label: 'Maternity Cover', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.preExistingDiseases', label: 'Pre-existing Diseases', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.dailyCash', label: 'Daily Cash', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.cumulative', label: 'Cumulative Bonus', format: (value) => value ? 'Yes' : 'No' },
			//{ key: 'features.roomRent', label: 'Room Rent', format: (value) => value === 'no_limit' ? 'No Limit' : 'Standard' },
			//{ key: 'features.copayment', label: 'Co-payment', format: (value) => value ? 'Yes' : 'No' }
			{ key: 'features.freeLookPeriod', label: 'Free Look Period', format:(value) =>value},
			{ key: 'features.migration', label: 'Migration', format:(value) =>value},
			{ key: 'features.portability', label: 'Portability', format:(value) =>value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium Period', format:(value) =>value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) =>value},
			{ key: 'features.icu', label: 'Icu', format:(value) =>value},
			{ key: 'features.preHospitalisation', label: 'Pre Hospitalisation', format:(value) =>value},
			{ key: 'features.postHospitalisation', label: 'Post Hospitalisation', format:(value) =>value},
			{ key: 'features.mtmat', label: 'Mtmat', format:(value) =>value},
			{ key: 'features.copay', label: 'Co-Pay', format:(value) =>value},
			{ key: 'features.restorationOfSi', label: 'Restoration Of Si', format:(value) =>value},
			{ key: 'features.intialWaitingPeriod', label: 'Intial Waiting Period', format:(value) =>value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Waitingperiods', format:(value) =>value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity Cover With New Borncover', format:(value) =>value},
			{ key: 'features.ped', label: 'Ped', format:(value) =>value},
			{ key: 'features.capping', label: 'Capping', format:(value) =>value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness Cover', format:(value) =>value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) =>value},
			{ key: 'features.roadAmbulance', label: 'Road Ambulance', format:(value) =>value},
			{ key: 'features.proportionateClause', label: 'Proportionate Clause', format:(value) =>value},
			{ key: 'features.reasonableCustomary', label: 'Reasonable & Customaryclause', format:(value) =>value},
			{ key: 'features.donorExpenses', label: 'Donor Expenses', format:(value) =>value},
			{ key: 'features.healthCheckup', label: 'Health Checkup(After 3 Claim Freeyears)', format:(value) =>value},
			{ key: 'features.ayushCover', label: 'Ayush Cover', format:(value) =>value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash Cover', format:(value) =>value},
			{ key: 'features.ncdRenewalPremium', label: 'Ncd As % Of Renewal Premium', format:(value) =>value},
			{ key: 'features.cbSi', label: 'Cb As % Of Si', format:(value) =>value}
		];
		
		const tableData = [];
		
		// Add header row with plan numbers
		const headerRow = ['Feature'];
		results.individualPlans.forEach((plan, index) => {
			headerRow.push(`Plan ${index + 1}`);
		});
		tableData.push(headerRow);
		
		// Add data rows for each attribute
		comparisonAttributes.forEach(attr => {
			const row = [attr.label];
			
			results.individualPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			
			tableData.push(row);
		});
		
		// Create the table - you can use wider columns in landscape
		doc.autoTable({
			startY: y,
			head: [tableData[0]],
			body: tableData.slice(1),
			theme: 'grid',
			headStyles: {
				fillColor: [37, 99, 235],
				fontStyle: 'bold',
				textColor: 255
			},
			styles: {
				fontSize: 8, // You can use slightly larger font in landscape
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center'
			},
			columnStyles: {
				0: { halign: 'left', fontStyle: 'bold', cellWidth: 40 } // Wider first column
			},
			margin: { left: 10, right: 10 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 10;
		
		// Individual Plans Details Breakdown
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Individual Plans - Premium Breakdown', 14, y);
		y += 8;
		
		const individualDetailsData = [];
		results.individualPlans.forEach((plan, planIndex) => {
			individualDetailsData.push([
				{ content: `Plan ${planIndex + 1}: ${plan.planName} (${plan.planType})`, colSpan: 3, styles: { fillColor: [240, 240, 240], fontStyle: 'bold' } }
			]);
			
			individualDetailsData.push(['Member', 'Age', 'Premium (Rs)']);
			
			if (plan.breakdown && plan.breakdown.length > 0) {
				plan.breakdown.forEach(member => {
					individualDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premium || member.premiumMember)
					]);
				});
			}
			
			individualDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.totalPremium), styles: { fontStyle: 'bold' } }
			]);
			
			individualDetailsData.push([
				{ content: 'Discount:', colSpan: 2 },
				formatNumber(plan.discountOnPremium)
			]);
			
			individualDetailsData.push([
				{ content: 'Final Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(plan.premium), styles: { fontStyle: 'bold', textColor: plan.overBudget ? [255, 0, 0] : [0, 100, 0] } }
			]);
			
			individualDetailsData.push(['', '', '']);
		});
		
		doc.autoTable({
			startY: y,
			body: individualDetailsData,
			theme: 'grid',
			styles: {
				fontSize: 8,
				cellPadding: 3
			},
			headStyles: {
				fillColor: [200, 200, 200],
				fontStyle: 'bold'
			},
			margin: { left: 10, right: 10 }
		});
		
		y = doc.lastAutoTable.finalY + 15;
	}
	
	// Combination Plans Comparison
	if(results.combinationPlans && results.combinationPlans.length > 0) {
		// Add new page if needed - landscape has more vertical space
		if (y > 150) { // Adjusted for landscape
			doc.addPage();
			y = 20;
		}
		
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Combination Plans (Base + Super Top-Up) Comparison', 14, y);
		y += 8;
		
		// Define comparison attributes for combination plans
		const combinationAttributes = [
			{ key: 'basePlan.planName', label: 'Base Plan' },
			{ key: 'basePlan.planType', label: 'Base Plan Type' },
			{ key: 'basePlan.sumInsured', label: 'Base Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'basePlan.premium', label: 'Base Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.planName', label: 'Top-Up Plan' },
			{ key: 'topUpPlan.planType', label: 'Top-Up Plan Type' },
			{ key: 'topUpPlan.sumInsured', label: 'Top-Up Sum Insured (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.threshold', label: 'Top-Up Threshold (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.premium', label: 'Top-Up Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'topUpPlan.discountOnPremium', label: 'Top-Up Discount (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalCover', label: 'Total Coverage (Rs)', format: (value) => formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium (Rs)', format: (value) => formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category' }
		];
		
		const combinationTableData = [];
		
		// Add header row with combination plan numbers
		const combinationHeaderRow = ['Feature'];
		results.combinationPlans.forEach((plan, index) => {
			combinationHeaderRow.push(`Combo ${index + 1}`);
		});
		combinationTableData.push(combinationHeaderRow);
		
		// Add data rows for each attribute
		combinationAttributes.forEach(attr => {
			const row = [attr.label];
			
			results.combinationPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			
			combinationTableData.push(row);
		});
		
		// Create the combination plans table
		doc.autoTable({
			startY: y,
			head: [combinationTableData[0]],
			body: combinationTableData.slice(1),
			theme: 'grid',
			headStyles: {
				fillColor: [128, 0, 128],
				fontStyle: 'bold',
				textColor: 255
			},
			styles: {
				fontSize: 8,
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center'
			},
			columnStyles: {
				0: { halign: 'left', fontStyle: 'bold', cellWidth: 45 } // Wider first column
			},
			margin: { left: 10, right: 10 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 10;
		
		// Combination Plans Details Breakdown
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.text('Combination Plans - Premium Breakdown', 14, y);
		y += 8;
		
		const combinationDetailsData = [];
		results.combinationPlans.forEach((comboPlan, planIndex) => {
			// Base Plan Section
			combinationDetailsData.push([
				{ content: `Combo ${planIndex + 1}: ${comboPlan.basePlan.planName} + ${comboPlan.topUpPlan.planName}`, colSpan: 3, styles: { fillColor: [240, 240, 240], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Base Plan Details', colSpan: 3, styles: { fillColor: [220, 220, 220], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				'Plan',
				'Sum Insured (Rs)',
				'Premium (Rs)'
			]);
			
			combinationDetailsData.push([
				comboPlan.basePlan.planName,
				formatNumber(comboPlan.basePlan.sumInsured),
				formatNumber(comboPlan.basePlan.premium)
			]);
			
			// Top-Up Plan Section
			combinationDetailsData.push([
				{ content: 'Top-Up Plan Details', colSpan: 3, styles: { fillColor: [220, 220, 220], fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				'Plan',
				'Sum Insured (Rs)',
				'Premium (Rs)'
			]);
			
			combinationDetailsData.push([
				comboPlan.topUpPlan.planName,
				formatNumber(comboPlan.topUpPlan.sumInsured),
				formatNumber(comboPlan.topUpPlan.premium)
			]);
			
			// Top-Up Plan Breakdown
			if (comboPlan.topUpPlan.memberBreakdown && comboPlan.topUpPlan.memberBreakdown.length > 0) {
				combinationDetailsData.push([
					{ content: 'Top-Up Member Breakdown', colSpan: 3, styles: { fontStyle: 'bold' } }
				]);
				
				combinationDetailsData.push(['Member', 'Age', 'Premium (Rs)']);
				
				comboPlan.topUpPlan.memberBreakdown.forEach(member => {
					combinationDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premiumIndividual || member.premiumFloater)
					]);
				});
			}
			
			// Totals
			combinationDetailsData.push([
				{ content: 'Total Coverage:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(comboPlan.totalCover), styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold' } },
				{ content: formatNumber(comboPlan.totalPremium), styles: { fontStyle: 'bold', textColor: comboPlan.overBudget ? [255, 0, 0] : [0, 100, 0] } }
			]);
			
			combinationDetailsData.push(['', '', '']);
		});
		
		doc.autoTable({
			startY: y,
			body: combinationDetailsData,
			theme: 'grid',
			styles: {
				fontSize: 8,
				cellPadding: 3
			},
			headStyles: {
				fillColor: [200, 200, 200],
				fontStyle: 'bold'
			},
			margin: { left: 10, right: 10 }
		});
	}
	
	doc.save('insurance-recommendations.pdf');
}*/

/*function exportToPDF() {
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	
	const {jsPDF} = window.jspdf;
	const doc = new jsPDF('l', 'mm', 'a4');
	
	// Modern color palette
	const colors = {
		primary: [59, 130, 246],      // Modern blue
		secondary: [139, 92, 246],     // Purple
		accent: [236, 72, 153],        // Pink
		success: [34, 197, 94],        // Green
		warning: [251, 146, 60],       // Orange
		danger: [239, 68, 68],         // Red
		dark: [15, 23, 42],            // Slate dark
		gray: [100, 116, 139],         // Slate gray
		lightGray: [241, 245, 249],    // Light background
		white: [255, 255, 255]
	};
	
	// Helper function to add gradient background
	const addGradientHeader = (startY, height) => {
		doc.setFillColor(...colors.primary);
		doc.rect(0, startY, 297, height, 'F');
		doc.setFillColor(59, 130, 246, 0.8);
		doc.rect(0, startY, 297, height/2, 'F');
	};
	
	// Create modern header with gradient
	addGradientHeader(0, 45);
	
	// Add decorative circles
	doc.setFillColor(255, 255, 255, 0.1);
	doc.circle(270, 15, 25, 'F');
	doc.circle(250, 35, 15, 'F');
	
	// Title with shadow effect
	doc.setFontSize(28);
	doc.setTextColor(...colors.white);
	doc.setFont(undefined, 'bold');
	doc.text('Health Insurance Recommendations', 20, 22);
	
	// Subtitle
	doc.setFontSize(11);
	doc.setFont(undefined, 'normal');
	doc.setTextColor(255, 255, 255, 0.9);
	doc.text('Personalized Plan Analysis & Comparison', 20, 30);
	
	// Generated date badge
	doc.setFillColor(...colors.white);
	doc.roundedRect(20, 34, 50, 7, 2, 2, 'F');
	doc.setFontSize(9);
	doc.setTextColor(...colors.primary);
	doc.text('📅 ' + new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), 22, 38.5);
	
	let y = 55;
	
	// Input Summary Card
	doc.setFillColor(...colors.lightGray);
	doc.roundedRect(15, y, 267, 30, 3, 3, 'F');
	
	// Card header
	doc.setFillColor(...colors.primary);
	doc.roundedRect(15, y, 267, 8, 3, 3, 'F');
	doc.setFontSize(12);
	doc.setFont(undefined, 'bold');
	doc.setTextColor(...colors.white);
	doc.text('📊 Your Profile Summary', 20, y + 5.5);
	
	y += 12;
	
	// Profile info with icons
	doc.setFontSize(10);
	doc.setTextColor(...colors.dark);
	doc.setFont(undefined, 'normal');
	
	const profileInfo = [
		{ icon: '👤', label: 'Age:', value: userData.age },
		{ icon: '💰', label: 'Budget:', value: `Rs ${formatNumber(userData.budget)}` },
		{ icon: '📍', label: 'Location:', value: `${userData.location} (Zone ${userData.zone})` },
		{ icon: '👨‍👩‍👧‍👦', label: 'Family:', value: `${results.familyStructure.totalMembers} members - ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)` }
	];
	
	profileInfo.forEach((info, index) => {
		const xPos = index < 2 ? 20 : 155;
		const yPos = y + (index % 2) * 8;
		doc.setFont(undefined, 'bold');
		doc.text(`${info.icon} ${info.label}`, xPos, yPos);
		doc.setFont(undefined, 'normal');
		doc.text(info.value.toString(), xPos + 25, yPos);
	});
	
	y += 28;
	
	// Individual Plans Section
	if(results.individualPlans && results.individualPlans.length > 0) {
		// Section header with gradient
		doc.setFillColor(...colors.secondary);
		doc.roundedRect(15, y, 100, 8, 2, 2, 'F');
		doc.setFontSize(13);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('🏥 Individual & Family Plans', 20, y + 5.5);
		
		y += 12;
		
		const comparisonAttributes = [
			{ key: 'planName', label: 'Plan Name' },
			{ key: 'planType', label: 'Type' },
			{ key: 'sumInsured', label: 'Sum Insured', format: (value) => '₹' + formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium', format: (value) => '₹' + formatNumber(value) },
			{ key: 'discountOnPremium', label: 'Discount', format: (value) => '₹' + formatNumber(value.toFixed(2)) },
			{ key: 'premium', label: 'Final Premium', format: (value) => '₹' + formatNumber(value) },
			{ key: 'overBudget', label: 'Status', format: (value) => value ? '⚠️ Over' : '✓ Within' },
			{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			{ key: 'features.freeLookPeriod', label: 'Free Look', format:(value) => value},
			{ key: 'features.migration', label: 'Migration', format:(value) => value},
			{ key: 'features.portability', label: 'Portability', format:(value) => value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium', format:(value) => value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) => value},
			{ key: 'features.icu', label: 'ICU', format:(value) => value},
			{ key: 'features.preHospitalisation', label: 'Pre-Hosp', format:(value) => value},
			{ key: 'features.postHospitalisation', label: 'Post-Hosp', format:(value) => value},
			{ key: 'features.mtmat', label: 'MTMAT', format:(value) => value},
			{ key: 'features.copay', label: 'Co-Pay', format:(value) => value},
			{ key: 'features.restorationOfSi', label: 'SI Restoration', format:(value) => value},
			{ key: 'features.intialWaitingPeriod', label: 'Initial Wait', format:(value) => value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Wait', format:(value) => value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity', format:(value) => value},
			{ key: 'features.ped', label: 'PED', format:(value) => value},
			{ key: 'features.capping', label: 'Capping', format:(value) => value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness', format:(value) => value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) => value},
			{ key: 'features.roadAmbulance', label: 'Ambulance', format:(value) => value},
			{ key: 'features.proportionateClause', label: 'Proportionate', format:(value) => value},
			{ key: 'features.reasonableCustomary', label: 'R&C Clause', format:(value) => value},
			{ key: 'features.donorExpenses', label: 'Donor Exp', format:(value) => value},
			{ key: 'features.healthCheckup', label: 'Health Checkup', format:(value) => value},
			{ key: 'features.ayushCover', label: 'AYUSH', format:(value) => value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash', format:(value) => value},
			{ key: 'features.ncdRenewalPremium', label: 'NCD %', format:(value) => value},
			{ key: 'features.cbSi', label: 'CB % SI', format:(value) => value}
		];
		
		const tableData = [];
		const headerRow = ['Feature'];
		results.individualPlans.forEach((plan, index) => {
			headerRow.push(`Plan ${index + 1}`);
		});
		tableData.push(headerRow);
		
		comparisonAttributes.forEach(attr => {
			const row = [attr.label];
			results.individualPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			tableData.push(row);
		});
		
		doc.autoTable({
			startY: y,
			head: [tableData[0]],
			body: tableData.slice(1),
			theme: 'striped',
			headStyles: {
				fillColor: colors.secondary,
				fontStyle: 'bold',
				textColor: colors.white,
				fontSize: 9,
				cellPadding: 4
			},
			styles: {
				fontSize: 8,
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center',
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			alternateRowStyles: {
				fillColor: [248, 250, 252]
			},
			columnStyles: {
				0: { 
					halign: 'left', 
					fontStyle: 'bold', 
					cellWidth: 40,
					fillColor: [241, 245, 249],
					textColor: colors.dark
				}
			},
			margin: { left: 15, right: 15 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 12;
		
		// Premium Breakdown with modern cards
		doc.setFillColor(...colors.accent);
		doc.roundedRect(15, y, 85, 8, 2, 2, 'F');
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('💳 Premium Breakdown', 20, y + 5.5);
		
		y += 12;
		
		const individualDetailsData = [];
		results.individualPlans.forEach((plan, planIndex) => {
			individualDetailsData.push([
				{ 
					content: `Plan ${planIndex + 1}: ${plan.planName} (${plan.planType})`, 
					colSpan: 3, 
					styles: { 
						fillColor: colors.primary, 
						fontStyle: 'bold',
						textColor: colors.white,
						fontSize: 10
					} 
				}
			]);
			
			individualDetailsData.push([
				{ content: 'Member', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } },
				{ content: 'Age', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } },
				{ content: 'Premium (₹)', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } }
			]);
			
			if (plan.breakdown && plan.breakdown.length > 0) {
				plan.breakdown.forEach(member => {
					individualDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premium || member.premiumMember)
					]);
				});
			}
			
			individualDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } },
				{ content: '₹' + formatNumber(plan.totalPremium), styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } }
			]);
			
			individualDetailsData.push([
				{ content: 'Discount:', colSpan: 2, styles: { fillColor: [248, 250, 252] } },
				{ content: '₹' + formatNumber(plan.discountOnPremium), styles: { textColor: colors.success, fillColor: [248, 250, 252] } }
			]);
			
			individualDetailsData.push([
				{ content: 'Final Premium:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [241, 245, 249] } },
				{ 
					content: '₹' + formatNumber(plan.premium), 
					styles: { 
						fontStyle: 'bold', 
						fontSize: 10,
						textColor: plan.overBudget ? colors.danger : colors.success,
						fillColor: [241, 245, 249]
					} 
				}
			]);
			
			individualDetailsData.push([
				{ content: '', colSpan: 3, styles: { minCellHeight: 3, fillColor: colors.white } }
			]);
		});
		
		doc.autoTable({
			startY: y,
			body: individualDetailsData,
			theme: 'plain',
			styles: {
				fontSize: 9,
				cellPadding: 3,
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			margin: { left: 15, right: 15 }
		});
		
		y = doc.lastAutoTable.finalY + 15;
	}
	
	// Combination Plans Section
	if(results.combinationPlans && results.combinationPlans.length > 0) {
		if (y > 150) {
			doc.addPage();
			y = 20;
		}
		
		// Section header
		doc.setFillColor(...colors.success);
		doc.roundedRect(15, y, 115, 8, 2, 2, 'F');
		doc.setFontSize(13);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('🎯 Combination Plans (Base + Top-Up)', 20, y + 5.5);
		
		y += 12;
		
		const combinationAttributes = [
			{ key: 'basePlan.planName', label: 'Base Plan' },
			{ key: 'basePlan.planType', label: 'Base Type' },
			{ key: 'basePlan.sumInsured', label: 'Base SI', format: (value) => '₹' + formatNumber(value) },
			{ key: 'basePlan.premium', label: 'Base Premium', format: (value) => '₹' + formatNumber(value) },
			{ key: 'topUpPlan.planName', label: 'Top-Up Plan' },
			{ key: 'topUpPlan.planType', label: 'Top-Up Type' },
			{ key: 'topUpPlan.sumInsured', label: 'Top-Up SI', format: (value) => '₹' + formatNumber(value) },
			{ key: 'topUpPlan.threshold', label: 'Threshold', format: (value) => '₹' + formatNumber(value) },
			{ key: 'topUpPlan.premium', label: 'Top-Up Premium', format: (value) => '₹' + formatNumber(value) },
			{ key: 'topUpPlan.discountOnPremium', label: 'Discount', format: (value) => '₹' + formatNumber(value) },
			{ key: 'totalCover', label: 'Total Cover', format: (value) => '₹' + formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium', format: (value) => '₹' + formatNumber(value) },
			{ key: 'overBudget', label: 'Status', format: (value) => value ? '⚠️ Over' : '✓ Within' },
			{ key: 'category', label: 'Category' }
		];
		
		const combinationTableData = [];
		const combinationHeaderRow = ['Feature'];
		results.combinationPlans.forEach((plan, index) => {
			combinationHeaderRow.push(`Combo ${index + 1}`);
		});
		combinationTableData.push(combinationHeaderRow);
		
		combinationAttributes.forEach(attr => {
			const row = [attr.label];
			results.combinationPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			combinationTableData.push(row);
		});
		
		doc.autoTable({
			startY: y,
			head: [combinationTableData[0]],
			body: combinationTableData.slice(1),
			theme: 'striped',
			headStyles: {
				fillColor: colors.success,
				fontStyle: 'bold',
				textColor: colors.white,
				fontSize: 9,
				cellPadding: 4
			},
			styles: {
				fontSize: 8,
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center',
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			alternateRowStyles: {
				fillColor: [248, 250, 252]
			},
			columnStyles: {
				0: { 
					halign: 'left', 
					fontStyle: 'bold', 
					cellWidth: 45,
					fillColor: [241, 245, 249],
					textColor: colors.dark
				}
			},
			margin: { left: 15, right: 15 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 12;
		
		// Combination Plans Breakdown
		doc.setFillColor(...colors.warning);
		doc.roundedRect(15, y, 95, 8, 2, 2, 'F');
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('💼 Combination Plans Breakdown', 20, y + 5.5);
		
		y += 12;
		
		const combinationDetailsData = [];
		results.combinationPlans.forEach((comboPlan, planIndex) => {
			combinationDetailsData.push([
				{ 
					content: `Combo ${planIndex + 1}: ${comboPlan.basePlan.planName} + ${comboPlan.topUpPlan.planName}`, 
					colSpan: 3, 
					styles: { 
						fillColor: colors.success, 
						fontStyle: 'bold',
						textColor: colors.white,
						fontSize: 10
					} 
				}
			]);
			
			combinationDetailsData.push([
				{ content: 'Base Plan Details', colSpan: 3, styles: { fillColor: [241, 245, 249], fontStyle: 'bold', textColor: colors.dark } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Plan', styles: { fontStyle: 'bold' } },
				{ content: 'Sum Insured', styles: { fontStyle: 'bold' } },
				{ content: 'Premium', styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				comboPlan.basePlan.planName,
				'₹' + formatNumber(comboPlan.basePlan.sumInsured),
				'₹' + formatNumber(comboPlan.basePlan.premium)
			]);
			
			combinationDetailsData.push([
				{ content: 'Top-Up Plan Details', colSpan: 3, styles: { fillColor: [241, 245, 249], fontStyle: 'bold', textColor: colors.dark } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Plan', styles: { fontStyle: 'bold' } },
				{ content: 'Sum Insured', styles: { fontStyle: 'bold' } },
				{ content: 'Premium', styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				comboPlan.topUpPlan.planName,
				'₹' + formatNumber(comboPlan.topUpPlan.sumInsured),
				'₹' + formatNumber(comboPlan.topUpPlan.premium)
			]);
			
			if (comboPlan.topUpPlan.memberBreakdown && comboPlan.topUpPlan.memberBreakdown.length > 0) {
				combinationDetailsData.push([
					{ content: 'Top-Up Member Breakdown', colSpan: 3, styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } }
				]);
				
				combinationDetailsData.push([
					{ content: 'Member', styles: { fontStyle: 'bold' } },
					{ content: 'Age', styles: { fontStyle: 'bold' } },
					{ content: 'Premium', styles: { fontStyle: 'bold' } }
				]);
				
				comboPlan.topUpPlan.memberBreakdown.forEach(member => {
					combinationDetailsData.push([
						member.relationship,
						member.age.toString(),
						'₹' + formatNumber(member.premiumIndividual || member.premiumFloater)
					]);
				});
			}
			
			combinationDetailsData.push([
				{ content: 'Total Coverage:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [248, 250, 252] } },
				{ content: '₹' + formatNumber(comboPlan.totalCover), styles: { fontStyle: 'bold', fontSize: 10, fillColor: [248, 250, 252] } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [241, 245, 249] } },
				{ 
					content: '₹' + formatNumber(comboPlan.totalPremium), 
					styles: { 
						fontStyle: 'bold', 
						fontSize: 10,
						textColor: comboPlan.overBudget ? colors.danger : colors.success,
						fillColor: [241, 245, 249]
					} 
				}
			]);
			
			combinationDetailsData.push([
				{ content: '', colSpan: 3, styles: { minCellHeight: 3, fillColor: colors.white } }
			]);
		});
		
		doc.autoTable({
			startY: y,
			body: combinationDetailsData,
			theme: 'plain',
			styles: {
				fontSize: 9,
				cellPadding: 3,
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			margin: { left: 15, right: 15 }
		});
	}
	
	// Add footer to all pages
	const pageCount = doc.internal.getNumberOfPages();
	for (let i = 1; i <= pageCount; i++) {
		doc.setPage(i);
		doc.setFillColor(...colors.dark);
		doc.rect(0, 200, 297, 10, 'F');
		doc.setFontSize(8);
		doc.setTextColor(...colors.white);
		doc.text('Health Insurance Recommendations Report', 15, 205);
		doc.text(`Page ${i} of ${pageCount}`, 270, 205);
		doc.text('Generated with care for your protection', 130, 205);
	}
	
	doc.save('insurance-recommendations.pdf');
}*/

function exportToPDF() {
	if(!results){
		alert('Please calculate recommendations first');
		return;
	}
	
	const {jsPDF} = window.jspdf;
	const doc = new jsPDF('l', 'mm', 'a4');
	
	// Modern color palette
	const colors = {
		primary: [59, 130, 246],      // Modern blue
		secondary: [139, 92, 246],     // Purple
		accent: [236, 72, 153],        // Pink
		success: [34, 197, 94],        // Green
		warning: [251, 146, 60],       // Orange
		danger: [239, 68, 68],         // Red
		dark: [15, 23, 42],            // Slate dark
		gray: [100, 116, 139],         // Slate gray
		lightGray: [241, 245, 249],    // Light background
		white: [255, 255, 255]
	};
	
	// Helper function to add gradient-like header
	const addModernHeader = (startY, height) => {
		// Base gradient effect with multiple rectangles
		doc.setFillColor(59, 130, 246);
		doc.rect(0, startY, 297, height, 'F');
		doc.setFillColor(79, 150, 255);
		doc.rect(0, startY, 297, height * 0.6, 'F');
		doc.setFillColor(99, 170, 255);
		doc.rect(0, startY, 297, height * 0.3, 'F');
	};
	
	// Add decorative corner elements (solid, no opacity)
	const addDecorativeElements = () => {
		doc.setFillColor(255, 255, 255);
		// Top right corner decoration
		doc.circle(285, 10, 8, 'F');
		doc.circle(275, 20, 5, 'F');
		doc.setFillColor(59, 130, 246);
		doc.circle(285, 10, 4, 'F');
	};
	
	// Create modern header
	addModernHeader(0, 45);
	addDecorativeElements();
	
	// Title with shadow effect (no emojis)
	doc.setFontSize(28);
	doc.setTextColor(...colors.white);
	doc.setFont(undefined, 'bold');
	doc.text('Health Insurance Recommendations', 20, 22);
	
	// Subtitle
	doc.setFontSize(11);
	doc.setFont(undefined, 'normal');
	doc.text('Personalized Plan Analysis & Comparison', 20, 30);
	
	// Generated date badge
	doc.setFillColor(...colors.white);
	doc.roundedRect(20, 34, 60, 7, 2, 2, 'F');
	doc.setFontSize(9);
	doc.setTextColor(...colors.primary);
	doc.setFont(undefined, 'bold');
	doc.text('Generated: ' + new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), 23, 38.5);
	
	let y = 55;
	
	// Input Summary Card
	doc.setFillColor(...colors.lightGray);
	doc.roundedRect(15, y, 267, 32, 3, 3, 'F');
	
	// Card header with icon-like decoration
	doc.setFillColor(...colors.primary);
	doc.roundedRect(15, y, 267, 8, 3, 3, 'F');
	
	// Small decorative square instead of emoji
	doc.setFillColor(...colors.white);
	doc.rect(18, y + 2.5, 3, 3, 'F');
	
	doc.setFontSize(12);
	doc.setFont(undefined, 'bold');
	doc.setTextColor(...colors.white);
	doc.text('YOUR PROFILE SUMMARY', 24, y + 5.5);
	
	y += 12;
	
	
	
	// Profile info with better labels (no emojis)
		doc.setFontSize(10);
		doc.setTextColor(...colors.dark);

		const profileInfo = [
			{ label: 'Age:', value: userData.age },
			{ label: 'Budget:', value: `Rs ${formatNumber(userData.budget)}` },
			{ label: 'Location:', value: `${userData.location} (Zone ${userData.zone})` },
			{ label: 'Family:', value: `${results.familyStructure.totalMembers} members - ${results.familyStructure.adults} Adult(s), ${results.familyStructure.children} Child(ren), ${results.familyStructure.parents} Parent(s)` }
		];

		// Display in 2 rows x 2 columns layout
		profileInfo.forEach((info, index) => {
			const col = index % 2; // 0 for left column, 1 for right column
			const row = Math.floor(index / 2); // 0 for first row, 1 for second row
			
			const xPos = col === 0 ? 20 : 150; // Left column at 20, right column at 150
			const yPos = y + (row * 8); // 8mm spacing between rows
			
			// Decorative bullet point
			doc.setFillColor(...colors.primary);
			doc.circle(xPos + 1, yPos - 1.5, 1.2, 'F');
			
			doc.setFont(undefined, 'bold');
			doc.setTextColor(...colors.gray);
			doc.text(info.label, xPos + 4, yPos);
			
			doc.setFont(undefined, 'normal');
			doc.setTextColor(...colors.dark);
			const labelWidth = doc.getTextWidth(info.label);
			doc.text(info.value.toString(), xPos + 4 + labelWidth + 2, yPos);
		});

		y += 20; // Adjust spacing after profile info

	// Individual Plans Section
	if(results.individualPlans && results.individualPlans.length > 0) {
		// Section header with modern design
		doc.setFillColor(...colors.secondary);
		doc.roundedRect(15, y, 130, 8, 2, 2, 'F');
		
		// Decorative element
		doc.setFillColor(...colors.white);
		doc.rect(18, y + 2.5, 3, 3, 'F');
		
		doc.setFontSize(13);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('INDIVIDUAL & FAMILY PLANS', 24, y + 5.5);
		
		y += 12;
		
		const comparisonAttributes = [
			{ key: 'planName', label: 'Plan Name' },
			{ key: 'planType', label: 'Type' },
			{ key: 'sumInsured', label: 'Sum Insured', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'discountOnPremium', label: 'Discount', format: (value) => 'Rs ' + formatNumber(value.toFixed(2)) },
			{ key: 'premium', label: 'Final Premium', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category', format: (value) => value.charAt(0).toUpperCase() + value.slice(1) },
			{ key: 'features.freeLookPeriod', label: 'Free Look Period', format:(value) => value},
			{ key: 'features.migration', label: 'Migration', format:(value) => value},
			{ key: 'features.portability', label: 'Portability', format:(value) => value},
			{ key: 'features.moratoriumPeriod', label: 'Moratorium Period', format:(value) => value},
			{ key: 'features.roomRent', label: 'Room Rent', format:(value) => value},
			{ key: 'features.icu', label: 'ICU', format:(value) => value},
			{ key: 'features.preHospitalisation', label: 'Pre-Hospitalisation', format:(value) => value},
			{ key: 'features.postHospitalisation', label: 'Post-Hospitalisation', format:(value) => value},
			{ key: 'features.mtmat', label: 'Modern Treatment', format:(value) => value},
			{ key: 'features.copay', label: 'Co-Payment', format:(value) => value},
			{ key: 'features.restorationOfSi', label: 'SI Restoration', format:(value) => value},
			{ key: 'features.intialWaitingPeriod', label: 'Initial Waiting', format:(value) => value},
			{ key: 'features.specificWaitingPeriods', label: 'Specific Waiting', format:(value) => value},
			{ key: 'features.maternityCoverWithNewBornCover', label: 'Maternity Cover', format:(value) => value},
			{ key: 'features.ped', label: 'Pre-existing Disease', format:(value) => value},
			{ key: 'features.capping', label: 'Capping', format:(value) => value},
			{ key: 'features.mentalIllnessCover', label: 'Mental Illness', format:(value) => value},
			{ key: 'features.homeCare', label: 'Home Care', format:(value) => value},
			{ key: 'features.roadAmbulance', label: 'Ambulance', format:(value) => value},
			{ key: 'features.proportionateClause', label: 'Proportionate Clause', format:(value) => value},
			{ key: 'features.reasonableCustomary', label: 'R&C Clause', format:(value) => value},
			{ key: 'features.donorExpenses', label: 'Donor Expenses', format:(value) => value},
			{ key: 'features.healthCheckup', label: 'Health Checkup', format:(value) => value},
			{ key: 'features.ayushCover', label: 'AYUSH Cover', format:(value) => value},
			{ key: 'features.dailyCashCover', label: 'Daily Cash', format:(value) => value},
			{ key: 'features.ncdRenewalPremium', label: 'NCD %', format:(value) => value},
			{ key: 'features.cbSi', label: 'CB % of SI', format:(value) => value}
		];
		
		const tableData = [];
		const headerRow = ['Feature'];
		results.individualPlans.forEach((plan, index) => {
			headerRow.push(`Plan ${index + 1}`);
		});
		tableData.push(headerRow);
		
		comparisonAttributes.forEach(attr => {
			const row = [attr.label];
			results.individualPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			tableData.push(row);
		});
		
		doc.autoTable({
			startY: y,
			head: [tableData[0]],
			body: tableData.slice(1),
			theme: 'striped',
			headStyles: {
				fillColor: colors.secondary,
				fontStyle: 'bold',
				textColor: colors.white,
				fontSize: 9,
				cellPadding: 4
			},
			styles: {
				fontSize: 8,
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center',
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			alternateRowStyles: {
				fillColor: [248, 250, 252]
			},
			columnStyles: {
				0: { 
					halign: 'left', 
					fontStyle: 'bold', 
					cellWidth: 40,
					fillColor: [241, 245, 249],
					textColor: colors.dark
				}
			},
			margin: { left: 15, right: 15 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 12;
		
		// Premium Breakdown with modern design
		doc.setFillColor(...colors.accent);
		doc.roundedRect(15, y, 100, 8, 2, 2, 'F');
		
		doc.setFillColor(...colors.white);
		doc.rect(18, y + 2.5, 3, 3, 'F');
		
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('PREMIUM BREAKDOWN', 24, y + 5.5);
		
		y += 12;
		
		const individualDetailsData = [];
		results.individualPlans.forEach((plan, planIndex) => {
			individualDetailsData.push([
				{ 
					content: `PLAN ${planIndex + 1}: ${plan.planName} (${plan.planType})`, 
					colSpan: 3, 
					styles: { 
						fillColor: colors.primary, 
						fontStyle: 'bold',
						textColor: colors.white,
						fontSize: 10
					} 
				}
			]);
			
			individualDetailsData.push([
				{ content: 'Member', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } },
				{ content: 'Age', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } },
				{ content: 'Premium (Rs)', styles: { fontStyle: 'bold', fillColor: [241, 245, 249] } }
			]);
			
			if (plan.breakdown && plan.breakdown.length > 0) {
				plan.breakdown.forEach(member => {
					individualDetailsData.push([
						member.relationship,
						member.age.toString(),
						formatNumber(member.premium || member.premiumMember)
					]);
				});
			}
			
			individualDetailsData.push([
				{ content: 'Total Premium:', colSpan: 2, styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } },
				{ content: 'Rs ' + formatNumber(plan.totalPremium), styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } }
			]);
			
			individualDetailsData.push([
				{ content: 'Discount:', colSpan: 2, styles: { fillColor: [248, 250, 252] } },
				{ content: 'Rs ' + formatNumber(plan.discountOnPremium), styles: { textColor: colors.success, fillColor: [248, 250, 252] } }
			]);
			
			individualDetailsData.push([
				{ content: 'FINAL PREMIUM:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [241, 245, 249] } },
				{ 
					content: 'Rs ' + formatNumber(plan.premium), 
					styles: { 
						fontStyle: 'bold', 
						fontSize: 10,
						textColor: plan.overBudget ? colors.danger : colors.success,
						fillColor: [241, 245, 249]
					} 
				}
			]);
			
			individualDetailsData.push([
				{ content: '', colSpan: 3, styles: { minCellHeight: 3, fillColor: colors.white } }
			]);
		});
		
		doc.autoTable({
			startY: y,
			body: individualDetailsData,
			theme: 'plain',
			styles: {
				fontSize: 9,
				cellPadding: 3,
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			margin: { left: 15, right: 15 }
		});
		
		y = doc.lastAutoTable.finalY + 15;
	}
	
	// Combination Plans Section
	if(results.combinationPlans && results.combinationPlans.length > 0) {
		if (y > 150) {
			doc.addPage();
			y = 20;
		}
		
		// Section header
		doc.setFillColor(...colors.success);
		doc.roundedRect(15, y, 145, 8, 2, 2, 'F');
		
		doc.setFillColor(...colors.white);
		doc.rect(18, y + 2.5, 3, 3, 'F');
		
		doc.setFontSize(13);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('COMBINATION PLANS (BASE + TOP-UP)', 24, y + 5.5);
		
		y += 12;
		
		const combinationAttributes = [
			{ key: 'basePlan.planName', label: 'Base Plan' },
			{ key: 'basePlan.planType', label: 'Base Type' },
			{ key: 'basePlan.sumInsured', label: 'Base Sum Insured', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'basePlan.premium', label: 'Base Premium', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'topUpPlan.planName', label: 'Top-Up Plan' },
			{ key: 'topUpPlan.planType', label: 'Top-Up Type' },
			{ key: 'topUpPlan.sumInsured', label: 'Top-Up Sum Insured', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'topUpPlan.threshold', label: 'Threshold', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'topUpPlan.premium', label: 'Top-Up Premium', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'topUpPlan.discountOnPremium', label: 'Top-Up Discount', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'totalCover', label: 'Total Coverage', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'totalPremium', label: 'Total Premium', format: (value) => 'Rs ' + formatNumber(value) },
			{ key: 'overBudget', label: 'Budget Status', format: (value) => value ? 'Over Budget' : 'Within Budget' },
			{ key: 'category', label: 'Category' }
		];
		
		const combinationTableData = [];
		const combinationHeaderRow = ['Feature'];
		results.combinationPlans.forEach((plan, index) => {
			combinationHeaderRow.push(`Combo ${index + 1}`);
		});
		combinationTableData.push(combinationHeaderRow);
		
		combinationAttributes.forEach(attr => {
			const row = [attr.label];
			results.combinationPlans.forEach(plan => {
				let value = getNestedValue(plan, attr.key);
				if (attr.format && value !== undefined) {
					value = attr.format(value);
				}
				row.push(value !== undefined ? value.toString() : 'N/A');
			});
			combinationTableData.push(row);
		});
		
		doc.autoTable({
			startY: y,
			head: [combinationTableData[0]],
			body: combinationTableData.slice(1),
			theme: 'striped',
			headStyles: {
				fillColor: colors.success,
				fontStyle: 'bold',
				textColor: colors.white,
				fontSize: 9,
				cellPadding: 4
			},
			styles: {
				fontSize: 8,
				cellPadding: 3,
				overflow: 'linebreak',
				halign: 'center',
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			alternateRowStyles: {
				fillColor: [248, 250, 252]
			},
			columnStyles: {
				0: { 
					halign: 'left', 
					fontStyle: 'bold', 
					cellWidth: 45,
					fillColor: [241, 245, 249],
					textColor: colors.dark
				}
			},
			margin: { left: 15, right: 15 },
			tableWidth: 'auto'
		});
		
		y = doc.lastAutoTable.finalY + 12;
		
		// Combination Plans Breakdown
		doc.setFillColor(...colors.warning);
		doc.roundedRect(15, y, 120, 8, 2, 2, 'F');
		
		doc.setFillColor(...colors.white);
		doc.rect(18, y + 2.5, 3, 3, 'F');
		
		doc.setFontSize(12);
		doc.setFont(undefined, 'bold');
		doc.setTextColor(...colors.white);
		doc.text('COMBINATION PLANS BREAKDOWN', 24, y + 5.5);
		
		y += 12;
		
		const combinationDetailsData = [];
		results.combinationPlans.forEach((comboPlan, planIndex) => {
			combinationDetailsData.push([
				{ 
					content: `COMBO ${planIndex + 1}: ${comboPlan.basePlan.planName} + ${comboPlan.topUpPlan.planName}`, 
					colSpan: 3, 
					styles: { 
						fillColor: colors.success, 
						fontStyle: 'bold',
						textColor: colors.white,
						fontSize: 10
					} 
				}
			]);
			
			combinationDetailsData.push([
				{ content: 'BASE PLAN DETAILS', colSpan: 3, styles: { fillColor: [241, 245, 249], fontStyle: 'bold', textColor: colors.dark } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Plan', styles: { fontStyle: 'bold' } },
				{ content: 'Sum Insured', styles: { fontStyle: 'bold' } },
				{ content: 'Premium', styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				comboPlan.basePlan.planName,
				'Rs ' + formatNumber(comboPlan.basePlan.sumInsured),
				'Rs ' + formatNumber(comboPlan.basePlan.premium)
			]);
			
			combinationDetailsData.push([
				{ content: 'TOP-UP PLAN DETAILS', colSpan: 3, styles: { fillColor: [241, 245, 249], fontStyle: 'bold', textColor: colors.dark } }
			]);
			
			combinationDetailsData.push([
				{ content: 'Plan', styles: { fontStyle: 'bold' } },
				{ content: 'Sum Insured', styles: { fontStyle: 'bold' } },
				{ content: 'Premium', styles: { fontStyle: 'bold' } }
			]);
			
			combinationDetailsData.push([
				comboPlan.topUpPlan.planName,
				'Rs ' + formatNumber(comboPlan.topUpPlan.sumInsured),
				'Rs ' + formatNumber(comboPlan.topUpPlan.premium)
			]);
			
			if (comboPlan.topUpPlan.memberBreakdown && comboPlan.topUpPlan.memberBreakdown.length > 0) {
				combinationDetailsData.push([
					{ content: 'TOP-UP MEMBER BREAKDOWN', colSpan: 3, styles: { fontStyle: 'bold', fillColor: [248, 250, 252] } }
				]);
				
				combinationDetailsData.push([
					{ content: 'Member', styles: { fontStyle: 'bold' } },
					{ content: 'Age', styles: { fontStyle: 'bold' } },
					{ content: 'Premium', styles: { fontStyle: 'bold' } }
				]);
				
				comboPlan.topUpPlan.memberBreakdown.forEach(member => {
					combinationDetailsData.push([
						member.relationship,
						member.age.toString(),
						'Rs ' + formatNumber(member.premiumIndividual || member.premiumFloater)
					]);
				});
			}
			
			combinationDetailsData.push([
				{ content: 'TOTAL COVERAGE:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [248, 250, 252] } },
				{ content: 'Rs ' + formatNumber(comboPlan.totalCover), styles: { fontStyle: 'bold', fontSize: 10, fillColor: [248, 250, 252] } }
			]);
			
			combinationDetailsData.push([
				{ content: 'TOTAL PREMIUM:', colSpan: 2, styles: { fontStyle: 'bold', fontSize: 10, fillColor: [241, 245, 249] } },
				{ 
					content: 'Rs ' + formatNumber(comboPlan.totalPremium), 
					styles: { 
						fontStyle: 'bold', 
						fontSize: 10,
						textColor: comboPlan.overBudget ? colors.danger : colors.success,
						fillColor: [241, 245, 249]
					} 
				}
			]);
			
			combinationDetailsData.push([
				{ content: '', colSpan: 3, styles: { minCellHeight: 3, fillColor: colors.white } }
			]);
		});
		
		doc.autoTable({
			startY: y,
			body: combinationDetailsData,
			theme: 'plain',
			styles: {
				fontSize: 9,
				cellPadding: 3,
				lineColor: [226, 232, 240],
				lineWidth: 0.1
			},
			margin: { left: 15, right: 15 }
		});
	}
	
	// Add footer to all pages
	const pageCount = doc.internal.getNumberOfPages();
	for (let i = 1; i <= pageCount; i++) {
		doc.setPage(i);
		
		// Footer background
		doc.setFillColor(...colors.dark);
		doc.rect(0, 200, 297, 10, 'F');
		
		// Footer decorative line
		doc.setDrawColor(...colors.primary);
		doc.setLineWidth(0.5);
		doc.line(15, 200, 282, 200);
		
		doc.setFontSize(8);
		doc.setTextColor(...colors.white);
		doc.setFont(undefined, 'normal');
		doc.text('Health Insurance Recommendations Report', 15, 205);
		doc.text(`Page ${i} of ${pageCount}`, 265, 205);
		doc.setFont(undefined, 'italic');
		doc.text('Generated for your protection', 127, 205);
	}
	
	doc.save('insurance-recommendations.pdf');
}

// Helper function to get nested object values
function getNestedValue(obj, path) {
	return path.split('.').reduce((current, key) => {
		return current && current[key] !== undefined ? current[key] : undefined;
	}, obj);
}
</script>
</body>
</html>